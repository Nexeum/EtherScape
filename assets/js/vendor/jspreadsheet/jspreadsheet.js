(function(F,w){"object"===typeof exports&&"undefined"!==typeof module?module.exports=w():"function"===typeof define&&define.amd?define(w):F.formula=w()})(this,function(){var F=function(w){var k=function(){var g={};g.nil=Error("#NULL!");g.div0=Error("#DIV/0!");g.value=Error("#VALUE!");g.ref=Error("#REF!");g.name=Error("#NAME?");g.num=Error("#NUM!");g.na=Error("#N/A");g.error=Error("#ERROR!");g.data=Error("#GETTING_DATA");return g}(),e=function(){var g={flattenShallow:function(a){return a&&a.reduce?
a.reduce(function(c,d){var f=Array.isArray(c),h=Array.isArray(d);return f&&h?c.concat(d):f?(c.push(d),c):h?[c].concat(d):[c,d]}):a},isFlat:function(a){if(!a)return!1;for(var c=0;c<a.length;++c)if(Array.isArray(a[c]))return!1;return!0},flatten:function(){for(var a=g.argsToArray.apply(null,arguments);!g.isFlat(a);)a=g.flattenShallow(a);return a},argsToArray:function(a){var c=[];g.arrayEach(a,function(d){c.push(d)});return c},numbers:function(){return this.flatten.apply(null,arguments).filter(function(a){return"number"===
typeof a})},cleanFloat:function(a){return Math.round(1E14*a)/1E14},parseBool:function(a){if("boolean"===typeof a||a instanceof Error)return a;if("number"===typeof a)return 0!==a;if("string"===typeof a){var c=a.toUpperCase();if("TRUE"===c)return!0;if("FALSE"===c)return!1}return a instanceof Date&&!isNaN(a)?!0:k.value},parseNumber:function(a){return void 0===a||""===a?k.value:isNaN(a)?k.value:parseFloat(a)},parseNumberArray:function(a){var c;if(!a||0===(c=a.length))return k.value;for(var d;c--;){d=
g.parseNumber(a[c]);if(d===k.value)return d;a[c]=d}return a},parseMatrix:function(a){if(!a||0===a.length)return k.value;for(var c,d=0;d<a.length;d++)if(c=g.parseNumberArray(a[d]),a[d]=c,c instanceof Error)return c;return a}},b=new Date(Date.UTC(1900,0,1));g.parseDate=function(a){if(!isNaN(a)){if(a instanceof Date)return new Date(a);a=parseInt(a,10);return 0>a?k.num:60>=a?new Date(b.getTime()+864E5*(a-1)):new Date(b.getTime()+864E5*(a-2))}return"string"!==typeof a||(a=new Date(a),isNaN(a))?k.value:
a};g.parseDateArray=function(a){for(var c=a.length,d;c--;){d=this.parseDate(a[c]);if(d===k.value)return d;a[c]=d}return a};g.anyIsError=function(){for(var a=arguments.length;a--;)if(arguments[a]instanceof Error)return!0;return!1};g.arrayValuesToNumbers=function(a){for(var c=a.length,d;c--;)d=a[c],"number"!==typeof d&&(!0===d?a[c]=1:!1===d?a[c]=0:"string"===typeof d&&(d=this.parseNumber(d),a[c]=d instanceof Error?0:d));return a};g.rest=function(a,c){return a&&"function"===typeof a.slice?a.slice(c||
1):a};g.initial=function(a,c){return a&&"function"===typeof a.slice?a.slice(0,a.length-(c||1)):a};g.arrayEach=function(a,c){for(var d=-1,f=a.length;++d<f&&!1!==c(a[d],d,a););return a};g.transpose=function(a){return a?a[0].map(function(c,d){return a.map(function(f){return f[d]})}):k.value};return g}(),y={};y.datetime=function(){function g(d){return(d-a)/864E5+(-22038912E5<d?2:1)}var b={},a=new Date(1900,0,1),c=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],
[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]];b.DATE=function(d,f,h){d=e.parseNumber(d);f=e.parseNumber(f);h=e.parseNumber(h);return e.anyIsError(d,f,h)?k.value:0>d||0>f||0>h?k.num:new Date(d,f-1,h)};b.DATEVALUE=function(d){if("string"!==typeof d)return k.value;d=Date.parse(d);return isNaN(d)?k.value:-22038912E5>=d?(d-a)/864E5+1:(d-a)/864E5+2};b.DAY=function(d){d=e.parseDate(d);return d instanceof Error?d:d.getDate()};b.DAYS=function(d,f){d=e.parseDate(d);
f=e.parseDate(f);return d instanceof Error?d:f instanceof Error?f:g(d)-g(f)};b.DAYS360=function(d,f,h){};b.EDATE=function(d,f){d=e.parseDate(d);if(d instanceof Error)return d;if(isNaN(f))return k.value;f=parseInt(f,10);d.setMonth(d.getMonth()+f);return g(d)};b.EOMONTH=function(d,f){d=e.parseDate(d);if(d instanceof Error)return d;if(isNaN(f))return k.value;f=parseInt(f,10);return g(new Date(d.getFullYear(),d.getMonth()+f+1,0))};b.HOUR=function(d){d=e.parseDate(d);return d instanceof Error?d:d.getHours()};
b.INTERVAL=function(d){if("number"!==typeof d&&"string"!==typeof d)return k.value;d=parseInt(d,10);var f=Math.floor(d/94608E4);d%=94608E4;var h=Math.floor(d/2592E3);d%=2592E3;var l=Math.floor(d/86400);d%=86400;var m=Math.floor(d/3600);d%=3600;var n=Math.floor(d/60);d%=60;return"P"+(0<f?f+"Y":"")+(0<h?h+"M":"")+(0<l?l+"D":"")+"T"+(0<m?m+"H":"")+(0<n?n+"M":"")+(0<d?d+"S":"")};b.ISOWEEKNUM=function(d){d=e.parseDate(d);if(d instanceof Error)return d;d.setHours(0,0,0);d.setDate(d.getDate()+4-(d.getDay()||
7));var f=new Date(d.getFullYear(),0,1);return Math.ceil(((d-f)/864E5+1)/7)};b.MINUTE=function(d){d=e.parseDate(d);return d instanceof Error?d:d.getMinutes()};b.MONTH=function(d){d=e.parseDate(d);return d instanceof Error?d:d.getMonth()+1};b.NETWORKDAYS=function(d,f,h){};b.NETWORKDAYS.INTL=function(d,f,h,l){};b.NOW=function(){return new Date};b.SECOND=function(d){d=e.parseDate(d);return d instanceof Error?d:d.getSeconds()};b.TIME=function(d,f,h){d=e.parseNumber(d);f=e.parseNumber(f);h=e.parseNumber(h);
return e.anyIsError(d,f,h)?k.value:0>d||0>f||0>h?k.num:(3600*d+60*f+h)/86400};b.TIMEVALUE=function(d){d=e.parseDate(d);return d instanceof Error?d:(3600*d.getHours()+60*d.getMinutes()+d.getSeconds())/86400};b.TODAY=function(){return new Date};b.WEEKDAY=function(d,f){d=e.parseDate(d);if(d instanceof Error)return d;void 0===f&&(f=1);d=d.getDay();return c[f][d]};b.WEEKNUM=function(d,f){};b.WORKDAY=function(d,f,h){};b.WORKDAY.INTL=function(d,f,h,l){};b.YEAR=function(d){d=e.parseDate(d);return d instanceof
Error?d:d.getFullYear()};b.YEARFRAC=function(d,f,h){};return b}();y.database=function(){function g(a,c){for(var d={},f=1;f<a[0].length;++f)d[f]=!0;var h=c[0].length;for(f=1;f<c.length;++f)c[f].length>h&&(h=c[f].length);for(f=1;f<a.length;++f)for(var l=1;l<a[f].length;++l){for(var m=!1,n=!1,p=0;p<c.length;++p){var q=c[p];if(!(q.length<h)&&a[f][0]===q[0]){n=!0;for(var t=1;t<q.length;++t)m=m||eval(a[f][l]+q[t])}}n&&(d[l]=d[l]&&m)}c=[];for(h=0;h<a[0].length;++h)d[h]&&c.push(h-1);return c}var b={FINDFIELD:function(a,
c){for(var d=null,f=0;f<a.length;f++)if(a[f][0]===c){d=f;break}return null==d?k.value:d},DAVERAGE:function(a,c,d){if(isNaN(c)&&"string"!==typeof c)return k.value;d=g(a,d);"string"===typeof c?(c=b.FINDFIELD(a,c),a=e.rest(a[c])):a=e.rest(a[c]);for(var f=c=0;f<d.length;f++)c+=a[d[f]];return 0===d.length?k.div0:c/d.length},DCOUNT:function(a,c,d){},DCOUNTA:function(a,c,d){},DGET:function(a,c,d){if(isNaN(c)&&"string"!==typeof c)return k.value;d=g(a,d);"string"===typeof c?(c=b.FINDFIELD(a,c),a=e.rest(a[c])):
a=e.rest(a[c]);return 0===d.length?k.value:1<d.length?k.num:a[d[0]]},DMAX:function(a,c,d){if(isNaN(c)&&"string"!==typeof c)return k.value;d=g(a,d);"string"===typeof c?(c=b.FINDFIELD(a,c),a=e.rest(a[c])):a=e.rest(a[c]);c=a[d[0]];for(var f=1;f<d.length;f++)c<a[d[f]]&&(c=a[d[f]]);return c},DMIN:function(a,c,d){if(isNaN(c)&&"string"!==typeof c)return k.value;d=g(a,d);"string"===typeof c?(c=b.FINDFIELD(a,c),a=e.rest(a[c])):a=e.rest(a[c]);c=a[d[0]];for(var f=1;f<d.length;f++)c>a[d[f]]&&(c=a[d[f]]);return c},
DPRODUCT:function(a,c,d){if(isNaN(c)&&"string"!==typeof c)return k.value;d=g(a,d);if("string"===typeof c){c=b.FINDFIELD(a,c);var f=e.rest(a[c])}else f=e.rest(a[c]);a=[];for(c=0;c<d.length;c++)a[c]=f[d[c]];if(d=a)for(a=[],c=0;c<d.length;++c)d[c]&&a.push(d[c]);else a=d;d=1;for(c=0;c<a.length;c++)d*=a[c];return d},DSTDEV:function(a,c,d){},DSTDEVP:function(a,c,d){},DSUM:function(a,c,d){},DVAR:function(a,c,d){},DVARP:function(a,c,d){},MATCH:function(a,c,d){if(!a&&!c)return k.na;2===arguments.length&&(d=
1);if(!(c instanceof Array)||-1!==d&&0!==d&&1!==d)return k.na;for(var f,h,l=0;l<c.length;l++)if(1===d){if(c[l]===a)return l+1;c[l]<a&&(h?c[l]>h&&(f=l+1,h=c[l]):(f=l+1,h=c[l]))}else if(0===d)if("string"===typeof a){if(a=a.replace(/\?/g,"."),c[l].toLowerCase().match(a.toLowerCase()))return l+1}else{if(c[l]===a)return l+1}else if(-1===d){if(c[l]===a)return l+1;c[l]>a&&(h?c[l]<h&&(f=l+1,h=c[l]):(f=l+1,h=c[l]))}return f?f:k.na}};return b}();y.engineering=function(){var g={BESSELI:function(b,a){},BESSELJ:function(b,
a){},BESSELK:function(b,a){},BESSELY:function(b,a){},BIN2DEC:function(b){if(!/^[01]{1,10}$/.test(b))return k.num;var a=parseInt(b,2);b=b.toString();return 10===b.length&&"1"===b.substring(0,1)?parseInt(b.substring(1),2)-512:a},BIN2HEX:function(b,a){if(!/^[01]{1,10}$/.test(b))return k.num;var c=b.toString();if(10===c.length&&"1"===c.substring(0,1))return(0xfffffffe00+parseInt(c.substring(1),2)).toString(16);b=parseInt(b,2).toString(16);if(void 0===a)return b;if(isNaN(a))return k.value;if(0>a)return k.num;
a=Math.floor(a);return a>=b.length?REPT("0",a-b.length)+b:k.num},BIN2OCT:function(b,a){if(!/^[01]{1,10}$/.test(b))return k.num;var c=b.toString();if(10===c.length&&"1"===c.substring(0,1))return(1073741312+parseInt(c.substring(1),2)).toString(8);b=parseInt(b,2).toString(8);if(void 0===a)return b;if(isNaN(a))return k.value;if(0>a)return k.num;a=Math.floor(a);return a>=b.length?REPT("0",a-b.length)+b:k.num},BITAND:function(b,a){b=e.parseNumber(b);a=e.parseNumber(a);return e.anyIsError(b,a)?k.value:0>
b||0>a||Math.floor(b)!==b||Math.floor(a)!==a||0xffffffffffff<b||0xffffffffffff<a?k.num:b&a},BITLSHIFT:function(b,a){b=e.parseNumber(b);a=e.parseNumber(a);return e.anyIsError(b,a)?k.value:0>b||Math.floor(b)!==b||0xffffffffffff<b||53<Math.abs(a)?k.num:0<=a?b<<a:b>>-a},BITOR:function(b,a){b=e.parseNumber(b);a=e.parseNumber(a);return e.anyIsError(b,a)?k.value:0>b||0>a||Math.floor(b)!==b||Math.floor(a)!==a||0xffffffffffff<b||0xffffffffffff<a?k.num:b|a},BITRSHIFT:function(b,a){b=e.parseNumber(b);a=e.parseNumber(a);
return e.anyIsError(b,a)?k.value:0>b||Math.floor(b)!==b||0xffffffffffff<b||53<Math.abs(a)?k.num:0<=a?b>>a:b<<-a},BITXOR:function(b,a){b=e.parseNumber(b);a=e.parseNumber(a);return e.anyIsError(b,a)?k.value:0>b||0>a||Math.floor(b)!==b||Math.floor(a)!==a||0xffffffffffff<b||0xffffffffffff<a?k.num:b^a},COMPLEX:function(b,a,c){b=e.parseNumber(b);a=e.parseNumber(a);if(e.anyIsError(b,a))return b;c=void 0===c?"i":c;return"i"!==c&&"j"!==c?k.value:0===b&&0===a?0:0===b?1===a?c:a.toString()+c:0===a?b.toString():
b.toString()+(0<a?"+":"")+(1===a?c:a.toString()+c)},CONVERT:function(b,a,c){b=e.parseNumber(b);if(b instanceof Error)return b;for(var d=[["a.u. of action","?",null,"action",!1,!1,1.05457168181818E-34],["a.u. of charge","e",null,"electric_charge",!1,!1,1.60217653141414E-19],["a.u. of energy","Eh",null,"energy",!1,!1,4.35974417757576E-18],["a.u. of length","a?",null,"length",!1,!1,5.29177210818182E-11],["a.u. of mass","m?",null,"mass",!1,!1,9.10938261616162E-31],["a.u. of time","?/Eh",null,"time",!1,
!1,2.41888432650516E-17],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["\u00e5ngstr\u00f6m","\u00c5",["ang"],"length",!1,!0,1E-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,1.49597870691667E-11],["bar","bar",null,"pressure",!1,!1,1E5],["barn","b",null,"area",!1,!1,1E-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],
"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic \u00e5ngstr\u00f6m","ang3",["ang^3"],"volume",!1,!0,1E-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,1.6387064E-5],["cubic light-year","ly3",["ly^3"],"volume",
!1,!0,8.46786664623715E-47],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,4.16818182544058E9],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,7.58660370370369E-8],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,2.365882365E-4],["dalton","Da",["u"],"mass",!1,!1,1.66053886282828E-27],["day","d",["day"],"time",!1,!0,86400],["degree",
"\u00b0",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1E-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1E-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,2.95735295625E-5],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],
["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,6.47989E-5],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1E4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,
745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519.538],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],
["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1E-18],
["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,2.7777777777778E-4],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",
!1,!1,133.322],["minute","?",null,"angle",!1,!1,2.90888208665722E-4],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5E-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,1.05457168181818E-34],["n.u. of mass","m?",null,"mass",!1,!1,9.10938261616162E-31],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,1.28808866778687E-21],["nautical mile",
"M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["\u0153rsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","\u03a9",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdest\u00e4rke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1E-4],["pica (1/6 inch)","pica",null,"length",!1,!0,3.5277777777778E-4],
["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,9.46352946E-4],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,4.84813681109536E-6],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,
!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square \u00e5ngstr\u00f6m","ang2",["ang^2"],"area",!1,!0,1E-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,6.4516E-4],["square light-year","ly2",["ly^2"],"area",!1,!0,8.95054210748189E31],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988.110336],
["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1.792111111111E-5],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1E-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1E-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,1.47868E-5],["teaspoon",
"tsp",null,"volume",!1,!0,4.92892E-6],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1E3],["U.K. pint","uk_pt",null,"volume",!1,!0,5.6826125E-4],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,4.73176473E-4],["U.S. survey mile","survey_mi",null,"length",!1,!0,
1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],f={Yi:["yobi",80,1.2089258196146292E24,"Yi","yotta"],Zi:["zebi",70,1.1805916207174113E21,"Zi","zetta"],Ei:["exbi",60,0x1000000000000000,"Ei","exa"],Pi:["pebi",50,0x4000000000000,
"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},h={Y:["yotta",1E24,"Y"],Z:["zetta",1E21,"Z"],E:["exa",1E18,"E"],P:["peta",1E15,"P"],T:["tera",1E12,"T"],G:["giga",1E9,"G"],M:["mega",1E6,"M"],k:["kilo",1E3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1E-6,"u"],n:["nano",1E-9,"n"],p:["pico",1E-12,"p"],f:["femto",1E-15,"f"],
a:["atto",1E-18,"a"],z:["zepto",1E-21,"z"],y:["yocto",1E-24,"y"]},l=null,m=null,n=a,p=c,q=1,t=1,u,r=0;r<d.length;r++){u=null===d[r][2]?[]:d[r][2];if(d[r][1]===n||0<=u.indexOf(n))l=d[r];if(d[r][1]===p||0<=u.indexOf(p))m=d[r]}if(null===l)for(u=f[a.substring(0,2)],r=h[a.substring(0,1)],"da"===a.substring(0,2)&&(r=["dekao",10,"da"]),u?(q=u[2],n=a.substring(2)):r&&(q=r[1],n=a.substring(r[2].length)),a=0;a<d.length;a++)if(u=null===d[a][2]?[]:d[a][2],d[a][1]===n||0<=u.indexOf(n))l=d[a];if(null===m)for(f=
f[c.substring(0,2)],h=h[c.substring(0,1)],"da"===c.substring(0,2)&&(h=["dekao",10,"da"]),f?(t=f[2],p=c.substring(2)):h&&(t=h[1],p=c.substring(h[2].length)),c=0;c<d.length;c++)if(u=null===d[c][2]?[]:d[c][2],d[c][1]===p||0<=u.indexOf(p))m=d[c];return null===l||null===m||l[3]!==m[3]?k.na:b*l[6]*q/(m[6]*t)},DEC2BIN:function(b,a){b=e.parseNumber(b);if(b instanceof Error)return b;if(!/^-?[0-9]{1,3}$/.test(b)||-512>b||511<b)return k.num;if(0>b)return"1"+REPT("0",9-(512+b).toString(2).length)+(512+b).toString(2);
b=parseInt(b,10).toString(2);if("undefined"===typeof a)return b;if(isNaN(a))return k.value;if(0>a)return k.num;a=Math.floor(a);return a>=b.length?REPT("0",a-b.length)+b:k.num},DEC2HEX:function(b,a){b=e.parseNumber(b);if(b instanceof Error)return b;if(!/^-?[0-9]{1,12}$/.test(b)||-549755813888>b||549755813887<b)return k.num;if(0>b)return(1099511627776+b).toString(16);b=parseInt(b,10).toString(16);if("undefined"===typeof a)return b;if(isNaN(a))return k.value;if(0>a)return k.num;a=Math.floor(a);return a>=
b.length?REPT("0",a-b.length)+b:k.num},DEC2OCT:function(b,a){b=e.parseNumber(b);if(b instanceof Error)return b;if(!/^-?[0-9]{1,9}$/.test(b)||-536870912>b||536870911<b)return k.num;if(0>b)return(1073741824+b).toString(8);b=parseInt(b,10).toString(8);if("undefined"===typeof a)return b;if(isNaN(a))return k.value;if(0>a)return k.num;a=Math.floor(a);return a>=b.length?REPT("0",a-b.length)+b:k.num},DELTA:function(b,a){a=void 0===a?0:a;b=e.parseNumber(b);a=e.parseNumber(a);return e.anyIsError(b,a)?k.value:
b===a?1:0},ERF:function(b,a){}};g.ERF.PRECISE=function(){};g.ERFC=function(b){};g.ERFC.PRECISE=function(){};g.GESTEP=function(b,a){a=a||0;b=e.parseNumber(b);return e.anyIsError(a,b)?b:b>=a?1:0};g.HEX2BIN=function(b,a){if(!/^[0-9A-Fa-f]{1,10}$/.test(b))return k.num;var c=10===b.length&&"f"===b.substring(0,1).toLowerCase()?!0:!1;b=c?parseInt(b,16)-1099511627776:parseInt(b,16);if(-512>b||511<b)return k.num;if(c)return"1"+REPT("0",9-(512+b).toString(2).length)+(512+b).toString(2);c=b.toString(2);if(void 0===
a)return c;if(isNaN(a))return k.value;if(0>a)return k.num;a=Math.floor(a);return a>=c.length?REPT("0",a-c.length)+c:k.num};g.HEX2DEC=function(b){if(!/^[0-9A-Fa-f]{1,10}$/.test(b))return k.num;b=parseInt(b,16);return 549755813888<=b?b-1099511627776:b};g.HEX2OCT=function(b,a){if(!/^[0-9A-Fa-f]{1,10}$/.test(b))return k.num;b=parseInt(b,16);if(536870911<b&&0xffe0000000>b)return k.num;if(0xffe0000000<=b)return(b-0xffc0000000).toString(8);b=b.toString(8);if(void 0===a)return b;if(isNaN(a))return k.value;
if(0>a)return k.num;a=Math.floor(a);return a>=b.length?REPT("0",a-b.length)+b:k.num};g.IMABS=function(b){var a=g.IMREAL(b);b=g.IMAGINARY(b);return e.anyIsError(a,b)?k.value:Math.sqrt(Math.pow(a,2)+Math.pow(b,2))};g.IMAGINARY=function(b){if(void 0===b||!0===b||!1===b)return k.value;if(0===b||"0"===b)return 0;if(0<=["i","j"].indexOf(b))return 1;b=b.replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j");var a=b.indexOf("+"),c=b.indexOf("-");0===a&&(a=b.indexOf("+",1));0===c&&
(c=b.indexOf("-",1));var d=b.substring(b.length-1,b.length);d="i"===d||"j"===d;return 0<=a||0<=c?d?0<=a?isNaN(b.substring(0,a))||isNaN(b.substring(a+1,b.length-1))?k.num:Number(b.substring(a+1,b.length-1)):isNaN(b.substring(0,c))||isNaN(b.substring(c+1,b.length-1))?k.num:-Number(b.substring(c+1,b.length-1)):k.num:d?isNaN(b.substring(0,b.length-1))?k.num:b.substring(0,b.length-1):isNaN(b)?k.num:0};g.IMARGUMENT=function(b){var a=g.IMREAL(b);b=g.IMAGINARY(b);return e.anyIsError(a,b)?k.value:0===a&&0===
b?k.div0:0===a&&0<b?Math.PI/2:0===a&&0>b?-Math.PI/2:0===b&&0<a?0:0===b&&0>a?-Math.PI:0<a?Math.atan(b/a):0>a&&0<=b?Math.atan(b/a)+Math.PI:Math.atan(b/a)-Math.PI};g.IMCONJUGATE=function(b){var a=g.IMREAL(b),c=g.IMAGINARY(b);if(e.anyIsError(a,c))return k.value;var d=b.substring(b.length-1);return 0!==c?g.COMPLEX(a,-c,"i"===d||"j"===d?d:"i"):b};g.IMCOS=function(b){var a=g.IMREAL(b),c=g.IMAGINARY(b);if(e.anyIsError(a,c))return k.value;b=b.substring(b.length-1);return g.COMPLEX(Math.cos(a)*(Math.exp(c)+
Math.exp(-c))/2,-Math.sin(a)*(Math.exp(c)-Math.exp(-c))/2,"i"===b||"j"===b?b:"i")};g.IMCOSH=function(b){var a=g.IMREAL(b),c=g.IMAGINARY(b);if(e.anyIsError(a,c))return k.value;b=b.substring(b.length-1);return g.COMPLEX(Math.cos(c)*(Math.exp(a)+Math.exp(-a))/2,Math.sin(c)*(Math.exp(a)-Math.exp(-a))/2,"i"===b||"j"===b?b:"i")};g.IMCOT=function(b){var a=g.IMREAL(b),c=g.IMAGINARY(b);return e.anyIsError(a,c)?k.value:g.IMDIV(g.IMCOS(b),g.IMSIN(b))};g.IMDIV=function(b,a){var c=g.IMREAL(b),d=g.IMAGINARY(b),
f=g.IMREAL(a),h=g.IMAGINARY(a);if(e.anyIsError(c,d,f,h))return k.value;b=b.substring(b.length-1);var l=a.substring(a.length-1);a="i";"j"===b?a="j":"j"===l&&(a="j");if(0===f&&0===h)return k.num;b=f*f+h*h;return g.COMPLEX((c*f+d*h)/b,(d*f-c*h)/b,a)};g.IMEXP=function(b){var a=g.IMREAL(b),c=g.IMAGINARY(b);if(e.anyIsError(a,c))return k.value;b=b.substring(b.length-1);a=Math.exp(a);return g.COMPLEX(a*Math.cos(c),a*Math.sin(c),"i"===b||"j"===b?b:"i")};g.IMLN=function(b){var a=g.IMREAL(b),c=g.IMAGINARY(b);
if(e.anyIsError(a,c))return k.value;b=b.substring(b.length-1);return g.COMPLEX(Math.log(Math.sqrt(a*a+c*c)),Math.atan(c/a),"i"===b||"j"===b?b:"i")};g.IMLOG10=function(b){var a=g.IMREAL(b),c=g.IMAGINARY(b);if(e.anyIsError(a,c))return k.value;b=b.substring(b.length-1);return g.COMPLEX(Math.log(Math.sqrt(a*a+c*c))/Math.log(10),Math.atan(c/a)/Math.log(10),"i"===b||"j"===b?b:"i")};g.IMLOG2=function(b){var a=g.IMREAL(b),c=g.IMAGINARY(b);if(e.anyIsError(a,c))return k.value;b=b.substring(b.length-1);return g.COMPLEX(Math.log(Math.sqrt(a*
a+c*c))/Math.log(2),Math.atan(c/a)/Math.log(2),"i"===b||"j"===b?b:"i")};g.IMPOWER=function(b,a){a=e.parseNumber(a);var c=g.IMREAL(b),d=g.IMAGINARY(b);if(e.anyIsError(a,c,d))return k.value;c=b.substring(b.length-1);c="i"===c||"j"===c?c:"i";d=Math.pow(g.IMABS(b),a);b=g.IMARGUMENT(b);return g.COMPLEX(d*Math.cos(a*b),d*Math.sin(a*b),c)};g.IMPRODUCT=function(){for(var b=arguments[0],a=1;a<arguments.length;a++){var c=g.IMREAL(b);b=g.IMAGINARY(b);var d=g.IMREAL(arguments[a]),f=g.IMAGINARY(arguments[a]);
if(e.anyIsError(c,b,d,f))return k.value;b=g.COMPLEX(c*d-b*f,c*f+b*d)}return b};g.IMREAL=function(b){if(void 0===b||!0===b||!1===b)return k.value;if(0===b||"0"===b||0<="i +i 1i +1i -i -1i j +j 1j +1j -j -1j".split(" ").indexOf(b))return 0;var a=b.indexOf("+"),c=b.indexOf("-");0===a&&(a=b.indexOf("+",1));0===c&&(c=b.indexOf("-",1));var d=b.substring(b.length-1,b.length);d="i"===d||"j"===d;return 0<=a||0<=c?d?0<=a?isNaN(b.substring(0,a))||isNaN(b.substring(a+1,b.length-1))?k.num:Number(b.substring(0,
a)):isNaN(b.substring(0,c))||isNaN(b.substring(c+1,b.length-1))?k.num:Number(b.substring(0,c)):k.num:d?isNaN(b.substring(0,b.length-1))?k.num:0:isNaN(b)?k.num:b};g.IMSEC=function(b){if(!0===b||!1===b)return k.value;var a=g.IMREAL(b),c=g.IMAGINARY(b);return e.anyIsError(a,c)?k.value:g.IMDIV("1",g.IMCOS(b))};g.IMSECH=function(b){var a=g.IMREAL(b),c=g.IMAGINARY(b);return e.anyIsError(a,c)?k.value:g.IMDIV("1",g.IMCOSH(b))};g.IMSIN=function(b){var a=g.IMREAL(b),c=g.IMAGINARY(b);if(e.anyIsError(a,c))return k.value;
b=b.substring(b.length-1);return g.COMPLEX(Math.sin(a)*(Math.exp(c)+Math.exp(-c))/2,Math.cos(a)*(Math.exp(c)-Math.exp(-c))/2,"i"===b||"j"===b?b:"i")};g.IMSINH=function(b){var a=g.IMREAL(b),c=g.IMAGINARY(b);if(e.anyIsError(a,c))return k.value;b=b.substring(b.length-1);return g.COMPLEX(Math.cos(c)*(Math.exp(a)-Math.exp(-a))/2,Math.sin(c)*(Math.exp(a)+Math.exp(-a))/2,"i"===b||"j"===b?b:"i")};g.IMSQRT=function(b){var a=g.IMREAL(b),c=g.IMAGINARY(b);if(e.anyIsError(a,c))return k.value;a=b.substring(b.length-
1);a="i"===a||"j"===a?a:"i";c=Math.sqrt(g.IMABS(b));b=g.IMARGUMENT(b);return g.COMPLEX(c*Math.cos(b/2),c*Math.sin(b/2),a)};g.IMCSC=function(b){if(!0===b||!1===b)return k.value;var a=g.IMREAL(b),c=g.IMAGINARY(b);return e.anyIsError(a,c)?k.num:g.IMDIV("1",g.IMSIN(b))};g.IMCSCH=function(b){if(!0===b||!1===b)return k.value;var a=g.IMREAL(b),c=g.IMAGINARY(b);return e.anyIsError(a,c)?k.num:g.IMDIV("1",g.IMSINH(b))};g.IMSUB=function(b,a){var c=this.IMREAL(b),d=this.IMAGINARY(b),f=this.IMREAL(a),h=this.IMAGINARY(a);
if(e.anyIsError(c,d,f,h))return k.value;b=b.substring(b.length-1);a=a.substring(a.length-1);var l="i";"j"===b?l="j":"j"===a&&(l="j");return this.COMPLEX(c-f,d-h,l)};g.IMSUM=function(){for(var b=e.flatten(arguments),a=b[0],c=1;c<b.length;c++){var d=this.IMREAL(a);a=this.IMAGINARY(a);var f=this.IMREAL(b[c]),h=this.IMAGINARY(b[c]);if(e.anyIsError(d,a,f,h))return k.value;a=this.COMPLEX(d+f,a+h)}return a};g.IMTAN=function(b){if(!0===b||!1===b)return k.value;var a=g.IMREAL(b),c=g.IMAGINARY(b);return e.anyIsError(a,
c)?k.value:this.IMDIV(this.IMSIN(b),this.IMCOS(b))};g.OCT2BIN=function(b,a){if(!/^[0-7]{1,10}$/.test(b))return k.num;var c=10===b.length&&"7"===b.substring(0,1)?!0:!1;b=c?parseInt(b,8)-1073741824:parseInt(b,8);if(-512>b||511<b)return k.num;if(c)return"1"+REPT("0",9-(512+b).toString(2).length)+(512+b).toString(2);c=b.toString(2);if("undefined"===typeof a)return c;if(isNaN(a))return k.value;if(0>a)return k.num;a=Math.floor(a);return a>=c.length?REPT("0",a-c.length)+c:k.num};g.OCT2DEC=function(b){if(!/^[0-7]{1,10}$/.test(b))return k.num;
b=parseInt(b,8);return 536870912<=b?b-1073741824:b};g.OCT2HEX=function(b,a){if(!/^[0-7]{1,10}$/.test(b))return k.num;b=parseInt(b,8);if(536870912<=b)return"ff"+(b+3221225472).toString(16);b=b.toString(16);if(void 0===a)return b;if(isNaN(a))return k.value;if(0>a)return k.num;a=Math.floor(a);return a>=b.length?REPT("0",a-b.length)+b:k.num};return g}();y.financial=function(){function g(c){return c&&c.getTime&&!isNaN(c.getTime())}function b(c){return c instanceof Date?c:new Date(c)}var a={ACCRINT:function(c,
d,f,h,l,m,n){c=b(c);d=b(d);f=b(f);return g(c)&&g(d)&&g(f)?0>=h||0>=l||-1===[1,2,4].indexOf(m)||-1===[0,1,2,3,4].indexOf(n)||f<=c?"#NUM!":(l||0)*h*YEARFRAC(c,f,n||0):"#VALUE!"},ACCRINTM:null,AMORDEGRC:null,AMORLINC:null,COUPDAYBS:null,COUPDAYS:null,COUPDAYSNC:null,COUPNCD:null,COUPNUM:null,COUPPCD:null,CUMIPMT:function(c,d,f,h,l,m){c=e.parseNumber(c);d=e.parseNumber(d);f=e.parseNumber(f);if(e.anyIsError(c,d,f))return k.value;if(0>=c||0>=d||0>=f||1>h||1>l||h>l||0!==m&&1!==m)return k.num;d=a.PMT(c,d,
f,0,m);var n=0;1===h&&0===m&&(n=-f,h++);for(;h<=l;h++)n=1===m?n+(a.FV(c,h-2,d,f,1)-d):n+a.FV(c,h-1,d,f,0);return n*c},CUMPRINC:function(c,d,f,h,l,m){c=e.parseNumber(c);d=e.parseNumber(d);f=e.parseNumber(f);if(e.anyIsError(c,d,f))return k.value;if(0>=c||0>=d||0>=f||1>h||1>l||h>l||0!==m&&1!==m)return k.num;d=a.PMT(c,d,f,0,m);var n=0;1===h&&(n=0===m?d+f*c:d,h++);for(;h<=l;h++)n=0<m?n+(d-(a.FV(c,h-2,d,f,1)-d)*c):n+(d-a.FV(c,h-1,d,f,0)*c);return n},DB:function(c,d,f,h,l){l=void 0===l?12:l;c=e.parseNumber(c);
d=e.parseNumber(d);f=e.parseNumber(f);h=e.parseNumber(h);l=e.parseNumber(l);if(e.anyIsError(c,d,f,h,l))return k.value;if(0>c||0>d||0>f||0>h||-1===[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(l)||h>f)return k.num;if(d>=c)return 0;d=(1-Math.pow(d/c,1/f)).toFixed(3);for(var m=l=c*d*l/12,n=0,p=h===f?f-1:h,q=2;q<=p;q++)n=(c-m)*d,m+=n;return 1===h?l:h===f?(c-m)*d:n},DDB:function(c,d,f,h,l){l=void 0===l?2:l;c=e.parseNumber(c);d=e.parseNumber(d);f=e.parseNumber(f);h=e.parseNumber(h);l=e.parseNumber(l);if(e.anyIsError(c,
d,f,h,l))return k.value;if(0>c||0>d||0>f||0>h||0>=l||h>f)return k.num;if(d>=c)return 0;for(var m=0,n=0,p=1;p<=h;p++)n=Math.min(l/f*(c-m),c-d-m),m+=n;return n},DISC:null,DOLLARDE:function(c,d){c=e.parseNumber(c);d=e.parseNumber(d);if(e.anyIsError(c,d))return k.value;if(0>d)return k.num;if(0<=d&&1>d)return k.div0;d=parseInt(d,10);var f=parseInt(c,10);f+=c%1*Math.pow(10,Math.ceil(Math.log(d)/Math.LN10))/d;c=Math.pow(10,Math.ceil(Math.log(d)/Math.LN2)+1);return f=Math.round(f*c)/c},DOLLARFR:function(c,
d){c=e.parseNumber(c);d=e.parseNumber(d);if(e.anyIsError(c,d))return k.value;if(0>d)return k.num;if(0<=d&&1>d)return k.div0;d=parseInt(d,10);var f=parseInt(c,10);return f+=c%1*Math.pow(10,-Math.ceil(Math.log(d)/Math.LN10))*d},DURATION:null,EFFECT:function(c,d){c=e.parseNumber(c);d=e.parseNumber(d);if(e.anyIsError(c,d))return k.value;if(0>=c||1>d)return k.num;d=parseInt(d,10);return Math.pow(1+c/d,d)-1},FV:function(c,d,f,h,l){h=h||0;l=l||0;c=e.parseNumber(c);d=e.parseNumber(d);f=e.parseNumber(f);h=
e.parseNumber(h);l=e.parseNumber(l);if(e.anyIsError(c,d,f,h,l))return k.value;0===c?c=h+f*d:(d=Math.pow(1+c,d),c=1===l?h*d+f*(1+c)*(d-1)/c:h*d+f*(d-1)/c);return-c},FVSCHEDULE:function(c,d){c=e.parseNumber(c);d=e.parseNumberArray(e.flatten(d));if(e.anyIsError(c,d))return k.value;for(var f=d.length,h=0;h<f;h++)c*=1+d[h];return c},INTRATE:null,IPMT:function(c,d,f,h,l,m){l=l||0;m=m||0;c=e.parseNumber(c);d=e.parseNumber(d);f=e.parseNumber(f);h=e.parseNumber(h);l=e.parseNumber(l);m=e.parseNumber(m);if(e.anyIsError(c,
d,f,h,l,m))return k.value;f=a.PMT(c,f,h,l,m);return(1===d?1===m?0:-h:1===m?a.FV(c,d-2,f,h,1)-f:a.FV(c,d-1,f,h,0))*c},IRR:function(c,d){d=d||0;c=e.parseNumberArray(e.flatten(c));d=e.parseNumber(d);if(e.anyIsError(c,d))return k.value;for(var f=function(q,t,u){u+=1;for(var r=q[0],v=1;v<q.length;v++)r+=q[v]/Math.pow(u,(t[v]-t[0])/365);return r},h=function(q,t,u){u+=1;for(var r=0,v=1;v<q.length;v++){var C=(t[v]-t[0])/365;r-=C*q[v]/Math.pow(u,C+1)}return r},l=[],m=!1,n=!1,p=0;p<c.length;p++)l[p]=0===p?
0:l[p-1]+365,0<c[p]&&(m=!0),0>c[p]&&(n=!0);if(!m||!n)return k.num;d=void 0===d?.1:d;m=!0;do p=f(c,l,d),m=d-p/h(c,l,d),n=Math.abs(m-d),d=m,m=1E-10<n&&1E-10<Math.abs(p);while(m);return d},ISPMT:function(c,d,f,h){c=e.parseNumber(c);d=e.parseNumber(d);f=e.parseNumber(f);h=e.parseNumber(h);return e.anyIsError(c,d,f,h)?k.value:h*c*(d/f-1)},MDURATION:null,MIRR:function(c,d,f){c=e.parseNumberArray(e.flatten(c));d=e.parseNumber(d);f=e.parseNumber(f);if(e.anyIsError(c,d,f))return k.value;for(var h=c.length,
l=[],m=[],n=0;n<h;n++)0>c[n]?l.push(c[n]):m.push(c[n]);c=-a.NPV(f,m)*Math.pow(1+f,h-1);d=a.NPV(d,l)*(1+d);return Math.pow(c/d,1/(h-1))-1},NOMINAL:function(c,d){c=e.parseNumber(c);d=e.parseNumber(d);if(e.anyIsError(c,d))return k.value;if(0>=c||1>d)return k.num;d=parseInt(d,10);return(Math.pow(c+1,1/d)-1)*d},NPER:function(c,d,f,h,l){l=void 0===l?0:l;h=void 0===h?0:h;c=e.parseNumber(c);d=e.parseNumber(d);f=e.parseNumber(f);h=e.parseNumber(h);l=e.parseNumber(l);return e.anyIsError(c,d,f,h,l)?k.value:
Math.log((d*(1+c*l)-h*c)/(f*c+d*(1+c*l)))/Math.log(1+c)},NPV:function(){var c=e.parseNumberArray(e.flatten(arguments));if(c instanceof Error)return c;for(var d=c[0],f=0,h=1;h<c.length;h++)f+=c[h]/Math.pow(1+d,h);return f},ODDFPRICE:null,ODDFYIELD:null,ODDLPRICE:null,ODDLYIELD:null,PDURATION:function(c,d,f){c=e.parseNumber(c);d=e.parseNumber(d);f=e.parseNumber(f);return e.anyIsError(c,d,f)?k.value:0>=c?k.num:(Math.log(f)-Math.log(d))/Math.log(1+c)},PMT:function(c,d,f,h,l){h=h||0;l=l||0;c=e.parseNumber(c);
d=e.parseNumber(d);f=e.parseNumber(f);h=e.parseNumber(h);l=e.parseNumber(l);if(e.anyIsError(c,d,f,h,l))return k.value;0===c?c=(f+h)/d:(d=Math.pow(1+c,d),c=1===l?(h*c/(d-1)+f*c/(1-1/d))/(1+c):h*c/(d-1)+f*c/(1-1/d));return-c},PPMT:function(c,d,f,h,l,m){l=l||0;m=m||0;c=e.parseNumber(c);f=e.parseNumber(f);h=e.parseNumber(h);l=e.parseNumber(l);m=e.parseNumber(m);return e.anyIsError(c,f,h,l,m)?k.value:a.PMT(c,f,h,l,m)-a.IPMT(c,d,f,h,l,m)},PRICE:null,PRICEDISC:null,PRICEMAT:null,PV:function(c,d,f,h,l){h=
h||0;l=l||0;c=e.parseNumber(c);d=e.parseNumber(d);f=e.parseNumber(f);h=e.parseNumber(h);l=e.parseNumber(l);return e.anyIsError(c,d,f,h,l)?k.value:0===c?-f*d-h:((1-Math.pow(1+c,d))/c*f*(1+c*l)-h)/Math.pow(1+c,d)},RATE:function(c,d,f,h,l,m){m=void 0===m?.01:m;h=void 0===h?0:h;l=void 0===l?0:l;c=e.parseNumber(c);d=e.parseNumber(d);f=e.parseNumber(f);h=e.parseNumber(h);l=e.parseNumber(l);m=e.parseNumber(m);if(e.anyIsError(c,d,f,h,l,m))return k.value;for(var n=0,p=!1;100>n&&!p;){var q=Math.pow(m+1,c),
t=Math.pow(m+1,c-1);q=m-(h+q*f+d*(q-1)*(m*l+1)/m)/(c*t*f-d*(q-1)*(m*l+1)/Math.pow(m,2)+(c*d*t*(m*l+1)/m+d*(q-1)*l/m));1E-6>Math.abs(q-m)&&(p=!0);n++;m=q}return p?m:Number.NaN+m},RECEIVED:null,RRI:function(c,d,f){c=e.parseNumber(c);d=e.parseNumber(d);f=e.parseNumber(f);return e.anyIsError(c,d,f)?k.value:0===c||0===d?k.num:Math.pow(f/d,1/c)-1},SLN:function(c,d,f){c=e.parseNumber(c);d=e.parseNumber(d);f=e.parseNumber(f);return e.anyIsError(c,d,f)?k.value:0===f?k.num:(c-d)/f},SYD:function(c,d,f,h){c=
e.parseNumber(c);d=e.parseNumber(d);f=e.parseNumber(f);h=e.parseNumber(h);if(e.anyIsError(c,d,f,h))return k.value;if(0===f||1>h||h>f)return k.num;h=parseInt(h,10);return(c-d)*(f-h+1)*2/(f*(f+1))},TBILLEQ:function(c,d,f){c=e.parseDate(c);d=e.parseDate(d);f=e.parseNumber(f);return e.anyIsError(c,d,f)?k.value:0>=f||c>d||31536E6<d-c?k.num:365*f/(360-f*DAYS360(c,d,!1))},TBILLPRICE:function(c,d,f){c=e.parseDate(c);d=e.parseDate(d);f=e.parseNumber(f);return e.anyIsError(c,d,f)?k.value:0>=f||c>d||31536E6<
d-c?k.num:100*(1-f*DAYS360(c,d,!1)/360)},TBILLYIELD:function(c,d,f){c=e.parseDate(c);d=e.parseDate(d);f=e.parseNumber(f);return e.anyIsError(c,d,f)?k.value:0>=f||c>d||31536E6<d-c?k.num:360*(100-f)/(f*DAYS360(c,d,!1))},VDB:null,XIRR:function(c,d,f){c=e.parseNumberArray(e.flatten(c));d=e.parseDateArray(e.flatten(d));f=e.parseNumber(f);if(e.anyIsError(c,d,f))return k.value;for(var h=function(q,t,u){u+=1;for(var r=q[0],v=1;v<q.length;v++)r+=q[v]/Math.pow(u,DAYS(t[v],t[0])/365);return r},l=function(q,
t,u){u+=1;for(var r=0,v=1;v<q.length;v++){var C=DAYS(t[v],t[0])/365;r-=C*q[v]/Math.pow(u,C+1)}return r},m=!1,n=!1,p=0;p<c.length;p++)0<c[p]&&(m=!0),0>c[p]&&(n=!0);if(!m||!n)return k.num;f=f||.1;m=!0;do p=h(c,d,f),m=f-p/l(c,d,f),n=Math.abs(m-f),f=m,m=1E-10<n&&1E-10<Math.abs(p);while(m);return f},XNPV:function(c,d,f){c=e.parseNumber(c);d=e.parseNumberArray(e.flatten(d));f=e.parseDateArray(e.flatten(f));if(e.anyIsError(c,d,f))return k.value;for(var h=0,l=0;l<d.length;l++)h+=d[l]/Math.pow(1+c,DAYS(f[l],
f[0])/365);return h},YIELD:null,YIELDDISC:null,YIELDMAT:null};return a}();y.information=function(){var g={CELL:null,ERROR:{}};g.ERROR.TYPE=function(b){switch(b){case k.nil:return 1;case k.div0:return 2;case k.value:return 3;case k.ref:return 4;case k.name:return 5;case k.num:return 6;case k.na:return 7;case k.data:return 8}return k.na};g.INFO=null;g.ISBLANK=function(b){return null===b||void 0===b||""===b};g.ISBINARY=function(b){return/^[01]{1,10}$/.test(b)};g.ISERR=function(b){return 0<=[k.value,
k.ref,k.div0,k.num,k.name,k.nil].indexOf(b)||"number"===typeof b&&(isNaN(b)||!isFinite(b))};g.ISERROR=function(b){return g.ISERR(b)||b===k.na};g.ISEVEN=function(b){return Math.floor(Math.abs(b))&1?!1:!0};g.ISFORMULA=null;g.ISLOGICAL=function(b){return!0===b||!1===b};g.ISNA=function(b){return b===k.na};g.ISNONTEXT=function(b){return"string"!==typeof b};g.ISNUMBER=function(b){return"number"===typeof b&&!isNaN(b)&&isFinite(b)};g.ISODD=function(b){return Math.floor(Math.abs(b))&1?!0:!1};g.ISREF=null;
g.ISTEXT=function(b){return"string"===typeof b};g.N=function(b){return this.ISNUMBER(b)?b:b instanceof Date?b.getTime():!0===b?1:!1===b?0:this.ISERROR(b)?b:0};g.NA=function(){return k.na};g.SHEET=null;g.SHEETS=null;g.TYPE=function(b){if(this.ISNUMBER(b))return 1;if(this.ISTEXT(b))return 2;if(this.ISLOGICAL(b))return 4;if(this.ISERROR(b))return 16;if(Array.isArray(b))return 64};return g}();y.logical=function(){return{AND:function(){for(var g=e.flatten(arguments),b=!0,a=0;a<g.length;a++)g[a]||(b=!1);
return b},CHOOSE:function(){if(2>arguments.length)return k.na;var g=arguments[0];return 1>g||254<g||arguments.length<g+1?k.value:arguments[g]},FALSE:function(){return!1},IF:function(g,b,a){return g?b:a},IFERROR:function(g,b){return ISERROR(g)?b:g},IFNA:function(g,b){return g===k.na?b:g},NOT:function(g){return!g},OR:function(){for(var g=e.flatten(arguments),b=!1,a=0;a<g.length;a++)g[a]&&(b=!0);return b},TRUE:function(){return!0},XOR:function(){for(var g=e.flatten(arguments),b=0,a=0;a<g.length;a++)g[a]&&
b++;return Math.floor(Math.abs(b))&1?!0:!1},SWITCH:function(){if(0<arguments.length){var g=arguments[0],b=arguments.length-1,a=Math.floor(b/2),c=!1;b=0===b%2?null:arguments[arguments.length-1];if(a)for(var d=0;d<a;d++)if(g===arguments[2*d+1]){var f=arguments[2*d+2];c=!0;break}!c&&b&&(f=b)}return f}}}();y.math=function(){var g={ABS:function(a){a=e.parseNumber(a);return a instanceof Error?a:Math.abs(e.parseNumber(a))},ACOS:function(a){a=e.parseNumber(a);return a instanceof Error?a:Math.acos(a)},ACOSH:function(a){a=
e.parseNumber(a);return a instanceof Error?a:Math.log(a+Math.sqrt(a*a-1))},ACOT:function(a){a=e.parseNumber(a);return a instanceof Error?a:Math.atan(1/a)},ACOTH:function(a){a=e.parseNumber(a);return a instanceof Error?a:.5*Math.log((a+1)/(a-1))},AGGREGATE:null,ARABIC:function(a){if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(a))return k.value;var c=0;a.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,function(d){c+={M:1E3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,
I:1}[d]});return c},ASIN:function(a){a=e.parseNumber(a);return a instanceof Error?a:Math.asin(a)},ASINH:function(a){a=e.parseNumber(a);return a instanceof Error?a:Math.log(a+Math.sqrt(a*a+1))},ATAN:function(a){a=e.parseNumber(a);return a instanceof Error?a:Math.atan(a)},ATAN2:function(a,c){a=e.parseNumber(a);c=e.parseNumber(c);return e.anyIsError(a,c)?k.value:Math.atan2(a,c)},ATANH:function(a){a=e.parseNumber(a);return a instanceof Error?a:Math.log((1+a)/(1-a))/2},BASE:function(a,c,d){d=d||0;a=e.parseNumber(a);
c=e.parseNumber(c);d=e.parseNumber(d);if(e.anyIsError(a,c,d))return k.value;d=void 0===d?0:d;a=a.toString(c);return Array(Math.max(d+1-a.length,0)).join("0")+a},CEILING:function(a,c,d){c=void 0===c?1:c;d=void 0===d?0:d;a=e.parseNumber(a);c=e.parseNumber(c);d=e.parseNumber(d);if(e.anyIsError(a,c,d))return k.value;if(0===c)return 0;c=Math.abs(c);return 0<=a?Math.ceil(a/c)*c:0===d?-1*Math.floor(Math.abs(a)/c)*c:-1*Math.ceil(Math.abs(a)/c)*c}};g.CEILING.MATH=g.CEILING;g.CEILING.PRECISE=g.CEILING;g.COMBIN=
function(a,c){a=e.parseNumber(a);c=e.parseNumber(c);return e.anyIsError(a,c)?k.value:g.FACT(a)/(g.FACT(c)*g.FACT(a-c))};g.COMBINA=function(a,c){a=e.parseNumber(a);c=e.parseNumber(c);return e.anyIsError(a,c)?k.value:0===a&&0===c?1:g.COMBIN(a+c-1,a-1)};g.COS=function(a){a=e.parseNumber(a);return a instanceof Error?a:Math.cos(a)};g.COSH=function(a){a=e.parseNumber(a);return a instanceof Error?a:(Math.exp(a)+Math.exp(-a))/2};g.COT=function(a){a=e.parseNumber(a);return a instanceof Error?a:1/Math.tan(a)};
g.COTH=function(a){a=e.parseNumber(a);if(a instanceof Error)return a;a=Math.exp(2*a);return(a+1)/(a-1)};g.CSC=function(a){a=e.parseNumber(a);return a instanceof Error?a:1/Math.sin(a)};g.CSCH=function(a){a=e.parseNumber(a);return a instanceof Error?a:2/(Math.exp(a)-Math.exp(-a))};g.DECIMAL=function(a,c){return 1>arguments.length?k.value:parseInt(a,c)};g.DEGREES=function(a){a=e.parseNumber(a);return a instanceof Error?a:180*a/Math.PI};g.EVEN=function(a){a=e.parseNumber(a);return a instanceof Error?
a:g.CEILING(a,-2,-1)};g.EXP=Math.exp;var b=[];g.FACT=function(a){a=e.parseNumber(a);if(a instanceof Error)return a;a=Math.floor(a);if(0===a||1===a)return 1;0<b[a]||(b[a]=g.FACT(a-1)*a);return b[a]};g.FACTDOUBLE=function(a){a=e.parseNumber(a);if(a instanceof Error)return a;a=Math.floor(a);return 0>=a?1:a*g.FACTDOUBLE(a-2)};g.FLOOR=function(a,c,d){c=void 0===c?1:c;d=void 0===d?0:d;a=e.parseNumber(a);c=e.parseNumber(c);d=e.parseNumber(d);if(e.anyIsError(a,c,d))return k.value;if(0===c)return 0;c=Math.abs(c);
return 0<=a?Math.floor(a/c)*c:0===d?-1*Math.ceil(Math.abs(a)/c)*c:-1*Math.floor(Math.abs(a)/c)*c};g.FLOOR.MATH=g.FLOOR;g.GCD=null;g.INT=function(a){a=e.parseNumber(a);return a instanceof Error?a:Math.floor(a)};g.LCM=function(){var a=e.parseNumberArray(e.flatten(arguments));if(a instanceof Error)return a;for(var c,d,f,h=1;void 0!==(f=a.pop());)for(;1<f;){if(f%2){c=3;for(d=Math.floor(Math.sqrt(f));c<=d&&f%c;c+=2);d=c<=d?c:f}else d=2;f/=d;h*=d;for(c=a.length;c;0===a[--c]%d&&1===(a[c]/=d)&&a.splice(c,
1));}return h};g.LN=function(a){a=e.parseNumber(a);return a instanceof Error?a:Math.log(a)};g.LOG=function(a,c){a=e.parseNumber(a);c=void 0===c?10:e.parseNumber(c);return e.anyIsError(a,c)?k.value:Math.log(a)/Math.log(c)};g.LOG10=function(a){a=e.parseNumber(a);return a instanceof Error?a:0===a?k.num:Math.log(a)/Math.log(10)};g.MDETERM=null;g.MINVERSE=null;g.MMULT=null;g.MOD=function(a,c){a=e.parseNumber(a);c=e.parseNumber(c);if(e.anyIsError(a,c))return k.value;if(0===c)return k.div0;a=Math.abs(a%
c);return 0<c?a:-a};g.MROUND=function(a,c){a=e.parseNumber(a);c=e.parseNumber(c);return e.anyIsError(a,c)?k.value:0>a*c?k.num:Math.round(a/c)*c};g.MULTINOMIAL=function(){var a=e.parseNumberArray(e.flatten(arguments));if(a instanceof Error)return a;for(var c=0,d=1,f=0;f<a.length;f++)c+=a[f],d*=g.FACT(a[f]);return g.FACT(c)/d};g.MUNIT=null;g.ODD=function(a){a=e.parseNumber(a);if(a instanceof Error)return a;var c=Math.ceil(Math.abs(a));c=c&1?c:c+1;return 0<a?c:-c};g.PI=function(){return Math.PI};g.POWER=
function(a,c){a=e.parseNumber(a);c=e.parseNumber(c);if(e.anyIsError(a,c))return k.value;a=Math.pow(a,c);return isNaN(a)?k.num:a};g.PRODUCT=function(){var a=e.parseNumberArray(e.flatten(arguments));if(a instanceof Error)return a;for(var c=1,d=0;d<a.length;d++)c*=a[d];return c};g.QUOTIENT=function(a,c){a=e.parseNumber(a);c=e.parseNumber(c);return e.anyIsError(a,c)?k.value:parseInt(a/c,10)};g.RADIANS=function(a){a=e.parseNumber(a);return a instanceof Error?a:a*Math.PI/180};g.RAND=function(){return Math.random()};
g.RANDBETWEEN=function(a,c){a=e.parseNumber(a);c=e.parseNumber(c);return e.anyIsError(a,c)?k.value:a+Math.ceil((c-a+1)*Math.random())-1};g.ROMAN=null;g.ROUND=function(a,c){a=e.parseNumber(a);c=e.parseNumber(c);return e.anyIsError(a,c)?k.value:Math.round(a*Math.pow(10,c))/Math.pow(10,c)};g.ROUNDDOWN=function(a,c){a=e.parseNumber(a);c=e.parseNumber(c);return e.anyIsError(a,c)?k.value:(0<a?1:-1)*Math.floor(Math.abs(a)*Math.pow(10,c))/Math.pow(10,c)};g.ROUNDUP=function(a,c){a=e.parseNumber(a);c=e.parseNumber(c);
return e.anyIsError(a,c)?k.value:(0<a?1:-1)*Math.ceil(Math.abs(a)*Math.pow(10,c))/Math.pow(10,c)};g.SEC=function(a){a=e.parseNumber(a);return a instanceof Error?a:1/Math.cos(a)};g.SECH=function(a){a=e.parseNumber(a);return a instanceof Error?a:2/(Math.exp(a)+Math.exp(-a))};g.SERIESSUM=function(a,c,d,f){a=e.parseNumber(a);c=e.parseNumber(c);d=e.parseNumber(d);f=e.parseNumberArray(f);if(e.anyIsError(a,c,d,f))return k.value;for(var h=f[0]*Math.pow(a,c),l=1;l<f.length;l++)h+=f[l]*Math.pow(a,c+l*d);return h};
g.SIGN=function(a){a=e.parseNumber(a);return a instanceof Error?a:0>a?-1:0===a?0:1};g.SIN=function(a){a=e.parseNumber(a);return a instanceof Error?a:Math.sin(a)};g.SINH=function(a){a=e.parseNumber(a);return a instanceof Error?a:(Math.exp(a)-Math.exp(-a))/2};g.SQRT=function(a){a=e.parseNumber(a);return a instanceof Error?a:0>a?k.num:Math.sqrt(a)};g.SQRTPI=function(a){a=e.parseNumber(a);return a instanceof Error?a:Math.sqrt(a*Math.PI)};g.SUBTOTAL=null;g.ADD=function(a,c){if(2!==arguments.length)return k.na;
a=e.parseNumber(a);c=e.parseNumber(c);return e.anyIsError(a,c)?k.value:a+c};g.MINUS=function(a,c){if(2!==arguments.length)return k.na;a=e.parseNumber(a);c=e.parseNumber(c);return e.anyIsError(a,c)?k.value:a-c};g.DIVIDE=function(a,c){if(2!==arguments.length)return k.na;a=e.parseNumber(a);c=e.parseNumber(c);return e.anyIsError(a,c)?k.value:0===c?k.div0:a/c};g.MULTIPLY=function(a,c){if(2!==arguments.length)return k.na;a=e.parseNumber(a);c=e.parseNumber(c);return e.anyIsError(a,c)?k.value:a*c};g.GTE=
function(a,c){if(2!==arguments.length)return k.na;a=e.parseNumber(a);c=e.parseNumber(c);return e.anyIsError(a,c)?k.error:a>=c};g.LT=function(a,c){if(2!==arguments.length)return k.na;a=e.parseNumber(a);c=e.parseNumber(c);return e.anyIsError(a,c)?k.error:a<c};g.LTE=function(a,c){if(2!==arguments.length)return k.na;a=e.parseNumber(a);c=e.parseNumber(c);return e.anyIsError(a,c)?k.error:a<=c};g.EQ=function(a,c){return 2!==arguments.length?k.na:a===c};g.NE=function(a,c){return 2!==arguments.length?k.na:
a!==c};g.POW=function(a,c){if(2!==arguments.length)return k.na;a=e.parseNumber(a);c=e.parseNumber(c);return e.anyIsError(a,c)?k.error:g.POWER(a,c)};g.SUM=function(){for(var a=0,c=Object.keys(arguments),d=0;d<c.length;++d){var f=arguments[c[d]];"number"===typeof f?a+=f:"string"===typeof f?(f=parseFloat(f),!isNaN(f)&&(a+=f)):Array.isArray(f)&&(a+=g.SUM.apply(null,f))}return a};g.SUMIF=function(){var a=e.argsToArray(arguments),c=a.pop();a=e.parseNumberArray(e.flatten(a));if(a instanceof Error)return a;
for(var d=0,f=0;f<a.length;f++)d+=eval(a[f]+c)?a[f]:0;return d};g.SUMIFS=function(){var a=e.argsToArray(arguments),c=e.parseNumberArray(e.flatten(a.shift()));if(c instanceof Error)return c;for(var d=c.length,f=a.length,h=0,l=0;l<d;l++){for(var m=c[l],n="",p=0;p<f;p+=2)n=isNaN(a[p][l])?n+('"'+a[p][l]+'"'+a[p+1]):n+(a[p][l]+a[p+1]),p!==f-1&&(n+=" && ");n=n.slice(0,-4);eval(n)&&(h+=m)}return h};g.SUMPRODUCT=null;g.SUMSQ=function(){var a=e.parseNumberArray(e.flatten(arguments));if(a instanceof Error)return a;
for(var c=0,d=a.length,f=0;f<d;f++)c+=ISNUMBER(a[f])?a[f]*a[f]:0;return c};g.SUMX2MY2=function(a,c){a=e.parseNumberArray(e.flatten(a));c=e.parseNumberArray(e.flatten(c));if(e.anyIsError(a,c))return k.value;for(var d=0,f=0;f<a.length;f++)d+=a[f]*a[f]-c[f]*c[f];return d};g.SUMX2PY2=function(a,c){a=e.parseNumberArray(e.flatten(a));c=e.parseNumberArray(e.flatten(c));if(e.anyIsError(a,c))return k.value;var d=0;a=e.parseNumberArray(e.flatten(a));c=e.parseNumberArray(e.flatten(c));for(var f=0;f<a.length;f++)d+=
a[f]*a[f]+c[f]*c[f];return d};g.SUMXMY2=function(a,c){a=e.parseNumberArray(e.flatten(a));c=e.parseNumberArray(e.flatten(c));if(e.anyIsError(a,c))return k.value;var d=0;a=e.flatten(a);c=e.flatten(c);for(var f=0;f<a.length;f++)d+=Math.pow(a[f]-c[f],2);return d};g.TAN=function(a){a=e.parseNumber(a);return a instanceof Error?a:Math.tan(a)};g.TANH=function(a){a=e.parseNumber(a);if(a instanceof Error)return a;a=Math.exp(2*a);return(a-1)/(a+1)};g.TRUNC=function(a,c){c=void 0===c?0:c;a=e.parseNumber(a);c=
e.parseNumber(c);return e.anyIsError(a,c)?k.value:(0<a?1:-1)*Math.floor(Math.abs(a)*Math.pow(10,c))/Math.pow(10,c)};return g}();y.misc=function(){var g={UNIQUE:function(){for(var b=[],a=0;a<arguments.length;++a){for(var c=!1,d=arguments[a],f=0;f<b.length&&!(c=b[f]===d);++f);c||b.push(d)}return b}};g.FLATTEN=e.flatten;g.ARGS2ARRAY=function(){return Array.prototype.slice.call(arguments,0)};g.REFERENCE=function(b,a){try{var c=a.split(".");for(a=0;a<c.length;++a){var d=c[a];if("]"===d[d.length-1]){var f=
d.indexOf("["),h=d.substring(f+1,d.length-1);b=b[d.substring(0,f)][h]}else b=b[d]}return b}catch(l){}};g.JOIN=function(b,a){return b.join(a)};g.NUMBERS=function(){return e.flatten(arguments).filter(function(b){return"number"===typeof b})};g.NUMERAL=null;return g}();y.text=function(){var g={ASC:null,BAHTTEXT:null,CHAR:function(b){b=e.parseNumber(b);return b instanceof Error?b:String.fromCharCode(b)},CLEAN:function(b){return(b||"").replace(/[\0-\x1F]/g,"")},CODE:function(b){return(b||"").charCodeAt(0)},
CONCATENATE:function(){for(var b=e.flatten(arguments),a;-1<(a=b.indexOf(!0));)b[a]="TRUE";for(;-1<(a=b.indexOf(!1));)b[a]="FALSE";return b.join("")},DBCS:null,DOLLAR:null,EXACT:function(b,a){return b===a},FIND:function(b,a,c){return a?a.indexOf(b,(void 0===c?0:c)-1)+1:null},FIXED:null,HTML2TEXT:function(b){var a="";b&&(b instanceof Array?b.forEach(function(c){""!==a&&(a+="\n");a+=c.replace(/<(?:.|\n)*?>/gm,"")}):a=b.replace(/<(?:.|\n)*?>/gm,""));return a},LEFT:function(b,a){a=e.parseNumber(void 0===
a?1:a);return a instanceof Error||"string"!==typeof b?k.value:b?b.substring(0,a):null},LEN:function(b){return 0===arguments.length?k.error:"string"===typeof b?b?b.length:0:b.length?b.length:k.value},LOWER:function(b){return"string"!==typeof b?k.value:b?b.toLowerCase():b},MID:function(b,a,c){a=e.parseNumber(a);c=e.parseNumber(c);if(e.anyIsError(a,c)||"string"!==typeof b)return c;--a;return b.substring(a,a+c)},NUMBERVALUE:null,PRONETIC:null,PROPER:function(b){if(void 0===b||0===b.length)return k.value;
!0===b&&(b="TRUE");!1===b&&(b="FALSE");if(isNaN(b)&&"number"===typeof b)return k.value;"number"===typeof b&&(b=""+b);return b.replace(/\w\S*/g,function(a){return a.charAt(0).toUpperCase()+a.substr(1).toLowerCase()})},REGEXEXTRACT:function(b,a){return(b=b.match(new RegExp(a)))?b[1<b.length?b.length-1:0]:null},REGEXMATCH:function(b,a,c){b=b.match(new RegExp(a));return c?b:!!b},REGEXREPLACE:function(b,a,c){return b.replace(new RegExp(a),c)},REPLACE:function(b,a,c,d){a=e.parseNumber(a);c=e.parseNumber(c);
return e.anyIsError(a,c)||"string"!==typeof b||"string"!==typeof d?k.value:b.substr(0,a-1)+d+b.substr(a-1+c)},REPT:function(b,a){a=e.parseNumber(a);return a instanceof Error?a:Array(a+1).join(b)},RIGHT:function(b,a){a=e.parseNumber(void 0===a?1:a);return a instanceof Error?a:b?b.substring(b.length-a):null},SEARCH:function(b,a,c){if("string"!==typeof b||"string"!==typeof a)return k.value;c=void 0===c?0:c;b=a.toLowerCase().indexOf(b.toLowerCase(),c-1)+1;return 0===b?k.value:b},SPLIT:function(b,a){return b.split(a)},
SUBSTITUTE:function(b,a,c,d){if(b&&a&&c){if(void 0===d)return b.replace(new RegExp(a,"g"),c);for(var f=0,h=0;0<b.indexOf(a,f);)if(f=b.indexOf(a,f+1),h++,h===d)return b.substring(0,f)+c+b.substring(f+a.length)}else return b},T:function(b){return"string"===typeof b?b:""},TEXT:null,TRIM:function(b){return"string"!==typeof b?k.value:b.replace(/ +/g," ").trim()}};g.UNICHAR=g.CHAR;g.UNICODE=g.CODE;g.UPPER=function(b){return"string"!==typeof b?k.value:b.toUpperCase()};g.VALUE=null;return g}();y.stats=function(){var g=
{AVEDEV:null,AVERAGE:function(){for(var b=e.numbers(e.flatten(arguments)),a=b.length,c=0,d=0,f=0;f<a;f++)c+=b[f],d+=1;return c/d},AVERAGEA:function(){for(var b=e.flatten(arguments),a=b.length,c=0,d=0,f=0;f<a;f++){var h=b[f];"number"===typeof h&&(c+=h);!0===h&&c++;null!==h&&d++}return c/d},AVERAGEIF:function(b,a,c){c=c||b;b=e.flatten(b);c=e.parseNumberArray(e.flatten(c));if(c instanceof Error)return c;for(var d=0,f=0,h=0;h<b.length;h++)eval(b[h]+a)&&(f+=c[h],d++);return f/d},AVERAGEIFS:null,COUNT:function(){return e.numbers(e.flatten(arguments)).length},
COUNTA:function(){var b=e.flatten(arguments);return b.length-g.COUNTBLANK(b)},COUNTIN:function(b,a){for(var c=0,d=0;d<b.length;d++)b[d]===a&&c++;return c},COUNTBLANK:function(){for(var b=e.flatten(arguments),a=0,c,d=0;d<b.length;d++)c=b[d],null!==c&&""!==c||a++;return a},COUNTIF:function(){var b=e.argsToArray(arguments),a=b.pop();b=e.flatten(b);/[<>=!]/.test(a)||(a='=="'+a+'"');for(var c=0,d=0;d<b.length;d++)"string"!==typeof b[d]?eval(b[d]+a)&&c++:eval('"'+b[d]+'"'+a)&&c++;return c},COUNTIFS:function(){for(var b=
e.argsToArray(arguments),a=Array(e.flatten(b[0]).length),c=0;c<a.length;c++)a[c]=!0;for(c=0;c<b.length;c+=2){var d=e.flatten(b[c]),f=b[c+1];/[<>=!]/.test(f)||(f='=="'+f+'"');for(var h=0;h<d.length;h++)a[h]="string"!==typeof d[h]?a[h]&&eval(d[h]+f):a[h]&&eval('"'+d[h]+'"'+f)}for(c=b=0;c<a.length;c++)a[c]&&b++;return b},COUNTUNIQUE:function(){return UNIQUE.apply(null,e.flatten(arguments)).length},FISHER:function(b){b=e.parseNumber(b);return b instanceof Error?b:Math.log((1+b)/(1-b))/2},FISHERINV:function(b){b=
e.parseNumber(b);if(b instanceof Error)return b;b=Math.exp(2*b);return(b-1)/(b+1)},FREQUENCY:function(b,a){b=e.parseNumberArray(e.flatten(b));a=e.parseNumberArray(e.flatten(a));if(e.anyIsError(b,a))return k.value;for(var c=b.length,d=a.length,f=[],h=0;h<=d;h++)for(var l=f[h]=0;l<c;l++)0===h?b[l]<=a[0]&&(f[0]+=1):h<d?b[l]>a[h-1]&&b[l]<=a[h]&&(f[h]+=1):h===d&&b[l]>a[d-1]&&(f[d]+=1);return f},LARGE:function(b,a){b=e.parseNumberArray(e.flatten(b));a=e.parseNumber(a);return e.anyIsError(b,a)?b:b.sort(function(c,
d){return d-c})[a-1]},MAX:function(){var b=e.numbers(e.flatten(arguments));return 0===b.length?0:Math.max.apply(Math,b)},MAXA:function(){var b=e.arrayValuesToNumbers(e.flatten(arguments));return 0===b.length?0:Math.max.apply(Math,b)},MIN:function(){var b=e.numbers(e.flatten(arguments));return 0===b.length?0:Math.min.apply(Math,b)},MINA:function(){var b=e.arrayValuesToNumbers(e.flatten(arguments));return 0===b.length?0:Math.min.apply(Math,b)},MODE:{}};g.MODE.MULT=function(){var b=e.parseNumberArray(e.flatten(arguments));
if(b instanceof Error)return b;for(var a=b.length,c={},d=[],f=0,h,l=0;l<a;l++)h=b[l],c[h]=c[h]?c[h]+1:1,c[h]>f&&(f=c[h],d=[]),c[h]===f&&(d[d.length]=h);return d};g.MODE.SNGL=function(){var b=e.parseNumberArray(e.flatten(arguments));return b instanceof Error?b:g.MODE.MULT(b).sort(function(a,c){return a-c})[0]};g.PERCENTILE={};g.PERCENTILE.EXC=function(b,a){b=e.parseNumberArray(e.flatten(b));a=e.parseNumber(a);if(e.anyIsError(b,a))return k.value;b=b.sort(function(d,f){return d-f});var c=b.length;if(a<
1/(c+1)||a>1-1/(c+1))return k.num;a=a*(c+1)-1;c=Math.floor(a);return e.cleanFloat(a===c?b[a]:b[c]+(a-c)*(b[c+1]-b[c]))};g.PERCENTILE.INC=function(b,a){b=e.parseNumberArray(e.flatten(b));a=e.parseNumber(a);if(e.anyIsError(b,a))return k.value;b=b.sort(function(d,f){return d-f});a*=b.length-1;var c=Math.floor(a);return e.cleanFloat(a===c?b[a]:b[c]+(a-c)*(b[c+1]-b[c]))};g.PERCENTRANK={};g.PERCENTRANK.EXC=function(b,a,c){c=void 0===c?3:c;b=e.parseNumberArray(e.flatten(b));a=e.parseNumber(a);c=e.parseNumber(c);
if(e.anyIsError(b,a,c))return k.value;b=b.sort(function(p,q){return p-q});var d=UNIQUE.apply(null,b),f=b.length,h=d.length;c=Math.pow(10,c);for(var l=0,m=!1,n=0;!m&&n<h;)a===d[n]?(l=(b.indexOf(d[n])+1)/(f+1),m=!0):a>=d[n]&&(a<d[n+1]||n===h-1)&&(l=(b.indexOf(d[n])+1+(a-d[n])/(d[n+1]-d[n]))/(f+1),m=!0),n++;return Math.floor(l*c)/c};g.PERCENTRANK.INC=function(b,a,c){c=void 0===c?3:c;b=e.parseNumberArray(e.flatten(b));a=e.parseNumber(a);c=e.parseNumber(c);if(e.anyIsError(b,a,c))return k.value;b=b.sort(function(p,
q){return p-q});var d=UNIQUE.apply(null,b),f=b.length,h=d.length;c=Math.pow(10,c);for(var l=0,m=!1,n=0;!m&&n<h;)a===d[n]?(l=b.indexOf(d[n])/(f-1),m=!0):a>=d[n]&&(a<d[n+1]||n===h-1)&&(l=(b.indexOf(d[n])+(a-d[n])/(d[n+1]-d[n]))/(f-1),m=!0),n++;return Math.floor(l*c)/c};g.PERMUT=function(b,a){b=e.parseNumber(b);a=e.parseNumber(a);return e.anyIsError(b,a)?k.value:FACT(b)/FACT(b-a)};g.PERMUTATIONA=function(b,a){b=e.parseNumber(b);a=e.parseNumber(a);return e.anyIsError(b,a)?k.value:Math.pow(b,a)};g.PHI=
function(b){b=e.parseNumber(b);return b instanceof Error?k.value:Math.exp(-.5*b*b)/2.5066282746310002};g.PROB=function(b,a,c,d){if(void 0===c)return 0;d=void 0===d?c:d;b=e.parseNumberArray(e.flatten(b));a=e.parseNumberArray(e.flatten(a));c=e.parseNumber(c);d=e.parseNumber(d);if(e.anyIsError(b,a,c,d))return k.value;if(c===d)return 0<=b.indexOf(c)?a[b.indexOf(c)]:0;for(var f=b.sort(function(n,p){return n-p}),h=f.length,l=0,m=0;m<h;m++)f[m]>=c&&f[m]<=d&&(l+=a[b.indexOf(f[m])]);return l};g.QUARTILE={};
g.QUARTILE.EXC=function(b,a){b=e.parseNumberArray(e.flatten(b));a=e.parseNumber(a);if(e.anyIsError(b,a))return k.value;switch(a){case 1:return g.PERCENTILE.EXC(b,.25);case 2:return g.PERCENTILE.EXC(b,.5);case 3:return g.PERCENTILE.EXC(b,.75);default:return k.num}};g.QUARTILE.INC=function(b,a){b=e.parseNumberArray(e.flatten(b));a=e.parseNumber(a);if(e.anyIsError(b,a))return k.value;switch(a){case 1:return g.PERCENTILE.INC(b,.25);case 2:return g.PERCENTILE.INC(b,.5);case 3:return g.PERCENTILE.INC(b,
.75);default:return k.num}};g.RANK={};g.RANK.AVG=function(b,a,c){b=e.parseNumber(b);a=e.parseNumberArray(e.flatten(a));if(e.anyIsError(b,a))return k.value;a=e.flatten(a);a=a.sort(c?function(h,l){return h-l}:function(h,l){return l-h});c=a.length;for(var d=0,f=0;f<c;f++)a[f]===b&&d++;return 1<d?(2*a.indexOf(b)+d+1)/2:a.indexOf(b)+1};g.RANK.EQ=function(b,a,c){b=e.parseNumber(b);a=e.parseNumberArray(e.flatten(a));if(e.anyIsError(b,a))return k.value;a=a.sort(c?function(d,f){return d-f}:function(d,f){return f-
d});return a.indexOf(b)+1};g.RSQ=function(b,a){b=e.parseNumberArray(e.flatten(b));a=e.parseNumberArray(e.flatten(a));return e.anyIsError(b,a)?k.value:Math.pow(g.PEARSON(b,a),2)};g.SMALL=function(b,a){b=e.parseNumberArray(e.flatten(b));a=e.parseNumber(a);return e.anyIsError(b,a)?b:b.sort(function(c,d){return c-d})[a-1]};g.STANDARDIZE=function(b,a,c){b=e.parseNumber(b);a=e.parseNumber(a);c=e.parseNumber(c);return e.anyIsError(b,a,c)?k.value:(b-a)/c};g.STDEV={};g.STDEV.P=function(){var b=g.VAR.P.apply(this,
arguments);return Math.sqrt(b)};g.STDEV.S=function(){var b=g.VAR.S.apply(this,arguments);return Math.sqrt(b)};g.STDEVA=function(){var b=g.VARA.apply(this,arguments);return Math.sqrt(b)};g.STDEVPA=function(){var b=g.VARPA.apply(this,arguments);return Math.sqrt(b)};g.VAR={};g.VAR.P=function(){for(var b=e.numbers(e.flatten(arguments)),a=b.length,c=0,d=g.AVERAGE(b),f=0;f<a;f++)c+=Math.pow(b[f]-d,2);return c/a};g.VAR.S=function(){for(var b=e.numbers(e.flatten(arguments)),a=b.length,c=0,d=g.AVERAGE(b),
f=0;f<a;f++)c+=Math.pow(b[f]-d,2);return c/(a-1)};g.VARA=function(){for(var b=e.flatten(arguments),a=b.length,c=0,d=0,f=g.AVERAGEA(b),h=0;h<a;h++){var l=b[h];c="number"===typeof l?c+Math.pow(l-f,2):!0===l?c+Math.pow(1-f,2):c+Math.pow(0-f,2);null!==l&&d++}return c/(d-1)};g.VARPA=function(){for(var b=e.flatten(arguments),a=b.length,c=0,d=0,f=g.AVERAGEA(b),h=0;h<a;h++){var l=b[h];c="number"===typeof l?c+Math.pow(l-f,2):!0===l?c+Math.pow(1-f,2):c+Math.pow(0-f,2);null!==l&&d++}return c/d};g.WEIBULL={};
g.WEIBULL.DIST=function(b,a,c,d){b=e.parseNumber(b);a=e.parseNumber(a);c=e.parseNumber(c);return e.anyIsError(b,a,c)?k.value:d?1-Math.exp(-Math.pow(b/c,a)):Math.pow(b,a-1)*Math.exp(-Math.pow(b/c,a))*a/Math.pow(c,a)};g.Z={};g.Z.TEST=function(b,a,c){b=e.parseNumberArray(e.flatten(b));a=e.parseNumber(a);if(e.anyIsError(b,a))return k.value;c=c||g.STDEV.S(b);var d=b.length;return 1-g.NORM.S.DIST((g.AVERAGE(b)-a)/(c/Math.sqrt(d)),!0)};return g}();y.utils=function(){return{PROGRESS:function(g,b){return'<div style="width:'+
(g?g:"0")+"%;height:4px;background-color:"+(b?b:"red")+';margin-top:1px;"></div>'},RATING:function(g){for(var b='<div class="jrating">',a=0;5>a;a++)b=a<g?b+'<div class="jrating-selected"></div>':b+"<div></div>";return b+"</div>"}}}();for(var G=0;G<Object.keys(y).length;G++)for(var B=y[Object.keys(y)[G]],z=Object.keys(B),x=0;x<z.length;x++)if(B[z[x]])if("function"==typeof B[z[x]]||"object"==typeof B[z[x]]){if(w[z[x]]=B[z[x]],w[z[x]].toString=function(){return"#ERROR"},"object"==typeof B[z[x]])for(var J=
Object.keys(B[z[x]]),H=0;H<J.length;H++)w[z[x]][J[H]].toString=function(){return"#ERROR"}}else w[z[x]]=function(){return z[x]+"Not implemented"};else w[z[x]]=function(){return z[x]+"Not implemented"};var I=null,D=null,E=null;w.TABLE=function(){return E};w.COLUMN=w.COL=function(){return parseInt(I)+1};w.ROW=function(){return parseInt(D)+1};w.CELL=function(){return A.getColumnNameFromCoords(I,D)};w.VALUE=function(g,b,a){return E.getValueFromCoords(parseInt(g)-1,parseInt(b)-1,a)};w.THISROWCELL=function(g){return E.getValueFromCoords(parseInt(g)-
1,parseInt(D))};var K=function(g,b){for(var a=0;a<g.length;a++){var c=A.getTokensFromRange(g[a]);b=b.replace(g[a],"["+c.join(",")+"]")}return b},A=function(g,b,a,c,d){E=d;I=a;D=c;c="";d=Object.keys(b);if(d.length){var f={};for(a=0;a<d.length;a++)if(h=d[a].replace(/!/g,"."),0<h.indexOf(".")){var h=h.split(".");f[h[0]]={}}h=Object.keys(f);for(a=0;a<h.length;a++)c+="var "+h[a]+" = {};";for(a=0;a<d.length;a++){h=d[a].replace(/!/g,".");if(f=null!==b[d[a]])f=b[d[a]],f=!(!isNaN(f)&&null!==f&&""!==f);f&&
(f=b[d[a]].match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g))&&f.length&&(b[d[a]]=K(f,b[d[a]]));c=0<h.indexOf(".")?c+(h+" = "+b[d[a]]+";\n"):c+("var "+h+" = "+b[d[a]]+";\n")}}g=g.replace(/\$/g,"");g=g.replace(/!/g,".");b="";a=0;d=["=","!",">","<"];for(h=0;h<g.length;h++)'"'==g[h]&&(a=0==a?1:0),1==a?b+=g[h]:(b+=g[h].toUpperCase(),0<h&&"="==g[h]&&-1==d.indexOf(g[h-1])&&-1==d.indexOf(g[h+1])&&(b+="="));b=b.replace(/\^/g,"**");b=b.replace(/<>/g,"!=");b=b.replace(/&/g,"+");g=b=b.replace(/\$/g,
"");(f=g.match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g))&&f.length&&(g=K(f,g));c=(new Function(c+"; return "+g))();null===c&&(c=0);return c};A.getColumnNameFromCoords=function(g,b){g=parseInt(g);var a="";701<g?(a+=String.fromCharCode(64+parseInt(g/676)),a+=String.fromCharCode(64+parseInt(g%676/26))):25<g&&(a+=String.fromCharCode(64+parseInt(g/26)));a+=String.fromCharCode(65+g%26);return a+(parseInt(b)+1)};A.getCoordsFromColumnName=function(g){var b=/^[a-zA-Z]+/.exec(g);if(b){for(var a=
0,c=0;c<b[0].length;c++)a+=parseInt(b[0].charCodeAt(c)-64)*Math.pow(26,b[0].length-1-c);a--;0>a&&(a=0);g=parseInt(/[0-9]+$/.exec(g))||null;0<g&&g--;return[a,g]}};A.getRangeFromTokens=function(g){g=g.filter(function(d){return"#REF!"!=d});for(var b="",a="",c=0;c<g.length;c++)0<=g[c].indexOf(".")?b=".":0<=g[c].indexOf("!")&&(b="!"),b&&(a=g[c].split(b),g[c]=a[1],a=a[0]+b);g.sort(function(d,f){d=Helpers.getCoordsFromColumnName(d);f=Helpers.getCoordsFromColumnName(f);return d[1]>f[1]?1:d[1]<f[1]?-1:d[0]>
f[0]?1:d[0]<f[0]?-1:0});return g.length?a+(g[0]+":"+g[g.length-1]):"#REF!"};A.getTokensFromRange=function(g){if(0<g.indexOf(".")){var b=g.split(".");g=b[1];b=b[0]+"."}else 0<g.indexOf("!")?(b=g.split("!"),g=b[1],b=b[0]+"!"):b="";g=g.split(":");var a=A.getCoordsFromColumnName(g[0]),c=A.getCoordsFromColumnName(g[1]);if(a[0]<=c[0]){g=a[0];var d=c[0]}else g=c[0],d=a[0];if(null===a[1]&&null==c[1])for(var f=null,h=null,l=Object.keys(vars),m=0;m<l.length;m++){var n=A.getCoordsFromColumnName(l[m]);n[0]===
a[0]&&(null===f||n[1]<f)&&(f=n[1]);n[0]===c[0]&&(null===h||n[1]>h)&&(h=n[1])}else a[1]<=c[1]?(f=a[1],h=c[1]):(f=c[1],h=a[1]);for(a=[];f<=h;f++){c=[];for(m=g;m<=d;m++)c.push(b+A.getColumnNameFromCoords(m,f));a.push(c)}return a};A.setFormula=function(g){for(var b=Object.keys(g),a=0;a<b.length;a++)"function"==typeof g[b[a]]&&(w[b[a]]=g[b[a]])};return A};return"undefined"!==typeof window?F(window):null});

if (! jSuites && typeof(require) === 'function') {
    var jSuites = require('jsuites');
}

var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(E){var J=0;return function(){return J<E.length?{done:!1,value:E[J++]}:{done:!0}}};$jscomp.arrayIterator=function(E){return{next:$jscomp.arrayIteratorImpl(E)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(E,J,N){if(E==Array.prototype||E==Object.prototype)return E;E[J]=N.value;return E};$jscomp.getGlobal=function(E){E=["object"==typeof globalThis&&globalThis,E,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var J=0;J<E.length;++J){var N=E[J];if(N&&N.Math==Math)return N}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(E,J){var N=$jscomp.propertyToPolyfillSymbol[J];if(null==N)return E[J];N=E[N];return void 0!==N?N:E[J]};
$jscomp.polyfill=function(E,J,N,W){J&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(E,J,N,W):$jscomp.polyfillUnisolated(E,J,N,W))};$jscomp.polyfillUnisolated=function(E,J,N,W){N=$jscomp.global;E=E.split(".");for(W=0;W<E.length-1;W++){var S=E[W];if(!(S in N))return;N=N[S]}E=E[E.length-1];W=N[E];J=J(W);J!=W&&null!=J&&$jscomp.defineProperty(N,E,{configurable:!0,writable:!0,value:J})};
$jscomp.polyfillIsolated=function(E,J,N,W){var S=E.split(".");E=1===S.length;W=S[0];W=!E&&W in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var aa=0;aa<S.length-1;aa++){var qa=S[aa];if(!(qa in W))return;W=W[qa]}S=S[S.length-1];N=$jscomp.IS_SYMBOL_NATIVE&&"es6"===N?W[S]:null;J=J(N);null!=J&&(E?$jscomp.defineProperty($jscomp.polyfills,S,{configurable:!0,writable:!0,value:J}):J!==N&&(void 0===$jscomp.propertyToPolyfillSymbol[S]&&(N=1E9*Math.random()>>>0,$jscomp.propertyToPolyfillSymbol[S]=
$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(S):$jscomp.POLYFILL_PREFIX+N+"$"+S),$jscomp.defineProperty(W,$jscomp.propertyToPolyfillSymbol[S],{configurable:!0,writable:!0,value:J})))};$jscomp.initSymbol=function(){};$jscomp.iteratorPrototype=function(E){E={next:E};E[Symbol.iterator]=function(){return this};return E};
$jscomp.iteratorFromArray=function(E,J){E instanceof String&&(E+="");var N=0,W=!1,S={next:function(){if(!W&&N<E.length){var aa=N++;return{value:J(aa,E[aa]),done:!1}}W=!0;return{done:!0,value:void 0}}};S[Symbol.iterator]=function(){return S};return S};$jscomp.polyfill("Array.prototype.values",function(E){return E?E:function(){return $jscomp.iteratorFromArray(this,function(J,N){return N})}},"es8","es3");
var _$_d043=["use strict","{","}","","9.0.34","Base","https://jspreadsheet.com","Unlicensed","Jspreadsheet Pro\r\n"," edition ","\r\n","set","&","&lt;","g","<","&gt;",">","=","!",'"',"undefined","number","fullscreen","block","string","readonly","jss_rotate","span","rotate(","deg)","jss_hidden_index","div","right","10px","pointer","/v8",",","localhost",".","v8"," (Expired)","Licensed to: ","Premium","License required","A valid license is required","This version is not included on the scope of this license",
"Your license is expired. Please renew your certificate.","jspreadsheet","img","/jspreadsheet/","logo.png","none","status","edition","scope","data-x","data-y","get","px","jss_frozen","0px","scroll","wheel","goto","jss_scroll","jss_hidden","jss_content_overflow","onresize","300px","Jspreadsheet Pro","text","autocomplete","dropdown","GET","json","Jspreadsheet Alert: secureFormulas is set to false.","setConfig","insertRow","deleteRow","insertColumn","deleteColumn","moveRow","moveColumn","setMerge","removeMerge",
"setStyle","resetStyle","setWidth","setHeight","setHeader","setComments","setFreezeColumns","setFreezeRows","orderBy","setValue","setProperty","updateProperty","renameWorksheet","moveWorksheet","setDefinedNames","onundo","onredo","object","function","contextMenu","toolbar","onevent","Jspreadsheet: cursor not in the viewport","keydown","oneditionstart","oncreateeditor","hidden","jss_focus","jss_formula","oneditionend","data-mask","data-value","inputmode","0","style","jss_input","contentEditable","oninput",
"setRowId","onchangerowid","setBorder","resetBorders","updateCells","setFormula","updateData","onbeforesave","POST","Authorization","Bearer ","onbeforesend","disconected",": ","Sorry, something went wrong, refreshing your spreadsheet...","_top","onsave","persistence","?","?worksheet=","&worksheet=","add","remove","jss_cursor","selected","main","copying","onblur","onfocus","onselection"," ","'","'!",":","jss_border","cloning","jss_border_","15","jss_resize_corner","data-action","ontouchstart","moveLeft",
"-6px","moveTop","moveRight","moveDown","-2000px","tr","jss_group_container","td","&nbsp;",".jss_group","jss_group","+","width","Jspreadsheet: This column is part of a merged cell.","jss_dragging","1px","jss_helper_col","Jspreadsheet: This row is part of a merged cell","Jspreadsheet: Please clear your search before perform this action","51px","jss_helper_row","No cell selected","Invalid merged properties","onmerge","colspan","rowspan","Column name","data-title","onchangeheader","jss_header","col",
"oncreatecolumn","jss_filters_icon","setFooter","onchangefooter","setFooterValue","onchangefootervalue","resetFooter","setNestedHeaders","onchangenested","jss_nested","resetNestedHeaders","setNestedCell","onchangenestedcell","center","data-nested-x","data-nested-y","align","calendar",'""',"\t","oncopy","copy","color: initial","onbeforepaste","JSS: For better results, please allow pagination or tableOverflow.","onpaste","Export not allowed","\ufeff","text/csv;charset=utf-8;",".csv","a","download",
"Defined names are only available on the Premium edition.","onchangedefinednames","#REF!","#1a237e","#b71c1c","#880e4f","#1b5e20","#ff6f00","-","/","*","^","(","[","|",";","data-token","picker","jss_picker","click","active","focus","input","jss_object","contenteditable","blur","last",'<b class="','" data-token="','">',"</b>","data-single","true","b",")","]","var "," = {};"," = ",";\n","; return ","onbeforeformula","#LOOP","Reference loop detected","#SELF","Self Reference detected","#ERROR","Table does not exist or is not loaded yet",
"CHART(","#SPILL!","jss_number","$","Something went wrong","onafterchanges","checkbox","autonumber","radio","email","url","color","progressbar","rating","onformulachain","onbeforechange","onchange","oncreatecell","values","mergeCells","title","jss_comments","jss_unlocked","jss_zebra","jss_wrap","onchangeproperty","jss_row","oncreaterow","Jspreadsheet: Invalid origin or destination","onmoverow","Jspreadsheet: Insert row is not enabled in the table configuration","onbeforeinsertrow","onbeforeinsertrow returned false",
"oninsertrow","Jspreadsheet: Delete row is not enabled in the table configuration","onbeforedeleterow","onbeforedeleterow returned false","meta","cells","comments","ondeleterow","Jspreadsheet: Invalid origin","Jspreadsheet: Invalid destination","onmovecolumn","Jspreadsheet: Insert column is not enabled in the table configuration","onbeforeinsertcolumn","onbeforeinsertcolumn returned false","record","col_","oninsertcolumn","Jspreadsheet: Delete column is not enabled in the table configuration","Jspreadsheet: it is not possible to delete the last column",
"onbeforedeletecolumn","onbeforedeletecolumn returned false","ondeletecolumn","; ","onchangestyle","No cell provided","onresetstyle","onbeforecomments","oncomments","setMeta","onchangemeta","resetMeta","onresetmeta","arrow-down","percent","numeric","onbeforesort","This action will destroy any existing merged cells. Are you sure?","onsort","arrow-up","jss_pagination","Jspreadsheet: No pagination defined","Jspreadsheet: pagination not defined","onbeforechangepage","onchangepage","No records found",
"jss_page","jss_page_selected","Showing page {0} of {1} entries","jss_frozen_row","jss_freeze_control_row","jss_freeze_control_col","jss_content","selectstart","table","thead","tbody","tfoot","jss_nogridline","colgroup","50","jss_selectall","JSS: Freeze controls are only available on the Premium edition.","jss","cellpadding","cellspacing","unselectable","yes","jss_","jss_overflow","jss_locked","jss_corner","on","onselectstart","return false","X","Y","jss_content_pagination","Frozen columns cannot be greater than the number of available columns",
"rows","onbeforechangereferences","onchangereferences","jss_container","jss_toolbar","jss_helper","jss_loading","textarea","jss_textarea","-1","bottom","beforeinit","Sheet","Worksheet clash name: ",". It is highly recommended to define a unique worksheetName on the initialization.","jss_worksheet","init","To improve the performance, use tableOverflow or pagination.","resize","touchstart","touchmove","touchend","onresizecolumn","onresizerow","label","jss_filters_active","Jspreadsheet: the filter is not enabled.",
"onopenfilter","Blanks","onbeforefilter","onfilter","gi","jss_filters_options","INPUT","Search","jss_filters_search","button","Ok","jss_filters_apply","jss_filters",'<input type="checkbox"> ',"Add current selection to filter",'<input type="checkbox"> (',"Select all","select","jss_pagination_dropdown","option","Show","entries","jss_search","jss_searching","onbeforesearch","onsearch","jss_search_container","jss_contextmenu","cell","row","header","Mac","&#8984;","Ctrl","tabs","Rename this worksheet",
"Delete this worksheet","Are you sure?","line","nested","Rename this cell","Cut","content_cut"," + X","Copy","content_copy"," + C","Paste","content_paste"," + V","Insert a new column before","Insert a new column after","Delete selected columns","Rename this column","Create a new row","Order ascending","Order descending","Insert a new row before","Insert a new row after","Delete selected rows","Edit notes","Add notes","notes","Notes","Clear notes","Save as","save"," + S","About","info","with-toolbar",
"i","undo","redo","divisor","120px","Verdana","Arial","Courier New",'<span style="font-family:',"</span>","font-family","48px","format_size","x-small","small","medium","large","x-large",'<span style="font-size:',"font-size","format_align_left","format_align_center","format_align_right","format_align_justify",'<i class="material-icons">',"</i>","text-align","_","format_align_","format_bold","font-weight","bold","format_color_text","format_color_fill","background-color","extended","top","middle","vertical_align_top",
"vertical_align_center","vertical_align_bottom","vertical-align","web","Merge the selected cells","border_all","border_outer","border_inner","border_horizontal","border_vertical","border_left","border_top","border_right","border_bottom","border_clear","black","border-left: ","px solid ","border-left: ; ","border-right: ","border-right: ; ","border-top: ","border-top: ; ","border-bottom: ","border-bottom: ; ","material-icons","color_lens",'<div style="height: ','px; width: 50px; background-color: black;"></div>',
"80px","1","fullscreen_exit","Toggle Fullscreen","search","search_off","Toggle Search","onbeforecreateworksheet","There is one existing worksheet with the same name.","createWorksheet","oncreateworksheet","deleteWorksheet","ondeleteworksheet","It was not possible to rename worksheet due conflict name","onrenameworksheet","onmoveworksheet","onopenworksheet","TABLE","Element is not a table","colgroup > col","data-celltype","readOnly","name","id",":scope > thead > tr",":scope > tr, :scope > tbody > tr",
"data-formula","class","styleBold","; font-weight:bold;","font-weight:bold;","tfoot tr","\r","\n","jss_ignore","THEAD","TBODY","TFOOT","selectall","header-group","jtabs-headers","filters","footer","jtoolbar","DIV","html","jss_nowrap","insertHTML","<br/>\n","Process","move","col-resize","grab","row-resize","A","mailto:","_blank","onclick","jclose","DOM el not found",'<table class="jss"><tbody><tr><td>A</td></tr></tbody></table>',"Cloud extension not loaded.","onload","jtabs","jss_dialog","decimal",
"data-locale","%","jss_percent","[Red]","red","jss_notes","145px","tag","jss_dropdown_tags","jss_dropdown","multiple","image","<div class='jss_dropdown_icon' style='background-color: ","'></div>","orange","<div class='jss_dropdown_tag' style='background-color: ","'>","</div>","timepicker","YYYY-MM-DD","square","100px","false","FALSE","disabled","TRUE","jss_progressbar","min","max","jss_rating"," stars","star","href","IMG","round","100%","jss_image","tabindex","jpanel","delete","jfile",'<img src="',
'" alt="">',"jss_richtext","jss_tags","40px","#NOTFOUND","<img src='","' class='round small' />","Jspreadsheet: worksheet not found "];
(function(E,J){typeof exports===_$_d043[103]&&typeof module!==_$_d043[21]?module.exports=J():typeof define===_$_d043[104]&&define.amd?define(J):E.jspreadsheet=E.jexcel=J()})(this,function(){_$_d043[0];var E=function(h,d){h=jSuites.translate(h);if(d&&d.length)for(var b=0;b<d.length;b++)h=h.replace(_$_d043[1]+b+_$_d043[2],d[b]);return h},J=function(h,d){Array.isArray(h)&&(h=h[0]);h=h.replace(new RegExp(/'/g),_$_d043[3]).toUpperCase();if(void 0===d)return window[h]?window[h]:null;window[h]=d},N=function(){var h=
{version:_$_d043[4],edition:_$_d043[5],host:_$_d043[6],license:_$_d043[7],print:function(){return[_$_d043[8]+this.edition+_$_d043[9]+this.version+_$_d043[10]+this.host+_$_d043[10]+this.license]}};return function(){return h}}(),W=function(h){var d=parseInt(h.y);if(h.id)var b=parseInt(h.id);else h.value&&(b=parseInt(h.value));0<b&&(this.rows[d].id=b,xa[_$_d043[11]].call(this,b))},S=function(h,d){var b=_$_d043[3],a=0;-1!==h.indexOf(_$_d043[12])&&(h=h.replace(new RegExp(_$_d043[13],_$_d043[14]),_$_d043[15]),
h=h.replace(new RegExp(_$_d043[16],_$_d043[14]),_$_d043[17]));for(var c=[_$_d043[18],_$_d043[19],_$_d043[17],_$_d043[15]],e=0;e<h.length;e++)h[e]==_$_d043[20]&&(a=0==a?1:0),1==a?b+=h[e]:(b+=h[e].toUpperCase(),1==d&&0<e&&h[e]==_$_d043[18]&&-1==c.indexOf(h[e-1])&&-1==c.indexOf(h[e+1])&&(b+=_$_d043[18]));return b},aa=function(h){return(_$_d043[3]+h).substr(0,1)===_$_d043[18]},qa=function(h){var d=this.options.columns;return d[h]&&d[h].name?d[h].name:h},O=function(h,d,b){var a;if(a=this.options.data[d]){var c=
0<=h?qa.call(this,h):h;typeof b===_$_d043[21]?b=typeof c===_$_d043[22]?a[h]:jSuites.path.call(a,_$_d043[3]+c):(typeof c===_$_d043[22]?a[h]=b:jSuites.path.call(a,_$_d043[3]+c,b),!aa(b)&&this.records[d][h]&&(this.records[d][h].v=b))}else b=null;return b},P=function(h){return 0==this.config.editable||h&&0==h.options.editable?!1:(h=Ma.call(this))?7<=h?!0:!1:!0},Na=function(h){var d=_$_d043[23];if(this.parent)var b=this.parent.config,a=this.parent.element,c=this;else b=this.config,a=this.element,c=u.current?
u.current:null;typeof h===_$_d043[21]&&(h=!a.classList.contains(d));h?(a.classList.add(d),b.fullscreen=!0):(a.classList.remove(d),b.fullscreen=!1);c&&(H.call(c,!0),ma.update.call(c.parent,c))},Oa=function(h){var d=this.loading;null===h&&(h=d.style.display==_$_d043[24]?!0:!1);d.style.display=h?_$_d043[24]:_$_d043[3];setTimeout(function(){d.style.display=_$_d043[3]},1E3)},Ja=function(h,d){if(typeof h===_$_d043[25]){var b=F.getCoordsFromColumnName(h);b=this.records[b[1]][b[0]];if(b.element)h=b.element;
else return typeof d===_$_d043[21]?b.readonly:b.readonly=d?!0:!1}b=_$_d043[26];h=h.classList;if(typeof d===_$_d043[21])return h.contains(b)?!0:!1;d?h.add(b):h.remove(b)},Ta=function(h,d){var b,a=[];if(typeof h===_$_d043[25]){var c=F.getCoordsFromColumnName(h);a.push({x:c[0],y:c[1],value:{rotate:d}})}else if(Array.isArray(h))for(b=0;b<h.length;b++)c=F.getCoordsFromColumnName(h[b]),a.push({x:c[0],y:c[1],value:{rotate:d}});for(b=0;b<a.length;b++)(c=this.records[a[b].y][a[b].x])&&c.element&&(h=c.element.firstChild,
d?(h&&h.classList&&h.classList.contains(_$_d043[27])||(h=document.createElement(_$_d043[28]),h.classList.add(_$_d043[27]),h.innerHTML=c.element.innerHTML,c.element.innerHTML=_$_d043[3],c.element.appendChild(h)),h.style.transform=_$_d043[29]+parseInt(270-d)+_$_d043[30]):h&&h.classList&&h.classList.contains(_$_d043[27])&&(h.classList.remove(_$_d043[27]),h.style.transform=_$_d043[3]));this.updateProperty(a);ba.refresh.call(this)},Aa=function(h){var d=_$_d043[31],b=this.table.classList;if(typeof h==_$_d043[21])return b.contains(d)?
!1:!0;h?b.remove(d):b.add(d);H.call(this,!0)},Ma=function(h){if(void 0===h)return this.status;var d=document.createElement(_$_d043[32]);d.style.textAlign=_$_d043[33];d.style.fontSize=_$_d043[34];d.style.cursor=_$_d043[35];d.onclick=function(){window.location.href=N().host+_$_d043[36]};var b=null,a=[],c=[74,50,48,50,48,33].join(_$_d043[3]);(function(g){b=1;try{if(g){var f=window.atob(g);f=f.split(_$_d043[37]);if(f[1]){f[1]=window.atob(f[1]);var k=f[0];g=c;var l=f[1],n=jSuites.sha512,q=_$_d043[3],p=
_$_d043[3];128<g.length&&(g=n(g));for(var v=0;128>v;v++){var w=g[v]?g[v].charCodeAt(0):0;q+=String.fromCharCode(54^w);p+=String.fromCharCode(92^w)}var x=n(p+n(q+l));if(k!=x)b=3;else if(f[1]=JSON.parse(f[1]),f[1].date){var y=window.location.hostname||_$_d043[38];k=!1;for(x=0;x<f[1].domain.length;x++)-1===f[1].domain[x].indexOf(_$_d043[39])?y===f[1].domain[x]&&(k=!0):y.substr(y.indexOf(f[1].domain[x]))==f[1].domain[x]&&(k=!0);!1===k?b=4:f[1].scope&&0<=f[1].scope.indexOf(_$_d043[40])?(y=new Date,k=parseInt(y.getTime()/
1E3),x=N(),f[1].date<k?(b=f[1].demo||!f[1].plan||f[1].date+2592E3<k?6:7,x.license=f[1].name+_$_d043[41]):(b=8,x.license=_$_d043[42]+f[1].name,x.edition=3==f[1].plan||6==f[1].plan||31==f[1].plan||33==f[1].plan?_$_d043[43]:_$_d043[5],a=f[1].scope)):b=5}else b=4}else b=2}}catch(A){}})(h);h=_$_d043[3];if(1==b)h=_$_d043[44];else if(2==b||3==b||4==b)h=_$_d043[45];else if(5==b)h=_$_d043[46];else if(6==b||7==b)h=_$_d043[47];d.appendChild(document.createTextNode(h));if(8>b)try{if(typeof sessionStorage!==_$_d043[21]&&
!sessionStorage.getItem(_$_d043[48])){sessionStorage.setItem(_$_d043[48],!0);var e=document.createElement(_$_d043[49]);e.src=N().host+_$_d043[50]+_$_d043[51];e.style.display=_$_d043[52];d.appendChild(e)}}catch(g){}Object.defineProperty(this,_$_d043[53],{value:b,writable:!1,configurable:!1,enumerable:!1,extensible:!1});Object.defineProperty(this,_$_d043[54],{value:N().edition===_$_d043[43]?1:0,writable:!1,configurable:!1,enumerable:!1,extensible:!1});Object.defineProperty(this,_$_d043[55],{get:function(){return a},
configurable:!1,enumerable:!1,extensible:!1});return d},H=function(){var h=function(l){-1==this.indexOf(l)&&this.push(l)},d=function(l,n){if(!l||!n)return!1;var q=l.length;if(q!=n.length)return!1;for(;q--;)if(l[q]!==n[q])return!1;return!0},b=function(l){var n=null,q,p,v=0,w={},x=!1;for(q=0;q<this.options.columns.length;q++)if(-1===l.indexOf(q)){if(ia.attached.call(this,q)){this.headers[q].parentNode.removeChild(this.headers[q]);this.colgroup[q].parentNode.removeChild(this.colgroup[q]);if(this.options.footers)for(p=
0;p<this.options.footers.length;p++)this.footers.content[p][q].element&&this.footers.content[p][q].element.parentNode&&this.footers.content[p][q].element.parentNode.removeChild(this.footers.content[p][q].element);x=!0}for(p=0;p<this.visibleRows.length;p++){var y=this.records[this.visibleRows[p]][q];y.element&&y.element.parentNode&&y.element.parentNode.removeChild(y.element)}}if(this.options.nestedHeaders)for(p=0;p<this.thead.children.length-1;p++)v+=this.thead.children[p].offsetHeight;for(q=0;q<l.length;q++){var A=
l[q];var z=Da.create.call(this,A);if(n){if(!z.parentNode){this.headerContainer.insertBefore(z,this.headerContainer.children[n].nextSibling);this.colgroupContainer.insertBefore(this.colgroup[A],this.colgroupContainer.children[n].nextSibling);if(this.options.footers)for(p=0;p<this.options.footers.length;p++)this.tfoot.children[p].insertBefore(fa.create.call(this,A,p),this.tfoot.children[p].children[n].nextSibling);v&&(z.style.top+=v);x=!0}for(p=0;p<this.visibleRows.length;p++)y=this.visibleRows[p],
y=Q[_$_d043[58]].call(this,A,y),y.parentNode||this.tbody.children[p].insertBefore(y,this.tbody.children[p].children[n].nextSibling)}else{if(!z.parentNode){this.headerContainer.insertBefore(z,this.headerContainer.children[1]);this.colgroupContainer.insertBefore(this.colgroup[A],this.colgroupContainer.children[1]);if(this.options.footers)for(p=0;p<this.options.footers.length;p++)this.tfoot.children[p].insertBefore(fa.create.call(this,A,p),this.tfoot.children[p].children[1]);v&&(z.style.top+=v);x=!0}for(p=
0;p<this.visibleRows.length;p++)y=this.visibleRows[p],y=Q[_$_d043[58]].call(this,A,y),y.parentNode||this.tbody.children[p].insertBefore(y,this.tbody.children[p].children[1])}if(this.options.mergeCells)for(p=0;p<this.visibleRows.length;p++)y=this.visibleRows[p],n=F.getColumnNameFromCoords(A,y),this.options.mergeCells[n]&&(this.records[y][A].merged||(w[n]=!1));n=Array.prototype.indexOf.call(this.headerContainer.children,z)}v=0;if(this.options.nestedHeaders)for(p=0;p<this.options.nestedHeaders.length;p++){n=
null;A=[];y=ya.getColumns.call(this,p);for(q=0;q<l.length;q++)void 0!==y[l[q]]&&-1==A.indexOf(y[l[q]])&&A.push(y[l[q]]);for(q=0;q<this.options.nestedHeaders[p].length;q++)-1==A.indexOf(q)&&this.nested.content[p][q]&&this.nested.content[p][q].element.offsetHeight&&this.nested.content[p][q].element.remove();for(q=y=0;q<A.length;q++)z=ya.create.call(this,A[q],p),z.parentNode||(n?this.thead.children[p].children[n]?this.thead.children[p].insertBefore(z,this.thead.children[p].children[n].nextSibling):this.thead.children[p].appendChild(z):
this.thead.children[p].insertBefore(z,this.thead.children[p].children[1]),z.style.top=v+_$_d043[59],this.options.freezeColumns&&this.options.nestedHeaders[p][A[q]].frozen&&(z.style.left=y+(Aa.call(this)?50:0)+_$_d043[59],z.classList.add(_$_d043[60]))),y+=z.offsetWidth,n=Array.prototype.indexOf.call(this.thead.children[p].children,z);v+=this.thead.children[p].offsetHeight}1==x?this.table.style.left=g.width.call(this,l[this.options.freezeColumns||0])+_$_d043[59]:this.width<parseInt(this.table.style.left)&&
(this.table.style.left=_$_d043[61]);sa.batch.call(this,w);this.visibleCols=l},a=function(l){var n=[],q=null,p,v=!1;for(p=0;p<this.tbody.children.length;p++)n.push(this.tbody.children[p]);for(p=0;p<n.length;p++){var w=parseInt(n[p].getAttribute(_$_d043[57]));-1===l.indexOf(w)&&(n[p].parentNode.removeChild(n[p]),v=!0)}for(p=0;p<l.length;p++)n=da.create.call(this,l[p]),n.parentNode||(q?this.tbody.insertBefore(n,q.nextSibling):this.tbody.insertBefore(n,this.tbody.firstChild),this.rows[l[p]].height=n.offsetHeight,
v=!0),q=n;v?(this.table.style.top=g.height.call(this,l[this.options.freezeRows||0])+_$_d043[59],this.visibleCols=null):this.height<parseInt(this.table.style.top)&&(this.table.style.top=_$_d043[61]);this.visibleRows=l},c=function(){var l=[],n=0,q=null;if(H.limited.call(this)){var p=q=0;p=this.content.scrollLeft;var v=p+this.content.offsetWidth;q=this.options.columns;var w=null,x=this.options.freezeColumns||0,y=0;x&&(p+=ca.getWidth.call(this,!0));for(n=0;n<q.length;n++)w=ia.isVisible.call(this,n)?parseInt(q[n].width):
0,(y+w>p&&y<=v||n<x)&&h.call(l,n),y+=w;for(n=0;n<l.length;n++)if(p=sa.getAffected.call(this.merged.cols,l[n]))for(q=0;q<p.length;q++)h.call(l,p[q]);for(n=0;n<l.length;n++)if(p=ya.getAffected.call(this,l[n]))for(q=0;q<p.length;q++)this.options.columns[p[q]]&&h.call(l,p[q]);l.sort(function(A,z){return A-z})}else for(q=this.options.columns,n=0;n<q.length;n++)l.push(n);d(l,this.visibleCols)||b.call(this,l)},e=function(){var l=[],n=null,q=0,p=0;q=null;var v=0;if(H.limited.call(this)&&!this.options.pagination){var w=
this.content.scrollTop,x=w+this.content.offsetHeight,y=0,A=this.options.freezeRows||0,z=0;n=this.results?this.results:this.rows;A&&(w+=ja.getHeight.call(this,!0));for(p=0;p<n.length;p++)q=this.results?n[p]:p,y=da.height.call(this,q),(z+y>w&&z<x||p<A)&&l.push(q),z+=y}else for(n=this.results?this.results:this.rows,this.options.pagination?(q=parseInt(this.options.pagination)*this.pageNumber,v=q+parseInt(this.options.pagination),v>n.length&&(v=n.length)):(q=0,v=n.length),p=q;p<v;p++)q=this.results?n[p]:
p,l.push(q);if(this.options.mergeCells){for(p=0;p<l.length;p++)if(this.merged.rows[l[p]]&&(v=sa.getAffected.call(this.merged.rows,l[p])))for(q=0;q<v.length;q++)-1===l.indexOf(v[q])&&l.push(v[q]);l.sort(function(I,r){return I-r})}d(l,this.visibleRows)||a.call(this,l)},g=function(l,n){n&&(this.visibleCols=this.visibleRows=null);g.calculate.call(this);g.update.call(this);if(!0!==l){var q=this;this.content.addEventListener(_$_d043[62],function(){g.ignore||g.update.call(q)});this.content.addEventListener(_$_d043[63],
function(p){if(H.limited.call(q)&&!q.options.pagination){var v=Math.abs(p.deltaX),w=Math.abs(p.deltaY);p.shiftKey||v>w?0>p.deltaX||0>p.deltaY?g.left.call(q):g.right.call(q):0>p.deltaY?g.up.call(q):g.down.call(q);p.preventDefault()}})}};g.calculate=function(){if(H.limited.call(this)){var l=ca.getWidth.call(this),n=ja.getHeight.call(this);this.width=g.width.call(this)+(l?l:1);this.height=g.height.call(this)+(n?n:1);this.scrollX.style.width=this.width+100+_$_d043[59];this.scrollY.style.height=this.height+
100+_$_d043[59]}};g.update=function(){e.call(this);c.call(this);Ca.update.call(this);ca.refresh.call(this);ja.refresh.call(this);ba.refresh.call(this)};g[_$_d043[64]]=function(l,n){null!==l&&(l=g.height.call(this,l),this.content.scrollTop=l);void 0!==n&&null!==n&&(n=g.width.call(this,n),this.content.scrollLeft=n)};g.up=function(l){if(l)this.content.scrollTop=0;else if(this.tbody.firstChild){l=this.tbody.lastChild.getAttribute(_$_d043[57]);l=parseInt(l);var n=l;for(this.results&&(l=this.results.indexOf(l));0<
l;){l--;var q=this.results?this.results[l]:l;if(!this.rows[q]||!1!==this.rows[q].visible){n=q;break}}q=da.height.call(this,n);l=this.tbody.firstChild.getAttribute(_$_d043[57]);da.attached.call(this,l)||(q+=this.content.scrollTop-this.table.offsetTop);this.content.scrollTop-=q}};g.down=function(l){if(l)this.content.scrollTop=this.content.scrollHeight;else if(this.tbody.firstChild){l=this.tbody.firstChild.getAttribute(_$_d043[57]);l=parseInt(l);var n=l;for(this.results&&(l=this.results.indexOf(l));l<
this.rows.length-1;){var q=this.results?this.results[l]:l;if(!this.rows[q]||!1!==this.rows[q].visible){n=q;break}l++}l=da.height.call(this,n);this.content.scrollTop+=l}};g.left=function(l){var n=this.options.freezeColumns||0;if(l)this.content.scrollLeft=0;else{for(n=l=this.thead.lastChild.children[1+n].getAttribute(_$_d043[56]);0<l;)if(l--,ia.isVisible.call(this,l)){n=l;break}l=n;n=parseInt(this.options.columns[l].width);this.headers[l]&&this.headers[l].parentNode||(n+=this.content.scrollLeft-this.table.offsetLeft);
this.content.scrollLeft-=n}};g.right=function(l){var n=this.options.freezeColumns||0;this.content.scrollLeft=l?this.content.scrollWidth:this.content.scrollLeft+this.thead.lastChild.children[1+n].offsetWidth};var f=function(){for(var l,n=this.content.offsetHeight-this.thead.offsetHeight-ja.getHeight.call(this),q=0,p=0;p<this.tbody.children.length;p++)l=this.tbody.children[p].offsetHeight,n>l&&(q+=l,n-=l);return q},k=function(){for(var l,n=this.content.offsetWidth-ca.getWidth.call(this),q=0,p=0;p<this.thead.lastChild.children.length;p++)l=
this.thead.lastChild.children[p].offsetWidth,n>l&&(q+=l,n-=l);return q};g.pageUp=function(){this.content.scrollTop-=f.call(this)};g.pageDown=function(){this.content.scrollTop+=f.call(this)};g.pageLeft=function(){this.content.scrollLeft-=k.call(this)};g.pageRight=function(){this.content.scrollLeft+=k.call(this)};g.build=function(l){var n=document.createElement(_$_d043[32]);n.className=_$_d043[65]+l;return n};g.width=function(l,n){for(var q=this.options.columns,p=0,v=this.options.freezeColumns||0;v<
this.options.columns.length;v++){if(l===v)return p;ia.isVisible.call(this,v)&&(p+=parseInt(q[v].width));if(p>=n)return v}return n?v:p};g.height=function(l,n){for(var q=0,p=0,v=this.results?this.results:this.rows,w=this.options.freezeRows||0;w<v.length;w++){p=w;this.results&&(p=v[w]);if(l===p)return q;this.rows[p]&&!1!==this.rows[p].visible&&(q+=da.height.call(this,p));if(q>=n)return p}return n?p:q};g.adjust=function(l,n,q){var p=this.records[n][l].element;if(p){if(!this.records[n][l].merged)if(0==
q||2==q){var v=0,w=Aa.call(this)?50:0;this.options.freezeColumns&&(v=ca.getWidth.call(this,!0));n=this.content.scrollLeft+v;v=this.content.scrollLeft+(this.content.offsetWidth-w);w=this.table.offsetLeft+p.offsetLeft-w;var x=p.offsetWidth;0==q?w+x<v&&l>this.options.freezeColumns-1&&w<n&&(p.offsetHeight?(q=this.content.scrollLeft+(w-n),g.setX.call(this,q)):g[_$_d043[64]].call(this,null,l)):l>this.options.freezeColumns-1&&(w>n?w+x>v&&(p.parentNode?(q=this.content.scrollLeft+(w+x-v+16),g.setX.call(this,
q)):g[_$_d043[64]].call(this,null,l)):g[_$_d043[64]].call(this,null,l))}else v=0,this.options.freezeRows&&(v=ja.getHeight.call(this,!0)),l=this.content.scrollTop+v,v=this.content.scrollTop+this.content.offsetHeight-this.thead.offsetHeight-16,w=this.table.offsetTop+p.offsetTop-this.thead.offsetHeight,x=p.offsetHeight,1==q?w+x<v&&n>this.options.freezeRows-1&&(w<l?p.parentNode?0<l-w&&(q=this.content.scrollTop+(w-l),g.setY.call(this,q)):g[_$_d043[64]].call(this,n):p.offsetHeight||g[_$_d043[64]].call(this,
n)):n>this.options.freezeRows-1&&(w>l?w+x>v&&(p.parentNode?(q=this.content.scrollTop+(w+x-v),g.setY.call(this,q)):g[_$_d043[64]].call(this,n)):p.offsetHeight||g[_$_d043[64]].call(this,n))}else 0==q||2==q?g[_$_d043[64]].call(this,null,l):g[_$_d043[64]].call(this,n)};g.setX=function(l){g.ignore=!0;this.content.scrollLeft=l;g.ignore=!1};g.setY=function(l){g.ignore=!0;this.content.scrollTop=l;g.ignore=!1};g.limited=function(){return 1==this.options.tableOverflow||1==this.parent.config.fullscreen};return g}(),
Pa=function(h,d,b,a){var c=d,e=null;if(this.results&&(d=this.results.indexOf(d),-1==d))return c;for(;0<d;){d--;var g=this.results?this.results[d]:d;if(!1!==this.rows[g].visible){var f=this.records[g][h].v===_$_d043[3]?!1:!0;null===e&&(e=f);if(this.records[g][h].element&&this.records[g][h].element.classList.contains(_$_d043[66])){if(this.records[g][h].merged){c=g-this.records[g][h].merged[1];if(!b)break;f=!0}}else{if(b&&f!==e&&!a)break;if(b)c=this.records[g][h].merged?g-this.records[g][h].merged[1]:
g;else return g}e=f}}return c},Qa=function(h,d,b,a){for(var c=h,e,g=null;0<h;)if(h--,ia.isVisible.call(this,h)){e=!1;this.records[d]&&(e=this.records[d][h].merged?this.records[d-this.records[d][h].merged[1]][h-this.records[d][h].merged[0]].v?!0:!1:this.records[d][h].v?!0:!1);null===g&&(g=e);if(this.records[d]&&this.records[d][h].element&&this.records[d][h].element.classList.contains(_$_d043[66])){if(this.records[d][h].merged&&(c=h-this.records[d][h].merged[0],!b))break}else{if(b&&e!==g&&!a)break;
if(b)c=h;else return h}g=e}return c},Ua=function(){var h=function(b,a,c,e){1==b||3==b?da.attached.call(this,c)||(0<this.options.pagination?this.page(this.whichPage(c)):1==b?H.up.call(this,e):H.down.call(this,e)):Q.attached.call(this,a,c)||(0==b?H.left.call(this,e):H.right.call(this,e))},d=function(b){b.up=d.up;b.down=d.down;b.right=d.right;b.left=d.left;b.last=d.last;b.first=d.first};d.up=function(b,a,c){if(Array.isArray(this.selectedCell)){if(b)var e=parseInt(this.selectedCell[2]),g=parseInt(this.selectedCell[3]);
else e=parseInt(this.selectedCell[0]),g=parseInt(this.selectedCell[1]);c=Pa.call(this,e,g,a,c);c!=g&&(g=c,b?(b=this.selectedCell[0],c=this.selectedCell[1]):(b=e,c=g,e=b,g=c),h.call(this,1,e,g,a),ka[_$_d043[11]].call(this,b,c,e,g),H.adjust.call(this,e,g,1))}};d.down=function(b,a,c){if(Array.isArray(this.selectedCell)){if(b)var e=parseInt(this.selectedCell[2]),g=parseInt(this.selectedCell[3]);else e=parseInt(this.selectedCell[0]),g=parseInt(this.selectedCell[1]);a:{var f=e,k=g,l=k,n=null;if(this.results){k=
this.results.indexOf(k);if(-1==k){c=l;break a}var q=this.results.length-1}else q=this.rows.length-1;for(;k<q;){k++;var p=this.results?this.results[k]:k;if(!1!==this.rows[p].visible){var v=this.records[p][f].v===_$_d043[3]?!1:!0;null===n&&(n=v);if(this.records[p][f].element&&this.records[p][f].element.classList.contains(_$_d043[66])){if(this.records[p][f].merged){if(!this.records[p][f].merged[1]&&(l=p,!a))break;v=!0}}else if(a&&v!==n&&!c){c=l;break a}else if(a)l=p;else{c=p;break a}n=v}}c=l}c!=g&&(g=
c,b?(b=this.selectedCell[0],c=this.selectedCell[1]):(b=e,c=g,e=b,g=c),h.call(this,3,e,g,a),ka[_$_d043[11]].call(this,b,c,e,g),H.adjust.call(this,e,g,3))}};d.right=function(b,a,c){if(Array.isArray(this.selectedCell)){if(b)var e=parseInt(this.selectedCell[2]),g=parseInt(this.selectedCell[3]);else e=parseInt(this.selectedCell[0]),g=parseInt(this.selectedCell[1]);a:{for(var f=e,k=g,l=this.options.columns,n=f,q,p=null;f<l.length-1;)if(f++,ia.isVisible.call(this,f)){q=!1;this.records[k]&&(q=this.records[k][f].merged?
this.records[k-this.records[k][f].merged[1]][f-this.records[k][f].merged[0]].v?!0:!1:this.records[k][f].v?!0:!1);null===p&&(p=q);if(this.records[k]&&this.records[k][f].element&&this.records[k][f].element.classList.contains(_$_d043[66])){if(this.records[k][f].merged&&f==f+this.records[k][f].merged[0]&&(n=f,!a))break}else if(a&&q!==p&&!c){c=n;break a}else if(a)n=f;else{c=f;break a}p=q}c=n}c!=e&&(e=c,b?(b=this.selectedCell[0],c=this.selectedCell[1]):(b=e,c=g,e=b,g=c),h.call(this,2,e,g,a),ka[_$_d043[11]].call(this,
b,c,e,g),H.adjust.call(this,e,g,2))}};d.left=function(b,a,c){if(Array.isArray(this.selectedCell)){if(b)var e=parseInt(this.selectedCell[2]),g=parseInt(this.selectedCell[3]);else e=parseInt(this.selectedCell[0]),g=parseInt(this.selectedCell[1]);c=Qa.call(this,e,g,a,c);c!=e&&(e=c,b?(b=this.selectedCell[0],c=this.selectedCell[1]):(b=e,c=g,e=b,g=c),h.call(this,0,e,g,a),ka[_$_d043[11]].call(this,b,c,e,g),H.adjust.call(this,e,g,0))}};d.first=function(b,a){Array.isArray(this.selectedCell)&&(a?d.up.call(this,
b,!0,!0):d.left.call(this,b,!0,!0))};d.last=function(b,a){Array.isArray(this.selectedCell)&&(a?d.down.call(this,b,!0,!0):d.right.call(this,b,!0,!0))};return d}(),Va=function(){return function(h){h.save=Ra;h.fullscreen=Na;h.setReadOnly=Ja;h.getReadOnly=Ja;h.isReadOnly=Ja;h.rotate=Ta;h.setPlugins=function(d){ua.call(this.parent,d)};h.showIndex=function(){Aa.call(this,!0)};h.hideIndex=function(){Aa.call(this,!1)};h[_$_d043[64]]=H[_$_d043[64]];h.undo=function(){R.undo.call(h.parent)};h.redo=function(){R.redo.call(h.parent)};
h.isEditable=function(){return P.call(h.parent,h)};h.dispatch=function(){return G.apply(this.parent,arguments)};h.persistence=L;h.setViewport=function(d,b){this.options.tableOverflow=!0;d=parseInt(d);b=parseInt(b);this.content.classList.add(_$_d043[67]);150<d&&(this.options.tableWidth=d+_$_d043[59],this.content.style.width=this.options.tableWidth);150<b&&!this.options.pagination&&(this.options.tableHeight=parseInt(b)+_$_d043[59],this.content.style.height=this.options.tableHeight);H.call(this,!0);
ma.update.call(this.parent,this);G.call(this.parent,_$_d043[68],d,b)};h.helpers=F}}(),Fa=function(){var h={logo:null,url:null,persistence:!1,sequence:!0,data:null,json:null,rows:[],columns:[],cells:{},role:null,nestedHeaders:null,defaultColWidth:100,defaultRowHeight:0,defaultColAlign:null,minSpareRows:0,minSpareCols:0,minDimensions:[0,0],csv:null,csvFileName:_$_d043[48],csvHeaders:!0,csvDelimiter:_$_d043[37],columnSorting:!0,columnDrag:!0,columnResize:!0,rowResize:!0,rowDrag:!0,editable:!0,allowInsertRow:!0,
allowManualInsertRow:!0,allowInsertColumn:!0,allowManualInsertColumn:!0,allowDeleteRow:!0,allowDeletingAllRows:!1,allowDeleteColumn:!0,allowRenameColumn:!0,allowComments:!0,selectionCopy:!0,mergeCells:{},search:!1,pagination:!1,paginationOptions:null,textOverflow:!1,tableOverflow:!1,tableHeight:_$_d043[69],tableWidth:null,resize:null,comments:null,meta:null,style:{},freezeColumns:0,freezeRows:0,freezeColumnControl:!1,freezeRowControl:!1,orderBy:null,worksheetId:_$_d043[3],worksheetName:null,worksheetState:null,
filters:!1,footers:null,formify:null,applyMaskOnFooters:!1,pluginOptions:null,locked:!1,selectUnLockedCells:!0,selectLockedCells:!0,wrap:!1,gridline:!0},d={application:_$_d043[70],cloud:null,root:null,definedNames:{},sorting:null,server:null,toolbar:null,editable:!0,allowExport:!0,includeHeadersOnDownload:!1,forceUpdateOnPaste:!1,loadingSpin:!1,fullscreen:!1,secureFormulas:!0,parseFormulas:!0,debugFormulas:!1,editorFormulas:!0,autoIncrement:!0,autoCasting:!0,stripHTML:!1,tabs:!1,allowDeleteWorksheet:!0,
allowRenameWorksheet:!0,allowMoveWorksheet:!0,moveDownOnEnter:!0,onevent:null,onclick:null,onload:null,onundo:null,onredo:null,onbeforesave:null,onsave:null,onbeforechange:null,onchange:null,onafterchanges:null,oncopy:null,onbeforepaste:null,onpaste:null,onbeforeinsertrow:null,oninsertrow:null,onbeforedeleterow:null,ondeleterow:null,onbeforeinsertcolumn:null,oninsertcolumn:null,onbeforedeletecolumn:null,ondeletecolumn:null,onmoverow:null,onmovecolumn:null,onresize:null,onresizerow:null,onresizecolumn:null,
onselection:null,onbeforecomments:null,oncomments:null,onbeforesort:null,onsort:null,onfocus:null,onblur:null,onmerge:null,onchangeheader:null,onchangefooter:null,onchangefootervalue:null,onchangenested:null,onchangenestedcell:null,oncreateeditor:null,oneditionstart:null,oneditionend:null,onchangestyle:null,onchangemeta:null,onbeforechangepage:null,onchangepage:null,onbeforecreateworksheet:null,oncreateworksheet:null,onrenameworksheet:null,ondeleteworksheet:null,onmoveworksheet:null,onopenworksheet:null,
onchangerowid:null,onbeforesearch:null,onsearch:null,onbeforefilter:null,onfilter:null,onopenfilter:null,oncreatecell:null,oncreaterow:null,oncreatecolumn:null,onbeforeformula:null,onformulachain:null,onchangereferences:null,onbeforechangereferences:null,onbeforesend:null,onchangedefinednames:null,oninput:null,updateTable:null,contextMenu:null,parseTableFirstRowAsHeader:!1,parseTableAutoCellType:!1,plugins:null,about:!0,license:null,worksheets:null,validations:null},b=function(e,g){g=JSON.parse(JSON.stringify(g));
var f={},k;for(k in g)e&&e.hasOwnProperty(k)?f[k]=e[k]:f[k]=g[k];return f},a=function(e){e&&(typeof e==_$_d043[25]&&(e=JSON.parse(e)),this.options.data=e);this.options.json&&(this.options.data=this.options.json);this.options.data||(this.options.data=[]);e=this.options.columns.length;if(this.options.data&&typeof this.options.data[0]!==_$_d043[21]){var g=this.options.data[0].data&&0<Object.keys(this.options.data[0].data).length?Object.keys(this.options.data[0].data):Object.keys(this.options.data[0]);
g.length>e&&(e=g.length)}this.options.minDimensions[0]>e&&(e=this.options.minDimensions[0]);e||(e=8);for(var f=0;f<e;f++)this.options.columns[f]?this.options.columns[f].type||(this.options.columns[f].type=_$_d043[71]):this.options.columns[f]={type:_$_d043[71]},this.options.columns[f].type==_$_d043[72]&&(this.options.columns[f].type=_$_d043[73],this.options.columns[f].autocomplete=!0),!this.options.columns[f].name&&g&&g[f]&&Number(g[f])!=g[f]&&(this.options.columns[f].name=g[f]),this.options.columns[f].width||
(this.options.columns[f].width=parseInt(this.options.defaultColWidth)+_$_d043[59]),this.options.columns[f].type!=_$_d043[73]||this.options.columns[f].source||(this.options.columns[f].source=[]),this.options.columns[f].type==_$_d043[73]&&this.options.columns[f].url&&jSuites.ajax({url:this.options.columns[f].url,index:f,method:_$_d043[74],dataType:_$_d043[75],worksheet:this,group:this.parent.name,success:function(k){this.worksheet.options.columns[this.index].source=k}})},c=function(e){e.getConfig=c[_$_d043[58]];
e.setConfig=c[_$_d043[11]]};c.spreadsheet=function(e){this.config=b(e,d);1!=this.config.secureFormulas&&console.log(_$_d043[76])};c.worksheet=function(e){var g=this;g.options=b(e,h);g.options.csv?jSuites.ajax({url:g.options.csv,method:_$_d043[74],dataType:_$_d043[71],group:g.parent.name,success:function(f){f=F.parseCSV(f,g.options.csvDelimiter);if(1==g.options.csvHeaders&&0<f.length)for(var k=f.shift(),l=0;l<k.length;l++)g.options.columns[l]||(g.options.columns[l]={type:_$_d043[71],width:g.options.defaultColWidth}),
typeof g.options.columns[l].title===_$_d043[21]&&(g.options.columns[l].title=k[l]);a.call(g,f)}}):g.options.url?jSuites.ajax({url:g.options.url,method:_$_d043[74],dataType:_$_d043[75],group:g.parent.name,success:function(f){a.call(g,f)}}):a.call(g)};c[_$_d043[58]]=function(){return this.options};c[_$_d043[11]]=function(e){typeof e==_$_d043[25]&&(e=JSON.parse(e));if(this.parent){g=Object.keys(e);for(f=0;f<g.length;f++)typeof h[g[f]]!==_$_d043[21]&&(this.options[g[f]]=e[g[f]]);this.content.style.resize=
e.resize?e.resize:_$_d043[3];!0===e.filters?la.show.call(this):!1===e.filters&&la.hide.call(this);!0===e.search?va.show.call(this):!1===e.search&&va.hide.call(this);!0===e.toolbar?ma.show.call(this.parent):!1===e.toolbar&&ma.hide.call(this.parent);e.minDimensions&&e.minDimensions[0]&&(g=parseInt(e.minDimensions[0])-this.headers.length,0<g&&this.insertColumn(g),g=parseInt(e.minDimensions[1])-this.rows.length,0<g&&this.insertRow(g));L.call(this,_$_d043[77],{data:JSON.stringify(e)})}else for(var g=Object.keys(e),
f=0;f<g.length;f++)typeof d[g[f]]!==_$_d043[21]&&(this.config[g[f]]=e[g[f]])};return c}(),R=function(h){h=function(a){if(1!=this.ignoreHistory)if(this.historyCascade)this.history[this.historyIndex].cascade||(this.history[this.historyIndex].cascade=[]),this.history[this.historyIndex].cascade.push(a);else{var c=++this.historyIndex;this.history=this.history.slice(0,c+1);this.history[c]=a}};var d=function(a){var c=a.worksheet;if(a.action==_$_d043[78])c.deleteRow(a.insertBefore?a.rowNumber:a.rowNumber+
1,a.numOfRows);else if(a.action==_$_d043[79])c.insertRow(a.numOfRows,a.rowNumber,1,a.data),Q.setAttributes.call(c,a.attributes);else if(a.action==_$_d043[80])c.deleteColumn(a.insertBefore?a.columnNumber:a.columnNumber+1,a.numOfColumns);else if(a.action==_$_d043[81])c.insertColumn(a.numOfColumns,a.columnNumber,1,a.properties,a.data,a.extra),Q.setAttributes.call(c,a.attributes);else if(a.action==_$_d043[82])c.moveRow(a.newValue,a.oldValue);else if(a.action==_$_d043[83])c.moveColumn(a.newValue,a.oldValue);
else if(a.action==_$_d043[84])c.removeMerge(a.newValue,!0),c.setMerge(a.oldValue);else if(a.action==_$_d043[85])c.setMerge(a.oldValue);else if(a.action==_$_d043[86])c.setStyle(a.oldValue,null,null,1);else if(a.action==_$_d043[87])c.setStyle(a.oldValue);else if(a.action==_$_d043[88])c.setWidth(a.column,a.oldValue);else if(a.action==_$_d043[89])c.setHeight(a.row,a.oldValue);else if(a.action==_$_d043[90])c.setHeader(a.column,a.oldValue);else if(a.action==_$_d043[91]||a.action==_$_d043[92]||a.action==
_$_d043[93])c[a.action](a.oldValue);else if(a.action==_$_d043[94])c.orderBy(a.column,a.direction?0:1,a.oldValue,a.previousState);else if(a.action==_$_d043[95]||a.action==_$_d043[96]||a.action==_$_d043[97]){var e=[];for(var g=0;g<a.records.length;g++){var f={x:a.records[g].x,value:a.records[g].oldValue};void 0!==a.records[g].y&&(f.y=a.records[g].y);a.records[g].oldStyle&&(f.style=a.records[g].oldStyle);e.push(f)}a.action==_$_d043[95]?c.setValue(e):c.setProperty(e)}else if(a.action==_$_d043[98])c.renameWorksheet(a.index,
a.oldValue);else if(a.action==_$_d043[99])c.moveWorksheet(a.t,a.f);else if(a.action==_$_d043[100]){e=[];for(g=0;g<a.records.length;g++)e.push({index:a.records[g].index,value:a.records[g].oldValue});c.setDefinedNames(e)}G.call(this,_$_d043[101],c,a)};h.undo=function(){if(0<=this.historyIndex)var a=this.history[this.historyIndex--];if(a){this.ignoreHistory=!0;var c=a.worksheet;c.openWorksheet();d.call(this,a);if(a.cascade&&a.cascade.length)for(var e=0;e<a.cascade.length;e++)d.call(this,a.cascade[e]);
a.selection&&c.updateSelectionFromCoords(a.selection);this.ignoreHistory=!1}};var b=function(a){var c=a.worksheet;if(a.action==_$_d043[78])c.insertRow(a.numOfRows,a.rowNumber,a.insertBefore,a.data);else if(a.action==_$_d043[79])c.deleteRow(a.rowNumber,a.numOfRows);else if(a.action==_$_d043[80])c.insertColumn(a.numOfColumns,a.columnNumber,a.insertBefore,a.properties,a.data);else if(a.action==_$_d043[81])c.deleteColumn(a.columnNumber,a.numOfColumns);else if(a.action==_$_d043[82])c.moveRow(a.oldValue,
a.newValue);else if(a.action==_$_d043[83])c.moveColumn(a.oldValue,a.newValue);else if(a.action==_$_d043[84])c.setMerge(a.newValue);else if(a.action==_$_d043[85])c.removeMerge(a.newValue);else if(a.action==_$_d043[86])c.setStyle(a.newValue,null,null,1);else if(a.action==_$_d043[87])c.resetStyle(a.cells);else if(a.action==_$_d043[88])c.setWidth(a.column,a.newValue);else if(a.action==_$_d043[89])c.setHeight(a.row,a.newValue);else if(a.action==_$_d043[90])c.setHeader(a.column,a.newValue);else if(a.action==
_$_d043[91]||a.action==_$_d043[92]||a.action==_$_d043[93])c[a.action](a.newValue);else if(a.action==_$_d043[94])c.orderBy(a.column,a.direction,a.newValue);else if(a.action==_$_d043[95]||a.action==_$_d043[96]||a.action==_$_d043[97])c[a.action](a.records);else a.action==_$_d043[98]?c.renameWorksheet(a.index,a.newValue):a.action==_$_d043[99]?c.moveWorksheet(a.f,a.t):a.action==_$_d043[100]&&c.setDefinedNames(a.records);G.call(this,_$_d043[102],c,a)};h.redo=function(){if(this.historyIndex<this.history.length-
1)var a=this.history[++this.historyIndex];if(a){this.ignoreHistory=!0;var c=a.worksheet;c.openWorksheet();b.call(this,a);if(a.cascade&&a.cascade.length)for(var e=0;e<a.cascade.length;e++)b.call(this,a.cascade[e]);a.selection&&c.updateSelectionFromCoords(a.selection);this.ignoreHistory=!1}};h.reset=function(){this.historyIndex=-1;this.history=[]};return h}(),ua=function(){var h=function(d){var b=null;if(Array.isArray(d))b=d;else if(typeof d==_$_d043[103]){b=[];var a=Object.keys(d);for(var c=0;c<a.length;c++)b.push({name:a[c],
plugin:d[a[c]],options:{}})}if(b&&b.length)for(c=0;c<b.length;c++){if(b[c].name&&b[c].plugin){var e=b[c].name;var g=b[c].plugin;var f=b[c].options}typeof g===_$_d043[104]&&(this.plugins[e]=g.call(u,this,f,this.config),typeof g.license==_$_d043[104]&&u.license&&g.license(u.license))}};h.execute=function(d,b){if(this.plugins){var a=Object.keys(this.plugins);if(a.length)for(var c=0;c<a.length;c++)if(typeof this.plugins[a[c]][d]==_$_d043[104]){var e=this.plugins[a[c]][d].apply(this.plugins[a[c]],b);e&&
(d==_$_d043[105]&&(b[4]=e),d==_$_d043[106]&&(b[0]=e))}return b}};h.onevent=function(d){return function(){var b,a,c=this.plugins;if(c){var e=Object.keys(c);if(e.length)for(a=0;a<e.length;a++)if(typeof c[e[a]][d]==_$_d043[104]){var g=c[e[a]][d].apply(c[e[a]],arguments);typeof g!==_$_d043[21]&&(b=g)}}return b}}(_$_d043[107]);return h}(),na=function(){var h=function(d){d.getEditor=h[_$_d043[58]];d.openEditor=h.open;d.closeEditor=h.close};h[_$_d043[58]]=function(d,b){d=Ka[_$_d043[58]].call(this,d,b);return[d.type&&
typeof d.type==_$_d043[103]?d.type:u.editors[d.type],d]};h.open=function(d,b,a){if(!P.call(this.parent,this))return!1;if(1!=d.classList.contains(_$_d043[26])){var c=parseInt(d.getAttribute(_$_d043[56])),e=parseInt(d.getAttribute(_$_d043[57]));if(!0===this.options.locked){var g=F.getColumnNameFromCoords(c,e);if(!this.options.cells||!this.options.cells[g]||!1!==this.options.cells[g].locked)return!1}if(g=this.records[e][c].merged)c-=g[0],e-=g[1],d=this.records[e][c].element;if(!Q.attached.call(this,
c,e)){if(this.results&&0<this.results.length)return console.error(_$_d043[108]),!1;var f=g=null;ia.attached.call(this,c)||(g=c);da.attached.call(this,e)||(f=e);H[_$_d043[64]].call(this,f,g)}h.position.call(this,c,e);g=this.parent.input;if(113===a.keyCode||a.type!==_$_d043[109])g.selected=!0;g.innerText=_$_d043[3];G.call(this.parent,_$_d043[110],this,d,c,e);b=1==b?_$_d043[3]:O.call(this,c,e);f=h[_$_d043[58]].call(this,c,e);var k=!0;typeof f[0].openEditor==_$_d043[104]&&(!1===f[0].openEditor(d,b,c,
e,this,f[1],a)?k=!1:G.call(this.parent,_$_d043[111],this,d,c,e,g,f[1]));k&&(1==this.options.textOverflow&&(this.records[e][c].element.style.overflow=_$_d043[112],0<c&&this.records[e][c-1].element&&(this.records[e][c-1].element.style.overflow=_$_d043[112])),this.edition=d,g.classList.add(_$_d043[113]),1==this.parent.config.editorFormulas&&aa(b)&&(g.classList.add(_$_d043[114]),ra.parse.call(this,g),d=document.createTextNode(_$_d043[3]),g.appendChild(d),jSuites.focus(g)))}};h.close=function(d,b){null===
d&&(d=this.edition);this.parent.input.classList.contains(_$_d043[114])&&ra.close.call(this,this.parent.input);var a,c=parseInt(d.getAttribute(_$_d043[56])),e=parseInt(d.getAttribute(_$_d043[57]));1==this.options.textOverflow&&(a=this.records[e][c+1])&&a.element&&a.element.innerText==_$_d043[3]&&(this.records[e][c].element.style.overflow=_$_d043[3]);a=h[_$_d043[58]].call(this,c,e);if(1==b){var g=null;typeof a[0].closeEditor==_$_d043[104]&&(a=a[0].closeEditor(d,!0,c,e,this,a[1]),void 0!==a&&(g=a));
null!==g&&O.call(this,c,e)!=g&&this.setValue(d,g)}else a[0].closeEditor(d,!1,c,e,this,a[1]);G.call(this.parent,_$_d043[115],this,d,c,e,g,b);a=this.parent.input;a.selected=!1;a.onblur&&(a.onblur=null);a.children[0]&&a.children[0].onblur&&(a.children[0].onblur=null);a.update&&(a.update=null);na.build(this.parent);a.removeAttribute(_$_d043[116]);a.removeAttribute(_$_d043[117]);a.removeAttribute(_$_d043[118]);this.edition=a.mask=null;this.refreshBorders()};h.position=function(d,b){var a=null;if(a=this.records[b][d].element){var c=
this.parent.element.getBoundingClientRect();a=a.getBoundingClientRect();var e=this.parent.input;e.x=d;e.y=b;0==a.width&&0==a.height?e.style.opacity=_$_d043[119]:(e.setAttribute(_$_d043[120],_$_d043[3]),d=a.top-c.top+1,b=a.left-c.left+1,e.style.top=d+_$_d043[59],e.style.left=b+_$_d043[59],e.style.minWidth=a.width-1+_$_d043[59],e.style.minHeight=a.height-1+_$_d043[59],setTimeout(function(){e.focus()},0))}};h.build=function(d){d.input||(d.input=document.createElement(_$_d043[32]));d.input.className=
_$_d043[121];d.input.setAttribute(_$_d043[122],!0);d.input.innerText=_$_d043[3];d.input.oninput=function(b){u.current&&(1==u.current.parent.config.editorFormulas&&(aa(b.target.innerText)?(b.target.classList.add(_$_d043[114]),b.target.selected=!0):b.target.classList.contains(_$_d043[114])&&ra.close.call(u.current,this)),G.call(u.current.parent,_$_d043[123],u.current,b))};d.input.onclick=function(){this.selected=!0};return d.input};return h}(),G=function(h){var d;if(!this.ignoreEvents){if(typeof this.config.onevent==
_$_d043[104]){var b=this.config.onevent.apply(this,arguments);typeof b!==_$_d043[21]&&(d=b)}typeof this.config[h]==_$_d043[104]&&(b=this.config[h].apply(this,Array.prototype.slice.call(arguments,1)),typeof b!==_$_d043[21]&&(d=b));b=ua.onevent.apply(this,arguments);typeof b!==_$_d043[21]&&(d=b)}return d},xa=function(){var h=function(d){d.sequence=0;d.getNextSequence=h.next;d.getRowId=h.getId;d.setRowId=h.setId;d.getRowById=h.getRowById};h[_$_d043[58]]=function(){return this.sequence};h[_$_d043[11]]=
function(d,b){if(d>this.sequence||b)this.sequence=d};h.next=function(){return 1==this.options.sequence?++this.sequence:null};h.reset=function(){this.sequence=0};h.getId=function(d){if(this.rows[d]&&this.rows[d].id)return this.rows[d].id;var b=this.getPrimaryKey();if(!1!==b)return O.call(this,b,d)};h.setId=function(d,b){if(void 0!==b&&0<=parseInt(d)){var a={};a[d]=b}else a=d;d=Object.keys(a);if(d.length){for(var c=0;c<d.length;c++)b=a[d[c]],this.rows[d[c]].id=b,h[_$_d043[11]].call(this,b);L.call(this,
_$_d043[124],[a]);G.call(this.parent,_$_d043[125],this,a)}};h.getRowById=function(d,b){for(var a=0;a<this.rows.length;a++)if(h.getId.call(this,a)==d)return!0===b?this.rows[a]:this.options.data[a];return!1};return h}(),Ra=function(){var h=function(b){for(var a=[],c={},e=0;e<b.length;e++){var g=b[e].x,f=b[e].y,k=xa.getId.call(this,f);if(!k)if(c[f])k=c[f];else if(k=xa.next.call(this))c[f]=k;a[f]||(a[f]={id:k,row:f,data:{}});g=qa.call(this,g);a[f].data[g]=b[e].value}xa.setId.call(this,c);return a.filter(function(l){return null!=
l})},d=function(b){var a=b[0];if(0<=[_$_d043[126],_$_d043[127],_$_d043[124],_$_d043[128]].indexOf(a))return!1;var c={};a==_$_d043[95]||a==_$_d043[129]?(a=_$_d043[130],c[a]=h.call(this,b[1].data)):Array.isArray(b[1])&&1==b[1].length?c[a]=b[1][0]:c[a]=b[1];return c};return function(b,a,c,e){var g=this.parent,f=this,k=d.call(this,a);if(k)a=k;else if(!1===k)return!1;if(k=G.call(g,_$_d043[131],g,f,a))a=k;else if(!1===k)return!1;Oa.call(g,!0);jSuites.ajax({url:b,method:_$_d043[132],dataType:_$_d043[75],
data:{data:JSON.stringify(a)},queue:!0,beforeSend:function(l){c&&l.setRequestHeader(_$_d043[133],_$_d043[134]+c);G.call(g,_$_d043[135],f,l)},success:function(l){g.element.classList.contains(_$_d043[136])&&g.element.classList.remove(_$_d043[136]);l&&(l.message&&(l.name=g.config.application,jSuites.notification.isVisible()?console.log(l.name+_$_d043[137]+l.message):jSuites.notification(l)),l.success?typeof e===_$_d043[104]?e(l):l.data&&Array.isArray(l.data)&&Q.updateAll.call(f,l.data):l.error&&(alert(_$_d043[138]),
window.open(window.location.href,_$_d043[139])));G.call(g,_$_d043[140],g,f,a,l)},error:function(){g.element.classList.add(_$_d043[136])}})}}(),L=function(){return function(){ua.execute.call(this.parent,_$_d043[141],[this,arguments[0],arguments[1]]);if(!this.parent.ignorePersistence){var h=null;if(this.parent.config.server){var d=this.parent.worksheets.indexOf(this);h=this.parent.config.server;h=-1==h.indexOf(_$_d043[142])?h+(_$_d043[143]+d):h+(_$_d043[144]+d)}else this.options.persistence&&(h=typeof this.options.persistence==
_$_d043[25]?this.options.persistence:this.options.url);h&&Ra.call(this,h,arguments)}}}(),Ga=function(h){if(this.selectedCell){var d=this.selectedCell[0],b=this.selectedCell[1];this.records&&this.records[b]&&this.records[b][d]&&this.records[b][d].element||(this.selectedCell=this.getHighlighted(),d=this.selectedCell[0],b=this.selectedCell[1]);var a=this.getHighlighted(),c=a[0],e=a[1],g=a[2];a=a[3];var f=h?_$_d043[145]:_$_d043[146];this.records[b]&&this.records[b][d]&&this.records[b][d].element&&(this.records[b][d].element.classList[f](_$_d043[147]),
this.cursor=h?this.records[b][d].element:null);for(h=c;h<=g;h++)if(this.headers[h])this.headers[h].classList[f](_$_d043[148]);for(;e<=a;e++)if(this.rows[e]&&this.rows[e].element)this.rows[e].element.classList[f](_$_d043[148])}},ka=function(){var h=function(d){d.resetSelection=h.reset;d.updateSelection=h.fromElements;d.updateSelectionFromCoords=h[_$_d043[11]];d.selectAll=h.all;d.isSelected=h.isSelected;d.getHighlighted=h.getHighlighted;d.getRange=h.getRange};h.getHighlighted=function(){var d=this.borders;
return(d=d.main)?[d.x1,d.y1,d.x2,d.y2]:null};h.isSelected=function(d,b,a){if(!a&&(a=this.getHighlighted(),!a||null===a[0]))return!1;var c=a[0],e=a[1],g=a[2];a=a[3];g||(g=c);a||(a=e);return null==d?b>=e&&b<=a:null==b?d>=c&&d<=g:d>=c&&d<=g&&b>=e&&b<=a};h.reset=function(){if(this.selectedCell)d=1,this.edition&&na.close.call(this,this.edition,!0),this.resetBorders(_$_d043[149],!0),this.resetBorders(_$_d043[150],!0),this.selectedCell=null,1==d&&G.call(this.parent,_$_d043[151],this);else var d=0;return d};
h.refresh=function(){this.selectedCell&&h[_$_d043[11]].call(this,this.selectedCell)};h.isValid=function(d,b,a,c){if(!this)return!1;Array.isArray(d)&&(c=d[3],a=d[2],b=d[1],d=d[0]);return!(d>=this.options.columns.length||b>=this.rows.length||a>=this.options.columns.length||c>=this.rows.length)};h[_$_d043[11]]=function(d,b,a,c,e,g,f){g||(g=_$_d043[149]);Array.isArray(d)&&(c=d[3],a=d[2],b=d[1],d=d[0]);null==a&&(a=d);null==c&&(c=b);if(!h.isValid.call(this,d,b,a,c))return!1;if(null!=d){if(parseInt(d)<parseInt(a))var k=
parseInt(d),l=parseInt(a);else k=parseInt(a),l=parseInt(d);if(parseInt(b)<parseInt(c))var n=parseInt(b),q=parseInt(c);else n=parseInt(c),q=parseInt(b);var p;var v={};if(this.options.mergeCells){for(var w=n;w<=q;w++)for(var x=k;x<=l;x++)if(p=this.records[w][x].merged)p=F.getColumnNameFromCoords(x-p[0],w-p[1]),v[p]=!0;w=Object.keys(v);if(w.length)for(x=0;x<w.length;x++)p=F.getCoordsFromColumnName(w[x]),v=this.options.mergeCells[w[x]],p[0]<k&&(k=p[0]),p[0]+v[0]-1>l&&(l=p[0]+v[0]-1),p[1]<n&&(n=p[1]),
p[1]+v[1]-1>q&&(q=p[1]+v[1]-1)}}g==_$_d043[149]&&(this.selectedCell?(Ga.call(this,!1),p=1):p=0,this.selectedCell=[d,b,a,c],this.records[c][a].element&&e&&(x=e.target.getAttribute(_$_d043[56]),v=e.target.getAttribute(_$_d043[57]),null!==x&&null!==v&&(H.adjust.call(this,a,c,3),H.adjust.call(this,a,c,2),H.adjust.call(this,a,c,1),H.adjust.call(this,a,c,0))),na.position.call(this,d,b),0==p&&G.call(this.parent,_$_d043[152],this));ba[_$_d043[11]].call(this,k,n,l,q,g,f);g==_$_d043[149]&&(G.call(this.parent,
_$_d043[153],this,k,n,l,q,e),ma.update.call(this.parent,this,this.selectedCell))};h.fromElements=function(d,b,a){var c=d.getAttribute(_$_d043[56]);d=d.getAttribute(_$_d043[57]);if(b){var e=b.getAttribute(_$_d043[56]);b=b.getAttribute(_$_d043[57])}else e=c,b=d;h[_$_d043[11]].call(this,c,d,e,b,a)};h.all=function(){h[_$_d043[11]].call(this,0,0,this.options.columns.length-1,this.records.length-1)};h.getRange=function(){var d=this.selectedCell;if(!d)return _$_d043[3];var b=F.getColumnNameFromCoords(d[0],
d[1]);d=F.getColumnNameFromCoords(d[2],d[3]);var a=this.options.worksheetName;a=-1!=a.indexOf(_$_d043[154])?_$_d043[155]+a+_$_d043[156]:a+_$_d043[19];return b==d?a+b:a+F.getRangeFromTokens(u.helpers.getTokensFromRange(b+_$_d043[157]+d))};return h}(),ba=function(){var h=function(a){a.borders=[];a.setBorder=h[_$_d043[11]];a.getBorder=h[_$_d043[58]];a.resetBorders=h.reset;a.refreshBorders=h.refresh};h[_$_d043[58]]=function(a){return this.borders[a]};var d=function(a,c,e,g,f,k){if(!ka.isValid.call(this,
a,c,e,g))return!1;var l=!1,n=null,q=null,p=null,v=null,w=null,x=this.options.freezeColumns||0;f||(f=0);this.borders[f]?n=this.borders[f]:(n={},n.element=document.createElement(_$_d043[32]),n.element.classList.add(_$_d043[158]),f==_$_d043[150]||f==_$_d043[159]||f==_$_d043[149]?n.element.classList.add(_$_d043[160]+f):(k=k?k:jSuites.randomColor(!0),n.color=k,n.element.style.backgroundColor=k+_$_d043[161],n.element.style.borderColor=k),f==_$_d043[149]&&(k=function(I,r){n[I]=document.createElement(_$_d043[32]);
n[I].classList.add(_$_d043[162]);n[I].setAttribute(_$_d043[163],r);n.element.appendChild(n[I]);!1===_$_d043[164]in document.documentElement&&(n[I].style.display=_$_d043[52])},k(_$_d043[165],0),n.moveLeft.style.left=_$_d043[61],n.moveLeft.style.marginTop=_$_d043[166],n.moveLeft.style.marginLeft=_$_d043[166],k(_$_d043[167],1),n.moveTop.style.left=_$_d043[61],n.moveTop.style.marginTop=_$_d043[166],n.moveTop.style.marginLeft=_$_d043[166],k(_$_d043[168],2),n.moveRight.style.right=_$_d043[61],n.moveRight.style.marginTop=
_$_d043[166],n.moveRight.style.marginRight=_$_d043[166],k(_$_d043[169],3),n.moveDown.style.bottom=_$_d043[61],n.moveDown.style.marginLeft=_$_d043[166],n.moveDown.style.marginBottom=_$_d043[166]),this.content.appendChild(n.element));n.x1=a;n.y1=c;n.x2=e;n.y2=g;n.element.style.top=_$_d043[170];n.element.style.left=_$_d043[170];n.active=0;k=[];for(x=a;x<=e;x++)k.push(x);x=this.options.freezeColumns||0;k=this.options.freezeRows||0;var y=this.visibleRows[k],A=this.visibleRows[this.visibleRows.length-1],
z=this.visibleCols[x];a>this.visibleCols[this.visibleCols.length-1]||c>A||e<z&&a>=x||g<y&&c>=k?l=!0:(q=this.headers[a]&&this.headers[a].parentNode?this.headers[a].offsetLeft:0,this.headers[e]&&this.headers[e].parentNode?(ia.isVisible.call(this,e)||(e=Qa.call(this,e,null)),p=this.headers[e].offsetLeft):(p=this.thead.lastChild.lastChild.getAttribute(_$_d043[56]),p=x&&e<p?this.thead.lastChild.children[x].offsetLeft:this.thead.lastChild.lastChild.offsetLeft),p=p-q+parseInt(this.options.columns[e].width)-
1,q+=this.table.offsetLeft,v=this.rows[c].element&&this.rows[c].element.parentNode?this.rows[c].element.firstChild.offsetTop:0,this.rows[g].element&&this.rows[g].element.parentNode?(!1===this.rows[g].visible&&(g=Pa.call(this,null,g)),w=this.rows[g].element.firstChild.offsetTop+this.rows[g].element.firstChild.offsetHeight,n.element.style.borderBottomWidth=_$_d043[3]):(this.tbody.lastChild?(l=this.tbody.lastChild.getAttribute(_$_d043[57]),w=k&&g<l?this.tbody.children[k].offsetTop:this.tbody.lastChild.offsetTop+
this.tbody.lastChild.offsetHeight):w=0,l=!0,n.element.style.borderBottomWidth=_$_d043[61]),w=w-v-1,v+=this.table.offsetTop,this.options.freezeColumns&&(n.element.style.borderLeftWidth=_$_d043[3],n.element.style.borderRightWidth=_$_d043[3],x=ca.getWidth.call(this),a=a<this.options.freezeColumns,e=e<this.options.freezeColumns,a&&e||(a&&!e?(e=this.content.scrollLeft+x,e>q+p&&(p+=e-(q+p),n.element.style.borderRightWidth=_$_d043[61],l=!0)):(e=this.content.scrollLeft+x,e>q&&(e-=q,e>p?q=v=-2E3:(q=q+e+1,
p-=e,n.element.style.borderLeftWidth=_$_d043[61]))))),this.options.freezeRows&&(n.element.style.borderTopWidth=_$_d043[3],n.element.style.borderBottomWidth=_$_d043[3],x=ja.getHeight.call(this),a=c<k,e=g<k,a&&e||(a&&!e?(c=this.content.scrollTop+x,c>v+w&&(w+=c-(v+w),n.element.style.borderBottomWidth=_$_d043[61])):(c=this.content.scrollTop+x,c>v&&(e=c-v,e>w?q=v=-2E3:(v=v+e+1,w-=e,n.element.style.borderTopWidth=_$_d043[61]))))),n.element.style.top=v+_$_d043[59],n.element.style.left=q+_$_d043[59],n.element.style.width=
p+_$_d043[59],n.element.style.height=w+_$_d043[59],n.t=v,n.l=q,n.w=p,n.h=w,f==_$_d043[149]&&(n.moveLeft.style.top=n.h/2+_$_d043[59],n.moveRight.style.top=n.h/2+_$_d043[59],n.moveTop.style.left=n.w/2+_$_d043[59],n.moveDown.style.left=n.w/2+_$_d043[59]),n.active=1);f==_$_d043[149]&&(l?(this.corner.style.top=_$_d043[170],this.corner.style.left=_$_d043[170]):(this.corner.style.top=v+w-2+_$_d043[59],this.corner.style.left=q+p-2+_$_d043[59]));this.borders[f]=n},b=function(a,c){a.element.style.top=_$_d043[170];
a.element.style.left=_$_d043[170];a.active=0;c&&(a.x1=null,a.y1=null,a.x2=null,a.y2=null)};h[_$_d043[11]]=function(a,c,e,g,f,k){d.call(this,a,c,e,g,f,k);f==_$_d043[149]&&(Ga.call(this,!0),L.call(this,_$_d043[126],{x1:a,y1:c,x2:e,y2:g}))};h.reset=function(a,c){a&&a!=_$_d043[149]||(this.corner.style.top=_$_d043[170],this.corner.style.left=_$_d043[170],Ga.call(this,!1));if(a)this.borders[a]&&b(this.borders[a],c);else for(var e=Object.keys(this.borders),g=0;g<e.length;g++)b(this.borders[e[g]],c);a&&a!=
_$_d043[149]||L.call(this,_$_d043[127])};h.refresh=function(a){var c=this.borders;if(a)c[a]&&null!=c[a].x1&&d.call(this,c[a].x1,c[a].y1,c[a].x2,c[a].y2,a);else{a=Object.keys(c);for(var e=0;e<a.length;e++)c[a[e]]&&null!=c[a[e]].x1&&d.call(this,c[a[e]].x1,c[a[e]].y1,c[a[e]].x2,c[a[e]].y2,a[e])}this.edition&&(c=this.parent.input,na.position.call(this,c.x,c.y))};h.destroy=function(a){var c;this&&(c=this.borders[a])&&(c.element.remove(),delete this.borders[a])};return h}(),Wa=function(){var h=function(d){d.setGroup=
h[_$_d043[11]];d.unsetGroup=h.unset};h[_$_d043[11]]=function(d,b,a){0==d&&(a=document.createElement(_$_d043[171]),a.classList.add(_$_d043[172]),this.thead.insertBefore(a,this.thead.firstChild),d=document.createElement(_$_d043[173]),d.innerHTML=_$_d043[174],a.appendChild(d),d=document.createElement(_$_d043[173]),a.appendChild(d),b=this.headers[b])&&(b=b.querySelector(_$_d043[175]),b||(b=document.createElement(_$_d043[32]),b.classList.add(_$_d043[176]),b.innerText=_$_d043[177],d.appendChild(b)))};h.unset=
function(d,b){};return h}(),Ba=function(){var h={start:function(d){if(!P.call(this.parent,this))return!1;if(null!==d.target.getAttribute(_$_d043[57])){var b=d.target.getAttribute(_$_d043[57]);h.event={y:parseInt(b),h:d.target.offsetHeight,p:d.pageY}}else null!==d.target.getAttribute(_$_d043[56])&&(b=d.target.getAttribute(_$_d043[56]),h.event={x:parseInt(b),w:d.target.offsetWidth,p:d.pageX})},end:function(d){var b=[];if(null!=h.event.y){var a=parseInt(this.rows[h.event.y].element.offsetHeight);var c=
this.getSelectedRows(!0);d=c.indexOf(parseInt(h.event.y));if(c.length&&-1<d)for(var e=0;e<c.length;e++)b.push(parseInt(this.rows[c[e]].element.offsetHeight));else c=[];-1==d?(c.push(h.event.y),b.push(h.event.h)):b[d]=h.event.h;this.setHeight(c,a,b)}else if(null!=h.event.x){a=parseInt(this.colgroup[h.event.x].getAttribute(_$_d043[178]));c=this.getSelectedColumns();d=c.indexOf(parseInt(h.event.x));if(c.length&&-1<d)for(e=0;e<c.length;e++)b.push(parseInt(this.options.columns[c[e]].width));else c=[];
-1==d?(c.push(h.event.x),b.push(h.event.w)):b[d]=h.event.w;this.setWidth(c,a,b)}h.event=null},update:function(d){null!=h.event.y?(d=d.pageY-h.event.p,0<h.event.h+d&&(this.rows[h.event.y].element.style.height=h.event.h+d+_$_d043[59],this.refreshBorders())):null!=h.event.x&&(d=d.pageX-h.event.p,0<h.event.w+d&&(this.colgroup[h.event.x].setAttribute(_$_d043[178],h.event.w+d),this.options.columns[h.event.x].width=h.event.w+d),0<this.options.freezeColumns&&ca.refresh.call(this),this.refreshBorders())},
cancel:function(){h.end.call(this)}};return h}();(function(){var h={start:function(d){var b=this.parent.helper;d=parseInt(d.target.getAttribute(_$_d043[56]));if(this.merged.cols[d])console.error(_$_d043[179]);else{h.event={x:d,d};this.headers[d].classList.add(_$_d043[180]);for(var a=0;a<this.tbody.children.length;a++){var c=this.tbody.children[a].getAttribute(_$_d043[57]);this.records[c][d].element.classList.add(_$_d043[180])}a=this.parent.element.getBoundingClientRect();d=this.headers[d].getBoundingClientRect();
c=this.content.getBoundingClientRect();b.style.display=_$_d043[24];b.style.top=c.top-a.top+_$_d043[59];b.style.left=d.left-c.left+_$_d043[59];b.style.width=_$_d043[181];b.style.height=c.height+_$_d043[59];b.classList.add(_$_d043[182])}},end:function(){this.headers[h.event.x].classList.remove(_$_d043[180]);for(var d=0;d<this.tbody.children.length;d++){var b=this.tbody.children[d].getAttribute(_$_d043[57]);this.records[b][h.event.x].element.classList.remove(_$_d043[180])}null!=h.event.d&&h.event.x!=
h.event.d&&(this.moveColumn(h.event.x,h.event.d),this.refreshBorders());this.parent.helper.classList.remove(_$_d043[182]);this.parent.helper.style.display=_$_d043[3];h.event=null},cancel:function(){h.event.d=null;h.end.call(this)},update:function(d){var b=d.target.getAttribute(_$_d043[56]);if(null!=b)if(b=parseInt(b),this.merged.cols[b])console.error(_$_d043[179]);else{d=d.target.clientWidth/2>d.offsetX;h.event.d=d?h.event.x<b?parseInt(b)-1:parseInt(b):h.event.x>b?parseInt(b)+1:parseInt(b);b=this.headers[b].getBoundingClientRect();
var a=this.content.getBoundingClientRect();this.parent.helper.style.left=(d?b.left:b.right)-a.left+_$_d043[59]}}};return h})();var wa=function(){var h={start:function(d){if(P.call(this.parent,this)){this.resetSelection();var b=this.parent.helper;if(null!==d.target.getAttribute(_$_d043[57])){var a=parseInt(d.target.getAttribute(_$_d043[57]));this.merged.rows[a]?console.error(_$_d043[183]):this.results?console.error(_$_d043[184]):(h.event={y:a,d:a},this.rows[a].element.classList.add(_$_d043[180]),d=
this.parent.element.getBoundingClientRect(),a=this.rows[a].element.getBoundingClientRect(),b.style.display=_$_d043[24],b.style.top=a.top-d.top+_$_d043[59],b.style.left=_$_d043[185],b.style.width=this.content.offsetWidth-50+_$_d043[59],b.style.height=_$_d043[181],b.classList.add(_$_d043[186]))}else if(null!==d.target.getAttribute(_$_d043[56]))if(a=parseInt(d.target.getAttribute(_$_d043[56])),this.merged.cols[a])console.error(_$_d043[179]);else{h.event={x:a,d:a};this.headers[a].classList.add(_$_d043[180]);
for(d=0;d<this.tbody.children.length;d++){var c=this.tbody.children[d].getAttribute(_$_d043[57]);this.records[c][a].element.classList.add(_$_d043[180])}d=this.parent.element.getBoundingClientRect();a=this.headers[a].getBoundingClientRect();c=this.content.getBoundingClientRect();b.style.display=_$_d043[24];b.style.top=c.top-d.top+_$_d043[59];b.style.left=a.left-c.left+_$_d043[59];b.style.width=_$_d043[181];b.style.height=c.height+_$_d043[59];b.classList.add(_$_d043[182])}}else return!1},end:function(){if(null!=
h.event.y)this.rows[h.event.y].element.classList.remove(_$_d043[180]),null!=h.event.d&&h.event.y!=h.event.d&&(this.moveRow(h.event.y,h.event.d),this.updateSelectionFromCoords(0,h.event.d,this.options.columns.length-1,h.event.d)),this.parent.helper.classList.remove(_$_d043[186]);else if(null!=h.event.x){this.headers[h.event.x].classList.remove(_$_d043[180]);for(var d=0;d<this.tbody.children.length;d++){var b=this.tbody.children[d].getAttribute(_$_d043[57]);this.records[b][h.event.x].element.classList.remove(_$_d043[180])}null!=
h.event.d&&h.event.x!=h.event.d&&(this.moveColumn(h.event.x,h.event.d),this.refreshBorders());this.parent.helper.classList.remove(_$_d043[182])}this.parent.helper.style.display=_$_d043[3];h.event=null},cancel:function(){h.event.d=null;h.end.call(this)},update:function(d){if(null!=h.event.y){var b=d.target.getAttribute(_$_d043[57]);if(null!=b){var a=b=parseInt(b),c=d.target.clientHeight/2>d.offsetY;c?h.event.y<b&&(a=b-1):h.event.y>b&&(a=b+1);d=!1;this.merged.rows[a]&&(h.event.y>a?this.merged.rows[a-
1]&&(d=!0):this.merged.rows[a+1]&&(d=!0));d||(h.event.d=a,a=this.parent.element.getBoundingClientRect(),b=this.rows[b].element.getBoundingClientRect(),this.parent.helper.style.top=(c?b.top:b.bottom)-a.top+_$_d043[59])}}else c=d.target.getAttribute(_$_d043[56]),null!=c&&(a=c=parseInt(c),(b=d.target.clientWidth/2>d.offsetX)?h.event.x<c&&(a=c-1):h.event.x>c&&(a=c+1),d=!1,this.merged.cols[a]&&(h.event.x>a?this.merged.cols[a-1]&&(d=!0):this.merged.cols[a+1]&&(d=!0)),d||(h.event.d=a,a=this.headers[c].getBoundingClientRect(),
c=this.content.getBoundingClientRect(),this.parent.helper.style.left=(b?a.left:a.right)-c.left+_$_d043[59]))}};return h}(),sa=function(){var h=function(d){d.getMerge=h[_$_d043[58]];d.setMerge=h[_$_d043[11]];d.updateMerge=h.update;d.removeMerge=h.remove;d.destroyMerged=d.destroyMerge=h.destroy};h.isMerged=function(d,b){var a=F.getColumnNameFromCoords(d,b);if(a=this.merged.cells[a])if(i=this.options.mergeCells[a])m&&void 0!==m[a]||(i[1]>t&&(t=i[1]),m&&(m[a]=this.records[b][d].element&&!this.records[b][d].merged?
!0:!1))};h.getAffected=function(d){if(void 0!==this[d]){for(var b=d,a=this[d],c=[];this[b]==a;)c.push(b),b--;for(b=d+1;this[b]==a;)c.push(b),b++;c.sort(function(e,g){return e-g});return c}return!1};h[_$_d043[58]]=function(d){return d?this.options.mergeCells[d]:this.options.mergeCells};h[_$_d043[11]]=function(d,b,a){if(!P.call(this.parent,this))return!1;this.options.mergeCells||(this.options.mergeCells={});var c,e=null,g={},f={},k={},l=!1;typeof d==_$_d043[25]?k[d]=[b,a]:typeof d==_$_d043[103]?k=d:
((e=this.getHighlighted())?e=[F.getColumnNameFromCoords(e[0],e[1]),e[2]-e[0]+1,e[3]-e[1]+1]:(jSuites.notification({message:E(_$_d043[187])}),e=!1),e&&(k[e[0]]=[e[1],e[2]]));b=Object.keys(k);if(b.length){for(a=0;a<b.length;a++){var n=b[a],q=k[b[a]][0],p=k[b[a]][1];q=parseInt(q);p=parseInt(p);if((!q||2>q)&&(!p||2>p))console.log(E(_$_d043[188])+_$_d043[157]+n);else if(this.options.mergeCells[n])f[n]=[q,p],g[n]=this.options.mergeCells[n],h.update.call(this,n,q,p);else{e=F.getCoordsFromColumnName(n);for(var v=
e[1];v<e[1]+p;v++)for(var w=e[0];w<e[0]+q;w++)d=F.getColumnNameFromCoords(w,v),(c=this.merged.cells[d])&&this.options.mergeCells[c]&&(g[c]=this.options.mergeCells[c],h.applyDestroy.call(this,c));f[n]=this.options.mergeCells[n]=[q,p];h.applyCreate.call(this,n);Q.attached.call(this,e[0],e[1])||(l=e)}}Object.keys(f).length&&(l&&H[_$_d043[64]].call(this,e[1],e[0]),R.call(this.parent,{worksheet:this,action:_$_d043[84],newValue:f,oldValue:g}),L.call(this,_$_d043[84],[f]),h.build.call(this),ka.refresh.call(this),
ba.refresh.call(this),G.call(this.parent,_$_d043[189],this,f,g))}};h.update=function(d,b,a){var c=this.options.mergeCells;if(c[d]){var e=c[d][1];if(b!==c[d][0]||e!==a)h.applyDestroy.call(this,d),b&&a&&(c[d]=[b,a],h.applyCreate.call(this,d));h.build.call(this)}};h.remove=function(d,b){if(!P.call(this.parent,this))return!1;b={};var a={},c={};typeof d==_$_d043[25]?c[d]=!0:typeof d==_$_d043[103]&&(c=d);d=Object.keys(c);for(c=0;c<d.length;c++)this.options.mergeCells[d[c]]&&(b[d[c]]=this.options.mergeCells[d[c]],
a[d[c]]=!0,h.applyDestroy.call(this,d[c],!0));h.build.call(this);R.call(this.parent,{worksheet:this,action:_$_d043[85],newValue:a,oldValue:b});L.call(this,_$_d043[85],{data:a})};h.destroy=function(){h.remove.call(this,this.options.mergeCells,!0)};h.applyCreate=function(d,b){var a=this.options.mergeCells;if(a[d]){var c=a[d][0]||1,e=a[d][1]||1;d=F.getCoordsFromColumnName(d);if(!this.records[d[1]][d[0]].merged||1==b)if(a=Q[_$_d043[58]].call(this,d[0],d[1])){a.classList.remove(_$_d043[66]);a.style.display=
_$_d043[3];1<c?a.setAttribute(_$_d043[190],c):a.removeAttribute(_$_d043[190]);1<e?a.setAttribute(_$_d043[191],e):a.removeAttribute(_$_d043[191]);1==this.options.textOverflow&&(a.style.overflow=_$_d043[112]);for(var g=0;g<e;g++)for(var f=0;f<c;f++){b=d[0]+f;var k=d[1]+g;if(a=this.records[k][b])if(a.merged=[f,g,a.v,c,e],0!=f||0!=g)a.element||Q[_$_d043[58]].call(this,b,k),a.element.classList.add(_$_d043[66]),a.merged[3]=a.element.innerText,a.element.innerText=_$_d043[3],O.call(this,b,k,_$_d043[3])}}}};
h.applyDestroy=function(d,b){var a=this.options.mergeCells;if(a[d]){var c=F.getCoordsFromColumnName(d),e=c[0];c=c[1];var g=a[d][0],f=a[d][1];delete this.options.mergeCells[d];for(d=0;d<f;d++)for(var k=0;k<g;k++)if(a=this.records[c+d][e+k])a.element&&(0==k&&0==d?(a.element.removeAttribute(_$_d043[190]),a.element.removeAttribute(_$_d043[191])):(a.element.classList.remove(_$_d043[66]),1==b&&(O.call(this,e+k,c+d,a.merged[2]),a.element.innerHTML=a.merged[3]))),a.merged&&delete a.merged}};h.updateConfig=
function(d,b,a,c){if(1==b)var e=[a];else{e=[];for(var g=a;g<a+c;g++)e.push(g)}var f=this.options.mergeCells,k=Object.keys(f),l={};for(g=0;g<k.length;g++){a=F.getCoordsFromColumnName(k[g]);for(var n=a[d];n<a[d]+f[k[g]][d];n++)-1!==e.indexOf(n)&&(l[k[g]]||(l[k[g]]=[f[k[g]][0],f[k[g]][1]],1==b&&(l[k[g]][d]+=c)),0==b&&l[k[g]][d]--)}k=Object.keys(l);for(g=0;g<k.length;g++)h.update.call(this,k[g],l[k[g]][0],l[k[g]][1]);h.build.call(this)};h.build=function(){var d=this.options.mergeCells;this.merged={cols:[],
rows:[],cells:[]};if(d)for(var b=Object.keys(d),a=0;a<b.length;a++){for(var c=F.getCoordsFromColumnName(b[a]),e=parseInt(d[b[a]][0]),g=parseInt(d[b[a]][1]),f=0;f<e;f++)this.merged.cols[c[0]+f]=!0;for(var k=0;k<g;k++)this.merged.rows[c[1]+k]=!0;for(k=0;k<g;k++)for(f=0;f<e;f++){var l=F.getColumnNameFromCoords(c[0]+f,c[1]+k);this.merged.cells[l]=b[a]}}};h.batch=function(d){var b=Object.keys(d);if(b.length)for(var a=0;a<b.length;a++)!1===d[b[a]]&&h.applyCreate.call(this,b[a])};return h}(),Da=function(){var h=
function(d){d.getHeader=h[_$_d043[58]];d.setHeader=h[_$_d043[11]];d.getHeaders=h.all};h[_$_d043[58]]=function(d){var b;if(b=this.options.columns)return b[d].title||F.getColumnName(d)};h.all=function(d){for(var b=[],a=0;a<this.options.columns.length;a++)b.push(h[_$_d043[58]].call(this,a));return d?b:b.join(this.options.csvDelimiter)};h[_$_d043[11]]=function(d,b){if(!P.call(this.parent,this))return!1;var a;if(a=this.options.columns[d]){var c=h[_$_d043[58]].call(this,d);if(void 0===b&&(b=prompt(E(_$_d043[192]),
c),!b))return!1;a.title=b;if(a=this.headers[d])b?(a.innerHTML=b,a.setAttribute(_$_d043[193],b)):(a.innerHTML=F.getColumnName(d),a.removeAttribute(_$_d043[193]));R.call(this.parent,{worksheet:this,action:_$_d043[90],column:d,oldValue:c,newValue:b});L.call(this,_$_d043[90],{column:d,title:b});G.call(this.parent,_$_d043[194],this,d,b,c)}};h.create=function(d){if(this.headers[d])return this.headers[d];var b=document.createElement(_$_d043[173]);b.classList.add(_$_d043[195]);b.setAttribute(_$_d043[56],
d);var a=document.createElement(_$_d043[196]);this.headers[d]=b;this.colgroup[d]=a;h.applyProperties.call(this,d);G.call(this.parent,_$_d043[197],this,d,b,this.options.columns[d]);return b};h.applyProperties=function(d){var b=this.options.columns[d],a=b.width||this.options.defaultColWidth,c=this.headers[d];b.align&&(c.style.textAlign=b.align);b.title?(c.innerText=b.title,c.setAttribute(_$_d043[193],b.title)):(c.innerText=F.getColumnName(d),c.removeAttribute(_$_d043[193]));b.tooltip&&(c.title=b.tooltip);
var e=this.options.filters;!0===b.filter&&(e=!0);!1===b.filter&&(e=!1);!0===e&&c.classList.add(_$_d043[198]);if(!1===b.visible||b.type==_$_d043[112])a=_$_d043[119],b.visible=!1;this.colgroup[d].setAttribute(_$_d043[178],a)};return h}(),fa=function(){var h=function(b,a,c){var e=this.footers.content,g;e&&e[a]&&e[a][b]&&(g=e[a][b].element)&&(void 0===c&&(e=this.options.footers,c=e[a]&&e[a][b]?e[a][b]:_$_d043[3]),aa(c)&&1==this.parent.config.parseFormulas&&(c=Z.execute.call(this,c,b,null,!1)),this.options.applyMaskOnFooters&&
(e=na[_$_d043[58]].call(this,b),c=u.editors.general.parseValue(b,a,c,this,e[1],g)),c instanceof Element||c instanceof HTMLDocument?(g.innerHTML=_$_d043[3],g.appendChild(c)):1==this.parent.config.stripHTML?g.innerText=c:g.innerHTML=c)},d=function(b){b.getFooter=d[_$_d043[58]];b.setFooter=d[_$_d043[11]];b.resetFooter=d.reset;b.refreshFooter=d.refresh;b.getFooterValue=d.value;b.setFooterValue=d.value};d[_$_d043[58]]=function(){return this.options.footers};d[_$_d043[11]]=function(b){if(b){var a=this.options.footers;
this.options.footers=b}this.options.footers!=a&&(fa.build.call(this),d.render.call(this),L.call(this,_$_d043[199],{data:this.options.footers}),G.call(this.parent,_$_d043[200],this,this.options.footers,a))};d.refresh=function(){var b=this.options.footers;if(b&&b.length)for(var a=0;a<b.length;a++)for(var c=0;c<b[a].length;c++)h.call(this,c,a,b[a][c])};d.value=function(b,a,c){if(void 0===c)return this.options.footers[a][b];h.call(this,b,a,c);L.call(this,_$_d043[201],{x:b,y:a,value:c});G.call(this.parent,
_$_d043[202],this,b,a,c)};d.reset=function(){var b=this.options.footers;this.options.footers=null;this.footers.content=null;this.tfoot.innerHTML=_$_d043[3];L.call(this,_$_d043[203],{});G.call(this.parent,_$_d043[200],this,null,b)};d.create=function(b,a){var c=this.footers.content[a][b];if(c&&c.element)return c.element;c=this.footers.content[a][b]={};var e=this.options.columns[b].align;c.element=document.createElement(_$_d043[173]);c.element.setAttribute(_$_d043[56],b);c.element.setAttribute(_$_d043[57],
a);e&&(c.element.style.textAlign=e);h.call(this,b,a);return c.element};d.build=function(){this.footers={element:this.tfoot,content:[]};if(this.options.footers){this.tfoot.innerHTML=_$_d043[3];for(var b=0;b<this.options.footers.length;b++){if(!this.footers.content[b]){this.footers.content[b]=[];var a=document.createElement(_$_d043[171]),c=document.createElement(_$_d043[173]);c.innerHTML=_$_d043[174];a.appendChild(c);this.footers.element.appendChild(a)}for(a=0;a<this.options.columns.length;a++)this.options.footers[b][a]||
(this.options.footers[b][a]=_$_d043[3]),this.footers.content[b][a]||(this.footers.content[b][a]={})}}};d.render=function(){for(var b=this.options.footers,a=0;a<b.length;a++)for(var c=0;c<b[a].length;c++){var e=fa.create.call(this,c,a);this.tfoot.children[a].appendChild(e)}};d.adjust=function(b,a,c){var e=[],g=this.options.footers,f=this.footers.content;if(g)if(1==c){if(this.headers[b]&&this.headers[b].parentNode)var k=this.headers[b]==this.thead.lastChild.lastChild?!0:!1,l=!0;for(c=0;c<g.length;c++){for(var n=
g[c].splice(b),q=b;q<b+a;q++)g[c][q]=_$_d043[3];g[c]=g[c].concat(n);n=f[c].splice(b);for(q=b;q<b+a;q++)f[c][q]={element:d.create.call(this,q,c)},l&&(1==k?this.tfoot.children[c].appendChild(f[c][q].element):this.tfoot.children[c].insertBefore(f[c][q].element,this.tfoot.children[c].children[b].nextSibling));f[c]=f[c].concat(n)}}else for(c=0;c<g.length;c++){for(q=b;q<b+a;q++)(k=this.footers.content[c][q].element)&&k.parentNode&&k.parentNode.removeChild(k);f[c].splice(b,a);e[c]=g[c].splice(b,a)}return e};
return d}(),ya=function(){var h=function(d){d.setNestedCell=h.cell;d.getNestedCell=h.cell;d.setNestedHeaders=h[_$_d043[11]];d.getNestedHeaders=h[_$_d043[58]];d.resetNestedHeaders=h.reset};h[_$_d043[58]]=function(){return this.options.nestedHeaders};h[_$_d043[11]]=function(d){h.reset.call(this);this.options.nestedHeaders=d;h.build.call(this);H.call(this,!0,!0);ba.refresh.call(this);L.call(this,_$_d043[204],{data:d});G.call(this.parent,_$_d043[205],this,d)};h.reset=function(){var d=[],b=this.thead.children;
this.options.nestedHeaders=null;for(var a=0;a<b.length;a++)b[a].classList.contains(_$_d043[206])&&d.push(b[a]);if(d.length)for(;b=d.shift();)b.remove();this.nested=null;H.call(this,!0,!0);ba.refresh.call(this);L.call(this,_$_d043[207]);G.call(this.parent,_$_d043[205],this,[])};h.cell=function(d,b,a){if(a){if(!P.call(this.parent,this))return!1;var c=this.options.nestedHeaders[b][d],e=this.nested.content[b][d].element;void 0!==a.title&&(e.innerText=a.title);void 0!==a.tooltip&&(e.title=a.tooltip);void 0!==
a.colspan&&(c.colspan=a.colspan,e.setAttribute(_$_d043[190],a.colspan),e.style.display=0==c.colspan?_$_d043[52]:_$_d043[3]);L.call(this,_$_d043[208],{x:d,y:b,properties:a});G.call(this.parent,_$_d043[209],this,d,b,a)}else return this.nested.content[b][d].element};h.range=function(d){d=this.options.nestedHeaders[d];for(var b=[],a=0,c=0;c<d.length;c++){var e=parseInt(d[c].colspan);b[c]=[a,a+e-1];a+=e}return b};h.getColumns=function(d){d=this.options.nestedHeaders[d];for(var b=[],a=0;a<d.length;a++)for(var c=
d[a].colspan,e=0;e<c;e++)b.push(a);return b};h.getAffected=function(d){var b=[],a=this.options.nestedHeaders;if(a){var c,e,g;for(e=0;e<a.length;e++)if((c=h.getColumns.call(this,e))&&void 0!==c[d]){var f=h.range.call(this,e);for(g=f[c[d]][0];g<=f[c[d]][1];g++)b.push(g)}}return b};h.create=function(d,b){if(this.nested.content[b][d])return this.nested.content[b][d].element;var a=this.options.nestedHeaders[b][d]||{},c=this.nested.content[b][d]={};a.colspan||(a.colspan=1);a.align||(a.align=_$_d043[210]);
a.title||(a.title=_$_d043[3]);var e=document.createElement(_$_d043[173]);e.setAttribute(_$_d043[211],d);e.setAttribute(_$_d043[212],b);e.setAttribute(_$_d043[190],a.colspan);e.setAttribute(_$_d043[213],a.align);e.innerHTML=a.title;a.tooltip&&(e.title=a.tooltip);return c.element=e};h.build=function(){this.nested||(this.nested={content:[]});var d,b,a=0;if(d=this.options.nestedHeaders){for(b=0;b<d.length;b++){this.nested.content[b]=[];var c=document.createElement(_$_d043[173]);c.innerHTML=_$_d043[174];
var e=document.createElement(_$_d043[171]);e.classList.add(_$_d043[206]);e.appendChild(c);this.thead.insertBefore(e,this.thead.lastChild)}for(b=0;b<this.thead.children.length;b++)this.thead.children[b].firstChild.style.top=a+_$_d043[59],a+=this.thead.children[b].offsetHeight}};h.adjust=function(d,b,a,c){var e=this.options.nestedHeaders;if(e)if(1==a)if(c&&c.nested)for(a=0;a<e.length;a++)for(var g=0;g<e[a].length;g++)h.cell.call(this,g,a,{colspan:c.nested[a][g]});else for(a=0;a<e.length;a++){if((g=
h.getColumns.call(this,a))&&e[a][g]){g=g[d];var f=parseInt(e[a][g].colspan)+b;h.cell.call(this,g,a,{colspan:f})}}else{c=[];for(a=0;a<e.length;a++)if(f=h.getColumns.call(this,a)){c[a]=[];for(g=0;g<b;g++){var k=f[d+g];void 0!==k&&(typeof c[a][k]==_$_d043[21]&&(c[a][k]=e[a][k].colspan),e[a][k].colspan--)}f=Object.keys(c[a]);for(g=0;g<f.length;g++)h.cell.call(this,f[g],a,{colspan:e[a][f[g]].colspan})}return c}};return h}(),ha=function(){var h=function(c,e,g,f){aa(c)?c=Z.shiftFormula(c,e,g):f&&(c=jSuites.calendar.dateToNum(c),
0>e||0>g?c--:c++,c=jSuites.calendar.numToDate(c));return c},d=function(c,e,g){if(1===c.length){if(1<e||u.formula&&typeof u.formula.TREND!==_$_d043[104])g?c[0]--:c[0]++;return c}e=1;g=[];for(var f=[],k=0;k<c.length;k++)f.push(e++);for(k=0;k<c.length;k++)g.push(e++);return u.formula&&typeof u.formula.TREND==_$_d043[104]?u.formula.TREND(c,f,g):c},b=function(c,e,g,f,k){var l=null,n=[],q=null,p=[];for(l=0;l<c.length;l++){if(jSuites.isNumeric(c[l])&&(n.push(c[l]),jSuites.isNumeric(c[l+1])))continue;n.length?
(q=d(n,c.length,f),Array.isArray(q)?(q.forEach(function(v){p.push(v)}),n=[]):p.push(q)):(q=void 0!==k&&this.options.columns[k].type===_$_d043[214]?!0:!1,f&&(e*=-1,g*=-1),q=h(c[l],e*c.length,g*c.length,q),p.push(q))}return p},a=function(c,e){var g=function(w){var x;(x=this.results)?w=x.indexOf(w):x=this.rows;w--;for(var y=w;0<=y;y--)if(w=this.results?x[y]:y,this.rows[w]&&this.rows[w].element)return w;return 0},f=function(w){var x;(x=this.results)?w=x.indexOf(w):x=this.rows;w++;for(var y=w;y<x.length;y++)if(w=
this.results?x[y]:y,this.rows[w]&&this.rows[w].element)return w;return x[x.length-1]},k=function(w,x){for(;0<=w;w--)if(this.records[x][w].element&&!this.records[x][w].element.classList.contains(_$_d043[66]))return w;return 0},l=function(w,x){for(;w<this.options.columns.length;w++)if(this.records[x][w].element&&!this.records[x][w].element.classList.contains(_$_d043[66]))return w;return this.options.columns-1},n=this.getHighlighted(),q=n[0],p=n[1],v=n[2];n=n[3];c=parseInt(c);e=parseInt(e);null!=c&&
null!=e&&(0<c-v?(l=l.call(this,parseInt(v)+1,e),c=parseInt(c)):(l=parseInt(c),c=k.call(this,parseInt(q)-1,e)),0<e-n?(f=f.call(this,parseInt(n)),e=parseInt(e)):(f=parseInt(e),e=g.call(this,parseInt(p))),c-l<e-f?(l=parseInt(q),c=parseInt(v)):(f=parseInt(p),e=parseInt(n)),this.setBorder(l,f,c,e,_$_d043[159]))};a.execute=function(c){if(!P.call(this.parent,this))return!1;var e=this.getHighlighted(),g=Ha[_$_d043[58]].call(this,e,!1,!1),f=!0,k=!1,l=!1,n=this.borders.cloning;if(c)if(n&&n.active){c=n.x1;var q=
n.y1,p=n.x2;n=n.y2;e[0]==c?(k=!0,e[1]>q&&(l=!0)):e[0]>c&&(l=!0)}else return!1;else if(n=this.getSelected(),n.length)for(k=!0,c=n[0].x,p=n[n.length-1].x,q=parseInt(n[n.length-1].y)+1,n=parseInt(n[n.length-1].y);1==f;){if(this.options.data[n+1]){this.options.data[n+1][c-1]||this.options.data[n+1][p+1]||(f=!1);for(var v=c;v<=p;v++)this.options.data[n+1][v]&&(f=!1)}else f=!1;f&&n++}else return!1;var w=La.getFromSelection.call(this,e),x=v=0,y=0,A=0,z=[],I=[],r=!0,B=this;if(k)for(f=function(){I.push({x:v,
y:x,value:z[A],style:w[A][y]});A++;void 0==g[A]&&(A=0,r&&(z=b.call(B,z,0,1,l,v)))},v=c;v<=p;v++){r=void 0!==this.options.columns[v].autoIncrement?this.options.columns[v].autoIncrement:this.parent.config.autoIncrement;A=0;z=[];for(x=0;x<g.length;x++)z.push(g[x][y]);l&&z.reverse();r&&(z=b.call(B,z,0,1,l,v));if(l)for(x=n;x>=q;x--)f();else for(x=q;x<=n;x++)f();y++}else for(f=function(){I.push({x:v,y:x,value:z[y],style:w[A][y]});y++;void 0==g[A][y]&&(y=0,z=b(z,1,0,l))},x=q;x<=n;x++){y=0;z=[];for(v=0;v<
g[A].length;v++)z.push(g[A][v]);l&&z.reverse();z=b(z,1,0,l);if(l)for(v=p;v>=c;v--)f();else for(v=c;v<=p;v++)f();A++}I.length&&this.setValue(I);e[0]<c&&(c=e[0]);e[1]<q&&(q=e[1]);e[2]>p&&(p=e[2]);e[3]>n&&(n=e[3]);this.resetBorders(_$_d043[159],!0);this.updateSelectionFromCoords(c,q,p,n)};a.end=function(c){ha.event=!1;ha.execute.call(this,!0);ca.refresh.call(this)};a.cancel=function(c){ha.event=!1;this.resetBorders(_$_d043[159],!0)};return a}(),Ha=function(){var h=function(d){d.getData=h[_$_d043[58]];
d.getJson=h[_$_d043[58]];d.setData=h[_$_d043[11]];d.loadData=h.load;d.getRowData=h.getRowData;d.setRowData=h.setRowData;d.getColumnData=h.getColumnData;d.setColumnData=h.setColumnData;d.updateData=h.update;d.refresh=h.refresh;d.data=h[_$_d043[58]];d.download=h.download;d.copy=h.copy;d.paste=h.paste;d.cut=function(){return d.copy(!0)}};h[_$_d043[58]]=function(d,b,a,c){!0===d&&(d=this.getHighlighted());var e=d?!0:!1,g=[],f=this.options.columns.length,k=this.options.data.length;void 0===c&&(c=this.dataType&&
typeof a==_$_d043[21]?1:0);for(var l=0;l<k;l++){var n=null;var q=c?{}:[];for(var p=0;p<f;p++){var v;if(!(v=!e)){v=d[1];var w=d[2],x=d[3];v=p>=d[0]&&p<=w&&l>=v&&l<=x?!0:!1}if(v&&(!e||!this.results||-1!=this.results.indexOf(l))){v=O.call(this,p,l);if(b){if(e&&!1===this.rows[l].visible)continue;n=oa.processed.call(this,p,l);void 0!==n&&(v=n)}a&&v.match&&(v.match(a)||v.match(/\n/)||v.match(/"/))&&(v=v.replace(new RegExp(_$_d043[20],_$_d043[14]),_$_d043[215]),v=_$_d043[20]+v+_$_d043[20]);c?jSuites.path.call(q,
_$_d043[3]+qa.call(this,p),v):q.push(v);n=!0}}n&&(a?g.push(q.join(a)):g.push(q))}return a?g.join(_$_d043[10])+_$_d043[10]:g};h.parse=function(){for(var d,b={},a=0,c,e=[],g=this.options.data,f=0;f<g.length;f++)d=null,c=f,g[f].data&&(Array.isArray(g[f].data)||typeof g[f].data==_$_d043[103])&&(typeof g[f].id!==_$_d043[21]&&(d=parseInt(g[f].id)),typeof g[f].row!==_$_d043[21]&&(c=g[f].row),e[c]=g[f].data,g[f]=[]),c>a&&(a=c),d&&(b[c]=d);if(Object.keys(e).length)for(f=0;f<=a;f++)e[f]&&(g[f]=e[f]);a=this.getPrimaryKey();
if(!1!==a)for(a=qa.call(this,a),f=0;f<g.length;f++)b[f]||!1===a||(d=parseInt(g[f][a]),0<d&&(b[f]=d));return b};h.type=function(){for(var d=this.dataType=0;d<this.options.columns.length;d++)typeof this.options.columns[d].name!==_$_d043[21]&&(this.dataType=1)};h[_$_d043[11]]=function(d){d=h.standardize(d);var b={},a=[],c={};var e=Object.keys(d[0]).length-this.options.columns.length;0<e&&this.insertRow(e);var g=d.length-this.options.data.length;0<g&&this.insertRow(g);for(var f=0;f<this.options.data.length;f++){void 0===
d[f]&&(d[f]={row:f,data:[]});for(var k=0;k<this.options.columns.length;k++)void 0===d[f].data[k]&&(d[f].data[k]=_$_d043[3])}for(k=0;k<this.options.columns.length;k++){var l=qa.call(this,k);c[l]=k}for(f=0;f<d.length;f++){g=d[f].row;l=Object.keys(d[f].data);for(k=0;k<l.length;k++)e=null,void 0!==c[l[k]]?e=c[l[k]]:-1<l[k]&&(e=parseInt(l[k])),null!==e&&a.push({x:e,y:g,value:d[f].data[l[k]]});d[f].id&&(b[g]=d[f].id)}xa.setId.call(this,b);oa[_$_d043[11]].call(this,a,null,!0)};h.build=function(){this.results=
null;this.rows=[];this.records=[];this.sequence=0;h.type.call(this);if(this.options.data){var d=h.parse.call(this),b=this.options.data.length;this.options.minDimensions[1]>b&&(b=this.options.minDimensions[1]);for(var a=0;a<b;a++){var c=d[a]?d[a]:null;ta.row.call(this,a,c)}}};h.load=function(d){this.resetBorders();this.resetSelection();this.tbody.innerText=_$_d043[3];this.options.data=d;h.build.call(this);H.call(this,!0,!0);ea.update.call(this)};h.refresh=function(d){if(typeof d!==_$_d043[21])for(var b=
0;b<this.options.columns.length;b++){var a=this.records[d]&&this.records[d][b].element?this.records[d][b].element:null,c=na[_$_d043[58]].call(this,b,d);typeof c[0].updateCell==_$_d043[104]&&c[0].updateCell(a,O.call(this,b,d),b,d,this,c[1]);a&&Q.applyOverflow.call(this,a,b,d)}else if(this.options.url){var e=this;1==this.parent.config.loadingSpin&&jSuites.loading.show();jSuites.ajax({url:this.options.url,method:_$_d043[74],dataType:_$_d043[75],success:function(g){e.setData(g);jSuites.loading.hide()}})}};
h.getRowData=function(d,b){if(typeof this.options.data[d]===_$_d043[21])return!1;if(b){if(this.dataType){b={};for(var a=0;a<this.options.columns.length;a++){var c=_$_d043[3]+qa.call(this,a),e=_$_d043[3]+oa.processed.call(this,a,d,!0);jSuites.path.call(b,c,e)}}else for(b=[],a=0;a<this.options.columns.length;a++)b.push(oa.processed.call(this,a,d,!0));return b}return JSON.parse(JSON.stringify(this.options.data[d]))};h.setRowData=function(d,b,a){for(var c=[],e=0;e<this.options.columns.length;e++)typeof b[e]===
_$_d043[21]&&(b[e]=_$_d043[3]),c.push({x:e,y:d,value:b[e]});c.length&&this.setValue(c,null,a)};h.getColumnData=function(d,b){if(typeof this.options.columns[d]===_$_d043[21])return!1;for(var a=[],c=0;c<this.options.data.length;c++){var e=b?oa.processed.call(this,d,c,!0):O.call(this,d,c);a.push(e)}return a};h.setColumnData=function(d,b,a){for(var c=[],e=0;e<this.rows.length;e++)typeof b[e]===_$_d043[21]&&(b[e]=_$_d043[3]),c.push({x:d,y:e,value:b[e]});c.length&&this.setValue(c,null,a)};h.copy=function(d){var b=
this,a=this.getHighlighted(),c=function(){b.setBorder(a[0],a[1],a[2],a[3],_$_d043[150]);b.borders.copying.clear=1==d?!0:!1},e=h[_$_d043[58]].call(this,a,!0,_$_d043[216]),g=G.call(this.parent,_$_d043[217],this,a,e);if(g)e=g;else if(!1===g)return!1;navigator.clipboard?navigator.clipboard.writeText(e).then(c):(this.parent.textarea.value=e,this.parent.textarea.select(),document.execCommand(_$_d043[218]),c());return e};h.paste=function(d,b,a){if(!P.call(this.parent,this))return!1;var c=this,e=function(){c.borders.copying&&
(c.resetBorders(_$_d043[150],!0),c.borders.copying.clear=!1)},g=null,f=this.options.style,k=null,l=null,n=[];if(this.borders.copying){var q=[this.borders.copying.x1,this.borders.copying.y1,this.borders.copying.x2,this.borders.copying.y2];k=q[0];l=q[1];var p=jSuites.hash(a),v=jSuites.hash(h[_$_d043[58]].call(this,q,!0,_$_d043[216]));if(p!=v)e();else{var w=0,x=0;a=h[_$_d043[58]].call(this,q,!1,!1);for(p=q[1];p<=q[3];p++)if(!this.results||-1!=this.results.indexOf(p)){n[x]=[];w=0;for(v=q[0];v<=q[2];v++)g=
F.getColumnNameFromCoords(v,p),n[x][w]=f&&f[g]?f[g]:_$_d043[219],w++;x++}}}d=parseInt(d);b=parseInt(b);if(a){Array.isArray(a)||(a=F.parseCSV(a,_$_d043[216]));if(p=G.call(this.parent,_$_d043[220],this,a,d,b,n))a=p;else if(!1===p)return!1;100<a.length&&!this.options.pagination&&!H.limited.call(this)&&console.log(_$_d043[221]);if(g=this.getHighlighted()){w=[];x=[];var y=[];f=[];var A=0,z=0;for(p=g[1];p<=g[3];p++)if(!this.results||-1!=this.results.indexOf(p)){w=[];x=[];for(v=g[0];v<=g[2];v++)w.push(a[z][A]),
n&&n[z]&&n[z][A]?x.push(n[z][A]):x.push(_$_d043[3]),A++,A>=a[0].length&&(A=0);y.push(w);f.push(x);z++;z>=a.length&&(z=0)}0==y.length%a.length&&0==y[0].length%a[0].length&&(a=y,n=f)}f=null;g=[];if(this.borders.copying&&!0===this.borders.copying.clear){for(p=q[1];p<=q[3];p++)for(v=q[0];v<=q[2];v++)(!this.results||this.results&&0<=this.results.indexOf(p))&&g.push({x:v,y:p,value:_$_d043[3],style:_$_d043[3]});e()}p=d+a[0].length-this.options.columns.length;0<p&&this.insertColumn(p);p=b+a.length-this.rows.length;
0<p&&this.insertRow(p);x=w=d;A=y=b;z=null;this.results&&(f=this.results.indexOf(b));for(p=0;p<a.length;p++)for(v=0;v<a[p].length;v++){null!==k&&null!==l&&a[p][v][0]==_$_d043[18]&&(a[p][v]=Z.shiftFormula(a[p][v],d-k,b-l));x=d+v;A=b+p;this.results&&(A=this.results[f+p]);var I={x,y:A,value:a[p][v]};n&&n[p]&&n[p][v]&&(I.style=n[p][v]);g.push(I);null===z&&ka.isSelected.call(this,x,A,q)&&(z=!0)}z&&e();g.length&&(oa[_$_d043[11]].call(this,g,null,this.parent.config.forceUpdateOnPaste?!0:!1),G.call(this.parent,
_$_d043[222],this,g),this.updateSelectionFromCoords(w,y,x,A))}};h.download=function(d,b){if(this.parent.config.allowExport)if(u.render)u.render(this.parent);else{void 0===b&&(b=!0);var a=_$_d043[3];if(1==d||1==this.parent.config.includeHeadersOnDownload)a+=this.getHeaders().replace(/\s+/gm,_$_d043[154])+_$_d043[10];a+=h[_$_d043[58]].call(this,null,b,this.options.csvDelimiter);b=new Blob([_$_d043[224]+a],{type:_$_d043[225]});window.navigator&&window.navigator.msSaveOrOpenBlob?window.navigator.msSaveOrOpenBlob(b,
this.options.csvFileName+_$_d043[226]):(d=document.createElement(_$_d043[227]),b=URL.createObjectURL(b),d.href=b,d.setAttribute(_$_d043[228],this.options.csvFileName+_$_d043[226]),document.body.appendChild(d),d.click(),d.parentNode.removeChild(d))}else console.error(_$_d043[223])};h.standardize=function(d){d||(d=[]);Array.isArray(d)||(d=[d]);void 0==d[0]||Array.isArray(d[0])||typeof d[0]==_$_d043[103]||(d=[d]);for(var b=[],a=0;a<d.length;a++){var c={};Array.isArray(d[a])||void 0==d[a].data?c.data=
d[a]:c=d[a];c.row=void 0==d[a].row?a:d[a].row;b[c.row]=c}for(a=0;a<b.length;a++)d[a]=b[a]||{row:a,data:[]};return d};return h}(),Xa=function(){var h=function(d){d.getLabel=h[_$_d043[58]];d.getLabelFromCoords=h[_$_d043[58]]};h[_$_d043[58]]=function(d,b,a){if(typeof d==_$_d043[25]){d=F.getCoordsFromColumnName(d);var c=d[0];b=d[1]}else c=d;return this.getProcessed(c,b,a)};return h}(),Ia=function(){var h=function(d){d.getDefinedNames=h[_$_d043[58]];d.setDefinedNames=h[_$_d043[11]]};h[_$_d043[11]]=function(d){if(d.length)if(1!==
this.parent.edition)console.log(_$_d043[229]);else{for(var b=this.parent.config.definedNames,a,c=[],e=0;e<d.length;e++){var g=d[e].index.toUpperCase();a=b[g]?b[g]:null;d[e].value?(d[e].value=S(d[e].value),this.parent.config.definedNames[g]=d[e].value):b[g]&&delete this.parent.config.definedNames[g];c.push({index:g,value:d[e].value,oldValue:a})}R.call(this.parent,{worksheet:this,action:_$_d043[100],records:c});L.call(this,_$_d043[100],{data:c});G.call(this.parent,_$_d043[230],this,c)}};h[_$_d043[58]]=
function(d){var b=this.parent.config.definedNames;return d?b[d]:b};h.updateAll=function(d,b){if(!this.parent.ignoreHistory){this.parent.historyCascade=!0;var a,c=this.getWorksheetName();if(a=this.parent.config.definedNames){var e=[],g=Object.keys(a);if(g.length){for(var f=0;f<g.length;f++){var k=Z.update.call(this,a[g[f]],d,b,c);k!==a[g[f]]&&(-1!==k.indexOf(_$_d043[231])&&(k=null),e.push({index:g[f],value:k}))}e.length&&h[_$_d043[11]].call(this,e)}}this.parent.historyCascade=!1}};h.updateWorksheetName=
function(d,b){if(!this.parent.ignoreHistory){this.parent.historyCascade=!0;var a;if(a=this.parent.config.definedNames){var c=[],e=Object.keys(a);if(e.length){for(var g=0;g<e.length;g++){var f=Z.updateWorksheetName(a[e[g]],d,b);f!==a[e[g]]&&c.push({index:e[g],value:f})}c.length&&h[_$_d043[11]].call(this,c)}}this.parent.historyCascade=!1}};h.build=function(){var d=Object.keys(this.config.definedNames);if(d&&d.length)if(1!==this.edition)this.config.definedNames={},console.log(_$_d043[229]);else for(var b=
0;b<d.length;b++){var a=(_$_d043[3]+d[b]).toUpperCase(),c=S(this.config.definedNames[d[b]]);a!=d[b]&&delete this.config.definedNames[d[b]];this.config.definedNames[a]=c}};return h}(),ra=function(){var h=[_$_d043[232],_$_d043[233],_$_d043[234],_$_d043[235],_$_d043[236]],d=[_$_d043[237],_$_d043[177],_$_d043[238],_$_d043[239],_$_d043[240],_$_d043[241],_$_d043[1],_$_d043[242],_$_d043[37],_$_d043[243],_$_d043[18],_$_d043[15],_$_d043[17],_$_d043[244]],b=[],a=function(){if(0<b.length){for(var f,k=0;k<b.length;k++)f=
-1===b[k].indexOf(_$_d043[19])?this:J(b[k].split(_$_d043[19])[0]),ba.destroy.call(f,b[k]);b=[]}},c=function(f){a.call(this);for(var k=0,l=[],n,q,p,v=0;v<f.children.length;v++)if(n=f.children[v].getAttribute(_$_d043[245])){l[n]||(l[n]=h[k++],4<k&&(k=0));f.children[v].style.color=l[n];-1===n.indexOf(_$_d043[19])?(q=this,p=n):(q=n.split(_$_d043[19]),p=q[1],q=J(q[0]));if(0<=p.indexOf(_$_d043[157])){var w=p.split(_$_d043[157]);p=F.getCoordsFromColumnName(w[0]);w=F.getCoordsFromColumnName(w[1])}else w=
p=F.getCoordsFromColumnName(p);ka[_$_d043[11]].call(q,p[0],p[1],w[0],w[1],null,n,l[n]);b.push(n)}},e=function(f){this.worksheet&&(a.call(this.worksheet),typeof this.onchange==_$_d043[104]&&this.onchange.call(this,this.innerText,f),this.worksheet=null)},g=function(f,k){k&&typeof k!=_$_d043[104]||(k={type:_$_d043[246],onchange:k});k.type===_$_d043[246]?(f.classList.add(_$_d043[247]),f.addEventListener(_$_d043[248],function(l){l=l.changedTouches&&l.changedTouches[0]?l.changedTouches[0].clientX:l.clientX;
var n=this.getBoundingClientRect();24>n.width-(l-n.left)&&(g.current=f,f.classList.add(_$_d043[249]),f.classList.add(_$_d043[114]))})):(f.addEventListener(_$_d043[250],function(l){aa(f.innerText)&&(f.classList.add(_$_d043[114]),u.current&&setTimeout(function(){f.worksheet=u.current;g.parse.call(u.current,f);var n=document.createTextNode(_$_d043[3]);f.appendChild(n);jSuites.focus(f)}))}),f.addEventListener(_$_d043[251],function(l){aa(f.innerText)?f.classList.add(_$_d043[114]):f.classList.contains(_$_d043[114])&&
(f.classList.remove(_$_d043[114]),f.worksheet&&a.call(f.worksheet));l.preventDefault()}),f.addEventListener(_$_d043[109],function(l){27==l.which&&(f.innerText=_$_d043[3],e.call(f,!1))}));f.classList.add(_$_d043[252]);f.classList.add(_$_d043[251]);f.setAttribute(_$_d043[253],!0);f.addEventListener(_$_d043[254],function(l){e.call(f,!0)});f.val=function(l){if(void 0===l)return f.innerText;f.innerText=l};k.onchange&&(f.onchange=k.onchange);k.onupdate&&(f.onupdate=k.onupdate)};g.current=null;g.parse=function(f){for(var k=
_$_d043[3],l=_$_d043[3],n=window.getSelection(),q=document.createRange(),p=F.getCaretIndex.call(this.parent,f),v=Z.tokenize(f.innerText.replace(/(\r\n|\n|\r)/gm,_$_d043[3])),w=0;w<v.length;w++)v[w]&&Z.tokenIdentifier.test(v[w].trim())?(w==v.length-1&&(l=_$_d043[255]),k+=_$_d043[256]+l+_$_d043[257]+v[w].trim().replace(/\$/g,_$_d043[3])+_$_d043[258]+v[w]+_$_d043[259]):k+=v[w];f.innerHTML=k;k=null;for(w=0;w<f.childNodes.length&&!(k=f.childNodes[w],l=k.tagName?k.innerText.length:k.length,0>=p-l);w++)p-=
l;k&&(k.tagName?q.setStart(k.firstChild,p):(p>k.length&&(p=k.length),q.setStart(k,p)),n.removeAllRanges(),n.addRange(q));c.call(this,f)};g.close=function(f){a.call(this);f?f.classList.remove(_$_d043[114]):g.current&&(typeof g.current.onchange==_$_d043[104]&&g.current.onchange.call(g.current),g.current.classList.remove(_$_d043[249]),g.current.classList.remove(_$_d043[114]),g.current.worksheet=null,g.current=null)};g.getName=function(f,k,l,n,q){f=F.getColumnNameFromCoords(f,k);l=F.getColumnNameFromCoords(l,
n);q.ctrlKey&&(f=l);return f!==l?(q=f+_$_d043[157]+l,q=Z.getTokensFromRange.call(this,q),Z.getRangeFromTokens.call(this,q)):f};g.range=function(f,k,l,n,q){g.current.getAttribute(_$_d043[260])==_$_d043[261]&&(f=l,k=n);f=g.getName.call(this,f,k,l,n,q);k=document.createElement(_$_d043[262]);k.innerText=f;k.setAttribute(_$_d043[245],f);g.current.innerText=_$_d043[3];g.current.appendChild(k);c.call(this,g.current);jSuites.focus(k);q.preventDefault()};g.update=function(f,k,l,n,q,p,v){p.getAttribute(_$_d043[260])==
_$_d043[261]&&(f=l,k=n);var w=jSuites.getNode();if(w){var x=g.getName.call(this,f,k,l,n,q);this!==v&&(x=v.getWorksheetName()+_$_d043[19]+x);f=function(y){var A=document.createElement(_$_d043[262]);A.innerText=x;A.setAttribute(_$_d043[245],x);w.parentNode===p&&!1===y?w.parentNode.insertBefore(A,w.nextSibling):p.appendChild(A);w=A};if(w.getAttribute(_$_d043[245]))q.ctrlKey?(p.appendChild(document.createTextNode(_$_d043[37])),f(!0)):(w.innerText=x,w.setAttribute(_$_d043[245],x));else{if(!w.innerText||
w.innerText!==_$_d043[3]&&-1==d.indexOf(w.innerText.slice(-1))||w.nextElementSibling&&w.nextElementSibling.getAttribute(_$_d043[245]))return!1;f(!1)}jSuites.focus(w);c.call(this,p);q.preventDefault();typeof p.onupdate==_$_d043[104]&&p.onupdate.call(p,p.innerText);return!0}return!1};g.onkeydown=function(f){f.target.worksheet=this;if(f.ctrlKey){if(67==f.which||88==f.which)f=window.getSelection().toString().replace(/(\r\n|\n|\r)/gm,_$_d043[3]),navigator.clipboard?navigator.clipboard.writeText(f):(this.parent.textarea.value=
f,this.parent.textarea.select(),document.execCommand(_$_d043[218]))}else if(36==f.which){var k=window.getSelection(),l=document.createRange();l.setStart(f.target,0);k.removeAllRanges();k.addRange(l)}else 35==f.which?jSuites.focus(f.target):187==f.which?!f.target.innerText.replace(/(\r\n|\n|\r)/gm,_$_d043[3])&&f.target.getAttribute(_$_d043[116])&&f.target.removeAttribute(_$_d043[116]):13==f.which&&f.target.blur()};g.palette=function(f){h=f};return g}(),Z=function(){var h=new RegExp(/^(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]+)(:\$?[A-Z]+\$?[0-9]+)?$/i),
d=function(f){f=S(f);for(var k=_$_d043[3],l=[],n=0,q=0;q<f.length;q++){if(f[q]==_$_d043[20]||f[q]==_$_d043[155])n=0==n?1:0;var p;if(p=0==n)p=f[q],(p=p==_$_d043[237]||p==_$_d043[177]||p==_$_d043[238]||p==_$_d043[239]||p==_$_d043[240]||p==_$_d043[12])||(p=f[q],p=p==_$_d043[241]||p==_$_d043[263]||p==_$_d043[1]||p==_$_d043[2]||p==_$_d043[242]||p==_$_d043[264]||p==_$_d043[37]||p==_$_d043[243]||p==_$_d043[18]||p==_$_d043[15]||p==_$_d043[17]||p==_$_d043[244]);p?(k&&(l.push(k),k=_$_d043[3]),l.push(f[q])):
k+=f[q]}k&&l.push(k);for(q=0;q<l.length;q++)0==n&&(l[q]=l[q].trim());return l},b=function(f){f.setFormula=b[_$_d043[11]];f.updateFormula=b.update;f.executeFormula=b.execute;f.resetArray=b.resetArray;f.formula=[]};b.run=function(f,k){var l=_$_d043[3],n=Object.keys(k);if(n.length){for(var q={},p=0;p<n.length;p++){var v=n[p].replace(/!/g,_$_d043[39]);0<v.indexOf(_$_d043[39])&&(v=v.split(_$_d043[39]),q[v[0]]=!0)}v=Object.keys(q);for(p=0;p<v.length;p++)l+=_$_d043[265]+v[p]+_$_d043[266];for(p=0;p<n.length;p++)v=
n[p].replace(/!/g,_$_d043[39]),null===k[n[p]]||jSuites.isNumeric(k[n[p]])||(q=k[n[p]].match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g))&&q.length&&(k[n[p]]=c(q,k[n[p]])),l=0<v.indexOf(_$_d043[39])?l+(v+_$_d043[267]+k[n[p]]+_$_d043[268]):l+(_$_d043[265]+v+_$_d043[267]+k[n[p]]+_$_d043[268])}f=f.replace(/\$/g,_$_d043[3]);(q=f.match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g))&&q.length&&(f=c(q,f));f=f.replace(/!/g,_$_d043[39]);f=(new Function(l+_$_d043[269]+
f))();null===f&&(f=0);return f};b[_$_d043[11]]=function(){};var a=function(f){f=S(f,!0);return f.replace(/\$/g,_$_d043[3])},c=function(f,k){for(var l=0;l<f.length;l++){var n=b.getTokensFromRange.call(this,f[l]);k=k.replace(f[l],_$_d043[242]+n.join(_$_d043[37])+_$_d043[264])}return k},e=function(f,k,l){var n=this.config.definedNames;if(n&&0<Object.keys(n).length){for(var q=0;q<f.length;q++)f[q]&&n&&n[f[q]]&&(k=k.replace(f[q],n[f[q]]),l&&(l[f[q]]=n[f[q]]));return a(k)}return k};b.resetArray=function(f,
k){var l;if(l=this.records[k][f].a){for(var n=0;n<l.length;n++)for(var q=0;q<l[n].length;q++)this.options.data[k+n][f+q]||(this.records[k+n][f+q].v=_$_d043[3],this.records[k+n][f+q].element&&(this.records[k+n][f+q].element.innerText=_$_d043[3]));this.records[k][f].a=null}};b.execute=function(f,k,l,n,q){if(1==this.parent.processing)return null!==k&&null!==l&&this.parent.queue.push([this,k,l]),_$_d043[3];if(typeof this.parent.config.onbeforeformula==_$_d043[104]){var p=G.call(this.parent,_$_d043[270],
this,f,k,l);if(!1===p)return f;p&&(f=p)}var v=[],w=function(C,D,M,T){if(void 0!=D&&void 0!=M){var U=F.getColumnNameFromCoords(D,M);D=T.getWorksheetName()+_$_d043[39]+U;v[D]||(v[D]=0);v[D]++;if(3<v[D])throw{error:_$_d043[271],message:_$_d043[272],reference:D};}else D=U=null;q||(C=a(C));var K=C,X=K.match(/[A-Z_]+[A-Z0-9_\.]*/g);X&&X.length&&(K=e.call(T.parent,X,K,x));(X=K.match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g))&&X.length&&(K=c.call(T,X,K));X=[];K=d(K);for(var Y=0;Y<K.length;Y++)K[Y]&&
h.test(K[Y])&&X.push(K[Y]);if(X){if(D&&-1<X.indexOf(D.replace(_$_d043[39],_$_d043[19])))throw{error:_$_d043[273],message:_$_d043[274]};for(K=0;K<X.length;K++){D=X[K].split(_$_d043[19]);D[1]?(M=D[1],Y=J(D[0]),D=T.getWorksheetName()+_$_d043[39]+U):(M=D[0],Y=T,D=U);if(typeof Y==_$_d043[21]||typeof Y.formula==_$_d043[21])throw{error:_$_d043[275],message:_$_d043[276]};D&&(Y.formula[M]||(Y.formula[M]=[]),0>Y.formula[M].indexOf(D)&&Y.formula[M].push(D));if(!x[X[K]]){M=F.getCoordsFromColumnName(M);D=M[0];
M=M[1];var V=Y.records[M]&&void 0!==Y.records[M][D].v?Y.records[M][D].v:O.call(Y,D,M);x[X[K]]||(aa(V)?x[X[K]]=w(V,D,M,Y):(V===_$_d043[3]||null===V||void 0===V?V=null:jSuites.isNumeric(V)||(V=_$_d043[20]+V+_$_d043[20]),x[X[K]]=V))}}}return C.substr(1)},x={};try{f=w(f,k,l,this);if(f==_$_d043[3])return _$_d043[3];0==f.indexOf(_$_d043[277])&&(q=!0);var y=q?b.run(f,x):u.formula(f,x,k,l,this);if(!1!==n&&void 0!=k&&void 0!=l)if(y instanceof Date)this.records[l][k].v=jSuites.calendar.dateToNum(y);else if(Array.isArray(y)){n=
[];p=null;for(var A=0;A<y.length;A++)for(var z=0;z<y[A].length;z++){(0<z||0<A)&&this.options.data[l+A][k+z]!==_$_d043[3]&&(p=_$_d043[278]);var I=F.getColumnNameFromCoords(k+z,l+A);n.push(I)}if(!p){I=F.getColumnNameFromCoords(k,l);var r=Object.keys(this.formula);for(A=0;A<r.length;A++){var B=this.formula[r[A]].indexOf(I);if(0<=B)for(z=0;z<n.length;z++)B=this.formula[r[A]].indexOf(n[z]),-1==B&&this.formula[r[A]].push(n[z])}for(A=0;A<y.length;A++)for(z=0;z<y[A].length;z++)this.records[l+A][k+z].v=y[A][z],
this.records[l+A][k+z].element&&(this.records[l+A][k+z].element.innerText=y[A][z],jSuites.isNumeric(y[A][z])?this.records[l+A][k+z].element.classList.add(_$_d043[279]):this.records[l+A][k+z].element.classList.remove(_$_d043[279]));this.records[l][k].a=y;p=y[0][0];this.records[l][k].v=p}y=p}else this.records[l][k].v=y;return y}catch(C){return 1==this.parent.config.debugFormulas&&console.log(f,x,C),C&&C.error?C.error:_$_d043[275]}};b.update=function(f,k,l,n){var q=null,p=null,v=this.getWorksheetName(),
w=function(I){l&&l[I]&&(I=_$_d043[231]);k[I]&&(I=k[I]);return I},x=function(I,r){r=r.split(_$_d043[280]);if(3===r.length){r=_$_d043[280];var B=_$_d043[280]}else r[0]===_$_d043[3]?(r=_$_d043[280],B=_$_d043[3]):(r=_$_d043[3],B=_$_d043[280]);return r+I.match(/[A-Z]+/g)+B+I.match(/[0-9]+/g)};f=S(f,!0);f=d(f);for(var y=0;y<f.length;y++)if(f[y]&&h.test(f[y])){if(-1==f[y].indexOf(_$_d043[19])){if(p=f[y],q=_$_d043[3],n&&n!=v)continue}else if(p=f[y].split(_$_d043[19]),q=p[0],p=p[1],n&&n!=q)continue;var A=
p;if(0<=p.indexOf(_$_d043[157])){p=b.getTokensFromRange.call(this,p);for(var z=0;z<p.length;z++)p[z]=w(p[z]);p=b.getRangeFromTokens.call(this,p);p!==_$_d043[231]&&-1!==A.indexOf(_$_d043[280])&&(A=A.split(_$_d043[157]),p=p.split(_$_d043[157]),p=x(p[0],A[0])+_$_d043[157]+x(p[1],A[1]))}else-1!==A.indexOf(_$_d043[280])?(p=w(p.replace(/\$/g,_$_d043[3])),p=x(p,A)):p=w(p);q&&(p=q+_$_d043[19]+p);f[y]=p}return f.join(_$_d043[3])};b.getChain=function(f){if(void 0===f)return[];var k=[],l=[],n=[],q=function(w){if(0<=
w.indexOf(_$_d043[39])){var x=w.split(_$_d043[39]),y=x.pop(),A=x.join(_$_d043[39]);x=J(A)}else x=this,A=x.getWorksheetName(),y=w;if(x.formula[y]&&!n[w]){var z=!1;n[w]=!0;for(w=0;w<x.formula[y].length;w++){var I=x.formula[y][w];-1==I.indexOf(_$_d043[39])&&(I=A+_$_d043[39]+I);if(!l[I]){var r=x.getValue(I);aa(r)?k.push([I,r,b.getTokens.call(x,r,A)]):(z=!0,x.formula[y][w]=null);q.call(x,I);l[I]=!0}}1==z&&(x.formula[y]=x.formula[y].filter(function(B){return null!=B}))}},p=Object.keys(f);for(f=0;f<p.length;f++)q.call(this,
p[f]);p=0;for(f=k.length-1;0<=f;f--){for(var v=0;v<f;v++)if(0<=k[v][2].indexOf(k[f][0])){k.splice(v,0,k.splice(f,1)[0]);f=k.length;break}p++;if(1E6<p){console.error(_$_d043[281]);break}}l=[];for(f=0;f<k.length;f++)l[k[f][0]]=k[f][1];return l};b.updateAll=function(f,k){var l,n,q,p,v,w={},x=this.getWorksheetName();for(v=0;v<u.spreadsheet.length;v++){var y=u.spreadsheet[v].worksheets;for(q=0;q<y.length;q++){var A=y[q].getWorksheetName();for(n=0;n<y[q].options.data.length;n++)for(l=0;l<y[q].options.data[n].length;l++)if((p=
y[q].options.data[n][l])&&aa(p)){var z=b.update.call(y[q],p,f,k,x);z!=p&&(w[A]||(w[A]=[]),w[A].push({x:l,y:n,value:z,force:!0}))}}}y=Object.keys(w);for(l=0;l<y.length;l++)if(w[y[l]].length){q=J(y[l]);for(n=0;n<w[y[l]].length;n++)O.call(q,w[y[l]][n].x,w[y[l]][n].y,w[y[l]][n].value);L.call(q,_$_d043[129],{data:w[y[l]]})}w=[];l=Object.keys(this.formula);y=[];n=[];for(q=0;q<l.length;q++)if(z=l[q],p=this.formula[z],k&&k[z])for(v=0;v<p.length;v++)f[p[v]]&&(p[v]=f[p[v]]),n[p[v]]=!0;else{A=[];for(v=0;v<p.length;v++)k&&
k[p[v]]||(f[p[v]]&&(p[v]=f[p[v]]),n[p[v]]=!0,A.push(p[v]));A.length&&(f[z]&&(z=f[z]),y[z]=A)}this.formula=y;A=this.getWorksheetName();for(var I=0;I<u.spreadsheet.length;I++)for(var r=u.spreadsheet[I].worksheets,B=0;B<r.length;B++)if(r[B].getWorksheetName()!==A)for(l=Object.keys(r[B].formula),q=0;q<l.length;q++){y=[];p=r[B].formula[l[q]];for(v=0;v<p.length;v++)z=p[v].split(_$_d043[39]),z[0]==A&&z[1]?k&&k[z[1]]||(f[z[1]]&&(z[1]=f[z[1]]),y.push(z[0]+_$_d043[39]+z[1])):y.push(p[v]);r[B].formula[l[q]]=
y}y=Object.keys(n);for(l=0;l<y.length;l++)z=y[l].split(_$_d043[39]),z[1]?(p=z[1],f=J(z[0]),k=z[0]):(p=z[0],f=this,k=x),z=F.getCoordsFromColumnName(p),n=z[0],q=z[1],p=f.options.data[q][n],z=Z.execute.call(f,p,n,q,!1),z!==f.records[q][n].v&&(w[k]||(w[k]=[]),w[k].push({x:n,y:q,value:p,force:!0}));y=Object.keys(w);if(y.length)for(l=0;l<y.length;l++)q=J(y[l]),w[y[l]]=oa.applyValues.call(q,w[y[l]]),oa.setValueChained.call(q,w[y[l]])};b.updateWorksheetName=function(f,k,l){for(var n=d(f),q=0;q<n.length;q++)f=
n[q].split(_$_d043[19]),f[1]&&(f[0]=f[0].replace(new RegExp(_$_d043[155],_$_d043[14]),_$_d043[3]),f[0].toUpperCase()==k.toUpperCase()&&(f[0]=l,0<=f[0].indexOf(_$_d043[154])&&(f[0]=_$_d043[155]+f[0]+_$_d043[155]),n[q]=f.join(_$_d043[19])));return n.join(_$_d043[3])};b.updateWorksheetNames=function(f,k){var l,n;for(n=0;n<u.spreadsheet.length;n++){var q=u.spreadsheet[n].worksheets;for(var p=0;p<q.length;p++){var v=[];for(var w=0;w<q[p].options.data.length;w++)for(var x=0;x<q[p].options.data[w].length;x++)if((l=
q[p].options.data[w][x])&&aa(l)){var y=b.updateWorksheetName(l,f,k);y!=l&&(v.push({x,y:w,value:y,force:!0}),O.call(q[p],x,w,y))}v.length&&L.call(q[p],_$_d043[129],{data:v})}}};var g=function(f,k,l){var n=_$_d043[3],q=_$_d043[3],p=f.split(_$_d043[280]);if(3===p.length)return f;2===p.length&&(p[0]?(l=0,q=_$_d043[280]):(k=0,n=_$_d043[280]),f=p.join(_$_d043[3]));f=F.getCoordsFromColumnName(f);k=f[0]+k;f=f[1]+l;return f=0>k||0>f?_$_d043[231]:n+F.getColumnName(k)+q+(f+1)};b.shiftFormula=function(f,k,l){f=
d(f,!0);for(var n,q,p=0;p<f.length;p++)h.test(f[p])&&(q=-1==f[p].indexOf(_$_d043[19])?[_$_d043[3],f[p]]:f[p].split(_$_d043[19]),-1==q[1].indexOf(_$_d043[157])?q[1]=g(q[1],k,l):(n=q[1].split(_$_d043[157]),q[1]=g(n[0],k,l)+_$_d043[157]+g(n[1],k,l)),f[p]=q[0]?q.join(_$_d043[19]):q[1]);return f.join(_$_d043[3])};b.getTokensFromRange=function(f){var k=this,l=_$_d043[3],n=_$_d043[3];0<=f.indexOf(_$_d043[19])?n=_$_d043[19]:0<=f.indexOf(_$_d043[39])&&(n=_$_d043[39]);f=f.replace(/\$/g,_$_d043[3]);n&&(l=f.split(n),
f=l.pop(),l=l.join(_$_d043[39]),k=J(l),l+=n);if(-1==f.indexOf(_$_d043[157]))return[l+f];n=[];f=f.split(_$_d043[157]);var q=F.getCoordsFromColumnName(f[0]),p=F.getCoordsFromColumnName(f[1]);if(q[0]<=p[0]){f=q[0];var v=p[0]}else f=p[0],v=q[0];if(null===q[1]&&null==p[1]){var w=0;q=0;k.options&&k.options.data&&(q=k.options.data.length-1)}else q[1]<=p[1]?(w=q[1],q=p[1]):(w=p[1],q=q[1]);for(k=w;k<=q;k++)for(w=f;w<=v;w++)n.push(l+F.getColumnNameFromCoords(w,k));return n};b.getRangeFromTokens=function(f){f=
f.filter(function(n){return n!=_$_d043[231]});for(var k=_$_d043[3],l=0;l<f.length;l++)0<=f[l].indexOf(_$_d043[19])?(k=f[l].split(_$_d043[19]),f[l]=k.pop(),k=k[0]+_$_d043[19]):0<=f[l].indexOf(_$_d043[39])&&(k=f[l].split(_$_d043[39]),f[l]=k.pop(),k=k.join(_$_d043[39])+_$_d043[39]);f.sort(function(n,q){n=F.getCoordsFromColumnName(n);q=F.getCoordsFromColumnName(q);return n[1]>q[1]?1:n[1]<q[1]?-1:n[0]>q[0]?1:n[0]<q[0]?-1:0});return f.length?k+(f[0]+_$_d043[157]+f[f.length-1]):_$_d043[231]};b.getTokens=
function(f,k){var l=a(f);f.replace(/!/g,_$_d043[39]);(f=l.match(/[A-Z_]+[A-Z0-9_\.]*/g))&&f.length&&(l=e.call(this.parent,f,l));(f=l.match(/('.*?'?|\w*\.)?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g))&&f.length&&(l=c.call(this,f,l));if(f=l.match(/('.*?'?|\w*\.)?(\$?[A-Z]+\$?[0-9]+)(:\$?[A-Z]+\$?[0-9]+)?/g))for(l=0;l<f.length;l++)-1==f[l].indexOf(_$_d043[39])&&k&&(f[l]=k+_$_d043[39]+f[l]);return f};b.tokenIdentifier=h;b.tokenize=d;return b}(),oa=function(){var h=function(d){d.name=qa;d.value=O;d.getValue=
h[_$_d043[58]];d.getValueFromCoords=h.getFromCoords;d.setValue=h[_$_d043[11]];d.setValueFromCoords=h.setFromCoords;d.setCheckRadioValue=h.setCheckRadio;d.getProcessed=h.processed};h[_$_d043[58]]=function(d,b){var a=this;if(typeof d==_$_d043[103]){var c=d.x;d=d.y}else 0<=d.indexOf(_$_d043[39])&&(a=d.split(_$_d043[39]),d=a.pop(),a=J(a.join(_$_d043[39]))),d=F.getCoordsFromColumnName(d),c=d[0],d=d[1];return h.getFromCoords.call(a,c,d,b)};h.getFromCoords=function(d,b,a){var c=null;null!=d&&null!=b&&(c=
a?h.processed.call(this,d,b):O.call(this,d,b));return c};h[_$_d043[11]]=function(d,b,a){if(!P.call(this.parent,this))return!1;var c=null,e=null,g=null,f=[];a=a?!0:!1;var k=function(q,p){var v=null;typeof q==_$_d043[25]?(g=F.getCoordsFromColumnName(q),c=g[0],e=g[1]):q.tagName?(c=q.getAttribute(_$_d043[56]),e=q.getAttribute(_$_d043[57])):q.element&&q.element.tagName?(c=q.element.getAttribute(_$_d043[56]),e=q.element.getAttribute(_$_d043[57])):(c=q.x,e=q.y,void 0!==q.value&&(p=q.value),void 0!==q.style&&
(v=q.style));q={x:c,y:e,value:p,force:a};null!==v&&(q.style=v);f.push(q)};if(d&&Array.isArray(d))for(var l=0;l<d.length;l++)k(d[l],b);else if(typeof d==_$_d043[103]&&void 0==d.x&&void 0==d.tagName)for(b=Object.keys(d),l=0;l<b.length;l++)k(b[l],d[b[l]]);else k(d,b);if(f.length){f=h.applyValues.call(this,f);this.parent.config.parseFormulas&&h.setValueChained.call(this,f);this.refreshBorders();var n=this;setTimeout(function(){ba.refresh.call(n)},250);if(f.length){R.call(this.parent,{worksheet:n,action:_$_d043[95],
records:f,selection:this.selectedCell});d=this.getPrimaryKey();if(!1!==d)for(l=0;l<f.length;l++)f[l].x===d&&f[l].value&&W.call(this,f[l]);L.call(this,_$_d043[95],{data:f});ea.update.call(this,!0);G.call(this.parent,_$_d043[282],this,f)}}};h.setFromCoords=function(d,b,a,c){var e=[];e.push({x:d,y:b,value:a});h[_$_d043[11]].call(this,e,null,c)};h.setCheckRadio=function(){for(var d=[],b=this.getSelected(),a=0;a<b.length;a++){var c=b[a].x,e=b[a].y;if(!this.options.columns[c].readOnly&&this.options.columns[c].type==
_$_d043[283]){var g=O.call(this,c,e)?!1:!0;d.push({x:c,y:e,value:g})}}d.length&&h[_$_d043[11]].call(this,d)};h.applyValues=function(d){for(var b,a,c=this.options.style||{},e=[],g={},f=0;f<d.length;f++)if(b=d[f],a=this.updateCell(b.x,b.y,b.value,b.force),void 0!==a.value){if(void 0!==b.style){var k=F.getColumnNameFromCoords(b.x,b.y);a.style=g[k]=b.style;a.oldStyle=c&&c[k]?c[k]:_$_d043[219]}e.push(a)}0<Object.keys(g).length&&La.update.call(this,g);return e};h.processed=function(d,b,a){var c=O.call(this,
d,b);if(null===c)return null;var e=na[_$_d043[58]].call(this,d,b),g=e[1];g.type!=_$_d043[112]&&g.type!=_$_d043[284]&&g.type!=_$_d043[285]&&g.type!=_$_d043[286]&&g.type!=_$_d043[287]&&0!=g.process&&(!0===a||g.type!=_$_d043[288]&&g.type!=_$_d043[289]&&g.type!=_$_d043[290])&&(g.type==_$_d043[283]?c=e[0][_$_d043[58]](g,c,a):this.records[b][d].element?c=1==this.parent.config.stripHTML?this.records[b][d].element.innerText:this.records[b][d].element.innerHTML:((_$_d043[3]+c).substr(0,1)==_$_d043[18]&&(c=
this.executeFormula(c,d,b,!1)),e[0]&&typeof e[0][_$_d043[58]]==_$_d043[104]&&(c=e[0][_$_d043[58]](g,c,a))));return c};h.setValueChained=function(d){for(var b,a=[],c,e=0;e<d.length;e++)b=d[e],c=F.getColumnNameFromCoords(b.x,b.y),a[c]=b.value;a=Z.getChain.call(this,a);var g=[],f=Object.keys(a);for(e=0;e<f.length;e++)0<=f[e].indexOf(_$_d043[39])?(b=f[e].split(_$_d043[39]),c=b.pop(),b=J(b.join(_$_d043[39]))):(c=f[e],b=this),c=F.getCoordsFromColumnName(c),d=Q.update.call(b,c[0],c[1],a[f[e]],!0),d.w=b,
d.value=d.v=b.records[c[1]][c[0]].v,d.cell=f[e],d.f=a[f[e]],g.push(d);g.length&&G.call(this.parent,_$_d043[291],this,g)};return h}(),Q=function(){var h=function(d){d.getCell=h[_$_d043[58]];d.getCellFromCoords=h[_$_d043[58]];d.updateCell=h.update;d.updateCells=h.updateAll;d.getSelected=h.selected;d.isAttached=h.attached};h.attached=function(d,b){return this.records[b]&&this.records[b][d]&&this.records[b][d].element&&this.records[b][d].element.parentNode&&this.records[b][d].element.parentNode.parentNode?
!0:!1};h[_$_d043[58]]=function(d,b){typeof d==_$_d043[25]&&(b=F.getCoordsFromColumnName(d),d=b[0],b=b[1]);d=parseInt(d);b=parseInt(b);if(this.records[b]&&this.records[b][d]&&this.records[b][d].element)return this.records[b][d].element;var a=O.call(this,d,b);null===a&&(a=_$_d043[3]);return Q.create.call(this,d,b,a)};h.getFromCoords=function(d,b,a){if(!d||null===d[0])return null;var c=[],e=d[0],g=d[1],f=d[2];d=d[3];for(a&&(a=this.results?F.invert(this.results):null);g<=d;g++)for(var k=e;k<=f;k++)if(!a||
a[g])b?c.push(F.getColumnNameFromCoords(k,g)):c.push(this.records[g][k]);return c};h.selected=function(d,b){return h.getFromCoords.call(this,this.getHighlighted(),d,b)};h.getSelectedColumns=function(){var d=[],b=this.getHighlighted();if(b)for(var a=b[0];a<=b[2];a++)d.push(a);return d};h.updateAll=function(d){for(var b=this.getPrimaryKey(),a=[],c=0;c<d.length;c++)void 0!==d[c].id?(W.call(this,d[c]),a.push({id:d[c].id,y:d[c].y}),!1!==b&&h.update.call(this,b,d[c].y,d[c].id,!0)):a.push(h.update.call(this,
d[c].x,d[c].y,d[c].value,d[c].force));L.call(this,_$_d043[128],[a])};h.update=function(d,b,a,c){var e=this.records[b];if(e=e&&e[d]?e[d]:null){e=e.element;var g={x:d,y:b};if(c||!e||1!=e.classList.contains(_$_d043[26])){if(c=G.call(this.parent,_$_d043[292],this,e,d,b,a))a=c;else if(!1===c)return g;c=na[_$_d043[58]].call(this,d,b);if(typeof c[0].updateCell==_$_d043[104]){var f=c[0].updateCell(e,a,d,b,this,c[1]);void 0!==f&&(a=f)}f=O.call(this,d,b);if(f!==a){var k=O.call(this,d,b,a);g.oldValue=f;g.value=
k;e&&h.applyOverflow.call(this,e,d,b);c[1]&&typeof c[1].render==_$_d043[104]&&c[1].render(e,a,d,b,this,c[1]);G.call(this.parent,_$_d043[293],this,e,d,b,g.value,g.oldValue)}}}else return!1;return g};h.create=function(d,b,a){var c=document.createElement(_$_d043[173]);c.setAttribute(_$_d043[56],d);c.setAttribute(_$_d043[57],b);var e=na[_$_d043[58]].call(this,d,b);if(e[0]&&typeof e[0].createCell==_$_d043[104]){var g=e[0].createCell(c,a,d,b,this,e[1]);void 0!==g&&(a=g)}O.call(this,d,b,a);this.records[b][d]||
ta.cell.call(this,d,b,a);this.records[b][d].element=c;!a&&this.records[b][d].v&&(c.innerText=this.records[b][d].v);e[1]&&typeof e[1].render==_$_d043[104]&&e[1].render(c,a,d,b,this,e[1]);h.applyProperties.call(this,c,d,b);h.applyOverflow.call(this,c,d,b);G.call(this.parent,_$_d043[294],this,c,d,b,a);return c};h.getAttributes=function(d,b,a){a[d]||(a[d]={});d==_$_d043[295]?a[d][b]=this.getValue(b):d==_$_d043[296]?this.merged.cells&&(b=this.merged.cells[b])&&(a[d][b]=this.options.mergeCells[b]):this.options[d]&&
this.options[d][b]&&(a[d][b]=this.options[d][b])};h.setAttributes=function(d){d&&d.style&&this.setStyle(d.style);d&&d.comments&&this.setComments(d.comments);d&&d.meta&&this.setMeta(d.meta);d&&d.cells&&this.setProperty(d.cells);d&&d.mergeCells&&this.setMerge(d.mergeCells);d&&d.values&&h.batch.call(this,d.values);d&&d.formulas&&h.batch.call(this,d.formulas,!0)};h.applyProperties=function(d,b,a){var c=F.getColumnNameFromCoords(b,a),e=this.options.columns,g=this.options.style,f=this.options.comments,
k=this.options.cells,l=this.options.rows,n=null,q=!1;e[b]&&(e[b].readonly||e[b].readOnly)&&(q=!0);l&&l[a]&&(l[a].readonly||l[a].readOnly)&&(q=!0);if(g&&g[c]){var p=(p=d.getAttribute(_$_d043[120]))?p+(_$_d043[244]+g[c]):g[c];d.setAttribute(_$_d043[120],p)}f&&f[c]&&(typeof f[c]===_$_d043[25]?d.setAttribute(_$_d043[297],f[c]):d.classList.add(_$_d043[298]));if(k&&k[c])if(!1===k[c].locked&&!0===this.options.selectUnLockedCells?d.classList.add(_$_d043[299]):d.classList.remove(_$_d043[299]),k[c].zebra?d.classList.add(_$_d043[300]):
d.classList.remove(_$_d043[300]),typeof k[c].wrap!==_$_d043[21]&&((n=k[c].wrap)?d.classList.add(_$_d043[301]):d.classList.remove(_$_d043[301])),!0===k[c].readonly||!0===k[c].readOnly)q=!0;else if(!1===k[c].readonly||!1===k[c].readOnly)q=!1;null===n&&(e[b]&&e[b].wrap?d.classList.add(_$_d043[301]):d.classList.remove(_$_d043[301]));d.style.textAlign||(g=null,k&&k[c]&&k[c].align?g=k[c].align:e&&e[b].align&&(g=e[b].align),g&&(d.style.textAlign=g));q?d.classList.add(_$_d043[26]):d.classList.remove(_$_d043[26]);
this.records[a][b].readonly=q};h.applyOverflow=function(d,b,a){1==this.options.textOverflow&&0<b&&(b==this.options.columns.length-1&&(d.style.overflow=_$_d043[112]),this.records[a][b-1]&&this.records[a][b-1].element&&(this.records[a][b-1].element.style.overflow=this.options.data[a][b]==_$_d043[3]&&this.headers[b-1]&&this.headers[b-1].offsetWidth?_$_d043[3]:_$_d043[112]))};h.batch=function(d,b){var a=[],c=Object.keys(d);if(c.length)for(var e=0;e<c.length;e++){if(0<=c[e].indexOf(_$_d043[39])){var g=
c[e].split(_$_d043[39]);var f=J(g[0]);var k=g[1];g=g[0]}else f=this,k=c[e],g=this.getWorksheetName();k=F.getCoordsFromColumnName(k);k=f.updateCell(k[0],k[1],d[c[e]],!0);a[g]||(a[g]=[]);a[g].push(k)}if(1==b&&(c=Object.keys(a),c.length))for(e=0;e<c.length;e++)f=J(c[e]),L.call(f,_$_d043[129],a[c[e]])};return h}(),Ka=function(){var h=function(b){b.getColumnOptions=h[_$_d043[58]];b.setColumnOptions=h[_$_d043[11]];b.getCells=h.getCells;b.setCells=h.setCells;b.getProperties=h[_$_d043[58]];b.setProperties=
h[_$_d043[11]];b.getProperty=h[_$_d043[58]];b.setProperty=h[_$_d043[11]];b.resetProperty=h[_$_d043[11]];b.updateProperty=h.update;b.getOptions=h[_$_d043[58]]};h.getCells=function(b){return b?this.options.cells[b]:this.options.cells};h.setCells=function(b,a){if(!P.call(this.parent,this))return!1;if(typeof b==_$_d043[25])this.options.cells[b]=a;else{a=Object.keys(b);for(var c=0;c<a.length;c++)this.options.cells[a[c]]=b[a[c]]}};h[_$_d043[58]]=function(b,a){var c=null;void 0!==a&&(a=F.getColumnNameFromCoords(b,
a),this.options.cells.hasOwnProperty(a)&&(c=this.options.cells[a]));c||(c=this.options.columns[b]);if(!c)c={type:_$_d043[71]};else if(!c.type||typeof c.type==_$_d043[25]&&!u.editors[c.type])c.type=_$_d043[71];return c};var d=function(b,a,c,e,g){var f=this.records[a][b].element;f&&(e&&typeof e.destroyCell==_$_d043[104]&&e.destroyCell(f,b,a,this),c&&typeof c.createCell==_$_d043[104]&&(e=O.call(this,b,a),e=c.createCell(f,e,b,a,this,g),void 0!==e&&O.call(this,b,a,e),Q.applyProperties.call(this,f,b,a)))};
h[_$_d043[11]]=function(b,a,c){if(!P.call(this.parent,this))return!1;this.edition&&this.closeEditor(this.edition,!1);var e=[];if(Array.isArray(b))e=b;else if(jSuites.isNumeric(b)&&jSuites.isNumeric(a))b={x:b,y:a},typeof c==_$_d043[103]&&(b.value=c),e.push(b);else if(typeof a===_$_d043[103])b={x:b,value:a},e.push(b);else if(typeof b==_$_d043[103]&&void 0===a)for(a=Object.keys(b),c=0;c<a.length;c++){var g=F.getCoordsFromColumnName(a[c]);e.push({x:g[0],y:g[1],value:b[a[c]]})}if(Array.isArray(e))for(c=
0;c<e.length;c++){var f=e[c];b=f.x;var k=f.y,l=h[_$_d043[58]].call(this,b,k);a=f.value;g=u.editors[l.type];var n=null;a&&a.type&&(n=u.editors[a.type]);if(typeof k===_$_d043[21])for(f.oldValue=l,parseInt(a.width)||(a.width=this.options.defaultColWidth||100),a.type&&u.editors[a.type]||(a.type=_$_d043[71]),this.options.columns[b]=a,Da.applyProperties.call(this,b),f=0;f<this.records.length;f++)d.call(this,b,f,n,g,a);else l=F.getColumnNameFromCoords(b,k),f.oldValue=this.options.cells&&this.options.cells[l]?
this.options.cells[l]:_$_d043[3],a?(this.options.cells||(this.options.cells={}),this.options.cells[l]=a):(delete this.options.cells[l],a=h[_$_d043[58]].call(this,b,k),n=u.editors[a.type]),d.call(this,b,k,n,g,a)}else return console.error(_$_d043[281]),!1;this.refreshBorders();R.call(this.parent,{worksheet:this,action:_$_d043[96],records:e});L.call(this,_$_d043[96],{data:e});G.call(this.parent,_$_d043[302],this,e);return!0};h.update=function(b,a,c,e){a=typeof b==_$_d043[25]||typeof b==_$_d043[22]?[{x:b,
y:a,value:c}]:b;c=JSON.parse(JSON.stringify(a));if(Array.isArray(a))for(var g=0;g<a.length;g++){var f=a[g].x,k=a[g].y,l=a[g],n=e,q=F.getColumnNameFromCoords(f,k);(b=this.options.cells[q])?l.oldValue=Object.assign({},b):(l.oldValue=null,b=this.options.cells[q]=Object.assign({},this.options.columns[f]));q=Object.keys(l.value);for(var p=0;p<q.length;p++)b[q[p]]=l.value[q[p]];n||typeof k===_$_d043[21]||(n=h[_$_d043[58]].call(this,f,k),n=u.editors[n.type],l.value.type?(l=l.value,q=null,l&&l.type&&(q=u.editors[l.type]),
d.call(this,f,k,q,n,b)):(l=this.records[k][f].element)&&typeof n.updateCell==_$_d043[104]&&(q=O.call(this,f,k),q=n.updateCell(l,q,f,k,this,b),void 0!==q&&O.call(this,f,k,q),Q.applyProperties.call(this,l,f,k)))}R.call(this.parent,{worksheet:this,action:_$_d043[97],records:a});L.call(this,_$_d043[97],{data:c});G.call(this.parent,_$_d043[302],this,a)};return h}(),da=function(){var h=function(b,a){Array.isArray(a)||(a=[a]);for(var c,e=b?_$_d043[3]:_$_d043[52],g=Object.keys(a),f=0;f<g.length;f++)if(c=
this.rows[a[g[f]]])c.element&&(c.element.style.display=e),c.visible=b;H.call(this,!0);this.resetBorders()},d=function(b){b.getRow=d[_$_d043[58]];b.moveRow=d.move;b.insertRow=d.add;b.deleteRow=d.del;b.getSelectedRows=d.selected;b.showRow=h.bind(b,!0);b.hideRow=h.bind(b,!1)};d.height=function(b){var a=0,c=this.rows,e=this.options.rows||{};c[b]&&!1!==c[b].visible&&(a=e[b]&&e[b].height?parseInt(e[b].height):c[b].element&&c[b].element.offsetHeight?c[b].element.offsetHeight:c[b].height?parseInt(c[b].height):
this.options.defaultRowHeight||u.defaultRowHeight||24);return a};d[_$_d043[58]]=function(b){return this.rows[b]};d.attached=function(b){return this.rows[b]&&this.rows[b].element&&this.rows[b].element.parentNode?!0:!1};d.selected=function(b){var a=[],c=this.getHighlighted();if(c)for(var e=c[1];e<=c[3];e++)this.rows[e]&&(b?a.push(e):a.push(this.rows[e].element));return a};d.create=function(b,a){if(this.rows[b]&&this.rows[b].element)return this.rows[b].element;this.rows[b]||ta.row.call(this,b);var c=
document.createElement(_$_d043[171]);c.setAttribute(_$_d043[57],b);this.rows[b].element=c;var e=null;this.options.rows[b]&&!a&&(this.options.rows[b].style&&c.setAttribute(_$_d043[120],this.options.rows[b].style),this.options.rows[b].height&&(c.style.height=parseInt(this.options.rows[b].height)+_$_d043[59]),this.options.rows[b].title&&(e=this.options.rows[b].title),0==this.options.rows[b].visible&&(this.rows[b].visible=!1),this.options.rows[b].id&&(this.rows[b].id=this.options.rows[b].id));0==this.rows[b].visible&&
(c.style.display=_$_d043[52]);e||(e=parseInt(b+1));a=document.createElement(_$_d043[173]);a.innerHTML=e;a.setAttribute(_$_d043[57],b);a.className=_$_d043[303];c.appendChild(a);G.call(this.parent,_$_d043[304],this,b,c);return c};d.move=function(b,a){if(!P.call(this.parent,this))return!1;b=parseInt(b);a=parseInt(a);if(!this.rows[a]||!this.rows[b])return console.error(_$_d043[305]),!1;if(0<Object.keys(this.getMerge()).length){var c=null;this.merged.rows[b]?c=!0:this.merged.rows[a]&&(b>a?this.merged.rows[a-
1]&&(c=!0):this.merged.rows[a+1]&&(c=!0));c&&this.destroyMerged()}this.resetBorders();da.attached.call(this,a)?(c=da.create.call(this,b),b>a?this.tbody.insertBefore(c,this.rows[a].element):this.tbody.insertBefore(c,this.rows[a].element.nextSibling)):da.attached.call(this,b)&&this.tbody.removeChild(this.rows[b].element);this.rows.splice(a,0,this.rows.splice(b,1)[0]);this.records.splice(a,0,this.records.splice(b,1)[0]);this.options.data.splice(a,0,this.options.data.splice(b,1)[0]);L.call(this,_$_d043[82],
{f:b,t:a});R.call(this.parent,{worksheet:this,action:_$_d043[82],oldValue:b,newValue:a});ea.references.call(this);H.call(this,!0,!0);ea.update.call(this);G.call(this.parent,_$_d043[306],this,b,a)};d.add=function(b,a,c,e,g){if(!P.call(this.parent,this))return!1;if(!this.options.allowInsertRow)return console.error(_$_d043[307]),!1;var f=[];if(0<b)var k=parseInt(b);else k=1,Array.isArray(b)&&!e&&(Array.isArray(b[0])?e=b:(e=[],e.push(b)));e=Ha.standardize(e);c=c?!0:!1;b=this.options.data?this.options.data.length-
1:0;if(void 0==a||a>b||0>a)a=b,c=!1;k||(k=1);if(!1===G.call(this.parent,_$_d043[308],this,a,k,c))return console.log(_$_d043[309]),!1;ba.reset.call(this);b=c?a:a+1;for(var l,n,q=0,p=[],v=[],w=this.rows.splice(b),x=this.options.data?this.options.data.splice(b):[],y=this.records.splice(b),A=b;A<k+b;A++){var z=e[q]&&e[q].id?e[q].id:xa.next.call(this);ta.row.call(this,A,z);n=this.dataType?{}:[];for(var I=0;I<this.options.columns.length;I++)l=qa.call(this,I),n[l]=_$_d043[3],e&&e[q]&&e[q].data&&(typeof e[q].data[l]!==
_$_d043[21]?n[l]=e[q].data[l]:typeof e[q].data[I]!==_$_d043[21]&&(n[l]=e[q].data[I])),f.push({x:I,y:A,value:n[l],force:!0});v.push({id:z,data:n});q++}this.rows=this.rows.concat(w);this.records=this.records.concat(y);Array.prototype.push.apply(this.options.data,x);for(A=b;A<k+b;A++)this.results&&(this.rows[A].results=!0),p.push(this.records[A]);this.merged.rows[b]&&sa.updateConfig.call(this,1,1,b-1,k);L.call(this,_$_d043[78],{numOfRows:k,rowNumber:a,insertBefore:c?1:0,data:v});this.results&&(this.results=
za.refresh.call(this));R.call(this.parent,{worksheet:this,action:_$_d043[78],rowNumber:a,numOfRows:k,insertBefore:c,data:v});ea.references.call(this);g||ka[_$_d043[11]].call(this,0,b,this.options.columns.length-1,k+b-1);H.call(this,!0,!0);f.length&&oa.applyValues.call(this,f);ea.update.call(this);G.call(this.parent,_$_d043[310],this,a,k,p,c)};d.del=function(b,a){if(!P.call(this.parent,this))return!1;if(!this.options.allowDeleteRow)return console.error(_$_d043[311]),!1;var c={},e=[];void 0==b&&(a=
this.getSelectedRows(),a[0]?(b=parseInt(a[0].getAttribute(_$_d043[57])),a=a.length):(b=this.options.data.length-1,a=1));var g=this.options.data.length-1;if(void 0==b||b>g||0>b)b=g;a||(a=1);b+a>=this.options.data.length&&(a=this.options.data.length-b,a>=this.options.data.length&&(a=this.options.data.length,this.resetSelection()));if(!1===G.call(this.parent,_$_d043[312],this,b,a))return console.log(_$_d043[313]),!1;if(-1<parseInt(b)&&0<parseInt(a)){ba.reset.call(this);for(var f=b;f<b+a;f++)for(var k=
0;k<this.options.columns.length;k++)g=F.getColumnNameFromCoords(k,f),Q.getAttributes.call(this,_$_d043[314],g,c),Q.getAttributes.call(this,_$_d043[120],g,c),Q.getAttributes.call(this,_$_d043[315],g,c),Q.getAttributes.call(this,_$_d043[316],g,c),Q.getAttributes.call(this,_$_d043[296],g,c),Q.getAttributes.call(this,_$_d043[295],g,c),e[g]=!0;if(g=Z.getChain.call(this,c.values))c.formulas=g;for(f=b;f<b+a;f++)da.attached.call(this,f)&&this.rows[f].element.remove(),this.options.rows&&this.options.rows[f]&&
(this.options.rows[f]=null);g=[];for(f=b;f<b+a;f++)g.push({id:this.getRowId(f),row:f,data:this.getRowData(f)});this.rows.splice(b,a);f=this.records.splice(b,a);this.options.data.splice(b,a);sa.updateConfig.call(this,1,0,b,a);this.results&&(this.results=za.refresh.call(this));L.call(this,_$_d043[79],{rowNumber:b,numOfRows:a,data:g});R.call(this.parent,{worksheet:this,action:_$_d043[79],rowNumber:b,numOfRows:a,insertBefore:1,data:g,attributes:c});ea.references.call(this,e);H.call(this,!0,!0);ea.update.call(this,
!0);G.call(this.parent,_$_d043[317],this,b,a,f,g,c)}};return d}(),ia=function(){var h=function(b,a){Array.isArray(a)||(a=[a]);for(var c,e,g=Object.keys(a),f=0;f<g.length;f++)if(c=a[g[f]],e=this.options.columns[c])this.colgroup[c]&&(this.colgroup[c].style.width=b?parseInt(e.width||this.options.defaultColWidth)+_$_d043[59]:_$_d043[61]),e.visible=b;H.call(this,!0);this.resetBorders()},d=function(b){b.getColumn=d[_$_d043[58]];b.getColumnIdByName=d.getByName;b.getPrimaryKey=d.getPrimaryKey;b.getSelectedColumns=
d.selected;b.moveColumn=d.move;b.insertColumn=d.add;b.deleteColumn=d.del;b.showColumn=h.bind(b,!0);b.hideColumn=h.bind(b,!1)};d[_$_d043[58]]=function(b){return this.options.columns[b]||!1};d.attached=function(b){return this.headers[b]&&this.headers[b].parentNode?!0:!1};d.getByName=function(b){for(var a=this.options.columns,c=0;c<a.length;c++)if(a[c].name==b)return c;return!1};d.getPrimaryKey=function(){for(var b=0;b<this.options.columns.length;b++)if(1==this.options.columns[b].primaryKey)return b;
return!1};d.selected=function(){var b=[],a=this.getHighlighted();if(a)for(var c=a[0];c<=a[2];c++)b.push(c);return b};d.move=function(b,a){if(!P.call(this.parent,this))return!1;b=parseInt(b);a=parseInt(a);if(!this.options.columns[b])return console.error(_$_d043[318]),!1;if(!this.options.columns[a])return console.error(_$_d043[319]),!1;if(0<Object.keys(this.getMerge()).length){var c=null;this.merged.cols[b]?c=!0:this.merged.cols[a]&&(b>a?this.merged.cols[a-1]&&(c=!0):this.merged.cols[a+1]&&(c=!0));
c&&this.destroyMerged()}ba.reset.call(this);this.options.freezeColumns&&ca.applyReset.call(this);if(ia.attached.call(this,a)){Da.create.call(this,b);var e=(b>a?this.headers[a]:this.headers[a].nextSibling)||null;this.headerContainer.insertBefore(this.headers[b],e);e=(b>a?this.colgroup[a]:this.colgroup[a].nextSibling)||null;this.colgroupContainer.insertBefore(this.colgroup[b],e);for(var g=0;g<this.tbody.children.length;g++)c=this.tbody.children[g].getAttribute(_$_d043[57]),e=(b>a?this.records[c][a].element:
this.records[c][a].element.nextSibling)||null,this.tbody.children[g].insertBefore(Q[_$_d043[58]].call(this,b,c),e);if(this.options.footers)for(g=0;g<this.tfoot.children.length;g++)e=(b>a?this.footers.content[g][a].element:this.footers.content[g][a].element.nextSibling)||null,this.tfoot.children[g].insertBefore(fa.create.call(this,b,g),e)}else if(ia.attached.call(this,b)){this.headerContainer.removeChild(this.headers[b]);this.colgroupContainer.removeChild(this.colgroup[b]);for(g=0;g<this.tbody.children.length;g++)c=
parseInt(this.tbody.children[g].getAttribute(_$_d043[57])),this.tbody.children[g].removeChild(this.records[c][b].element);if(this.options.footers)for(g=0;g<this.tfoot.children.length;g++)this.tfoot.children[g].removeChild(this.footers.content[g][b].element)}this.options.columns.splice(a,0,this.options.columns.splice(b,1)[0]);this.headers.splice(a,0,this.headers.splice(b,1)[0]);this.colgroup.splice(a,0,this.colgroup.splice(b,1)[0]);for(g=0;g<this.rows.length;g++)this.dataType||this.options.data[g].splice(a,
0,this.options.data[g].splice(b,1)[0]),this.records[g].splice(a,0,this.records[g].splice(b,1)[0]);if(this.options.footers)for(g=0;g<this.options.footers.length;g++)this.options.footers[g].splice(a,0,this.options.footers[g].splice(b,1)[0]),this.footers.content[g].splice(a,0,this.footers.content[g].splice(b,1)[0]);L.call(this,_$_d043[83],{f:b,t:a});R.call(this.parent,{worksheet:this,action:_$_d043[83],oldValue:b,newValue:a});ea.references.call(this);H.call(this,!0,!0);ea.update.call(this);G.call(this.parent,
_$_d043[320],this,b,a)};d.add=function(b,a,c,e,g,f,k){if(!P.call(this.parent,this))return!1;if(!this.options.allowInsertColumn)return console.error(_$_d043[321]),!1;var l=[];if(0<b)var n=parseInt(b);else if(n=1,Array.isArray(b)&&!g)if(Array.isArray(b[0]))g=b;else{g=[];for(var q=0;q<b.length;q++)g[q]=[b[q]]}g||(g=[]);c=c?!0:!1;b=this.options.columns.length-1;if(void 0==a||a>b||0>a)a=b,c=!1;n||(n=1);if(!1===G.call(this.parent,_$_d043[322],this,a,n,c))return console.log(_$_d043[323]),!1;ba.reset.call(this);
this.options.freezeColumns&&ca.applyReset.call(this);if(1==this.dataType)var p=parseInt((_$_d043[3]+Date.now()).substr(-8));e||(e=[]);for(q=0;q<n;q++)e[q]||(e[q]={}),e[q].type||(e[q].type=_$_d043[71]),e[q].width||(e[q].width=this.options.defaultColWidth),e[q].type!=_$_d043[73]&&e[q].type!=_$_d043[324]||e[q].source||(e[q].source=[]),1==this.dataType&&typeof e[q].name==_$_d043[21]&&(e[q].name=_$_d043[325]+(p+q));p=c?a:a+1;this.options.columns=F.injectArray(this.options.columns,p,e);q=this.headers.splice(p);
var v=this.colgroup.splice(p);for(b=p;b<n+p;b++)Da.create.call(this,b);this.headers=this.headers.concat(q);this.colgroup=this.colgroup.concat(v);fa.adjust.call(this,p,n,1);ya.adjust.call(this,a,n,1,f);v=null;for(var w,x=0;x<this.options.data.length;x++){this.dataType||(v=this.options.data[x].splice(p));w=this.records[x].splice(p);f=0;for(b=p;b<n+p;b++)q=g[x]&&g[x][f]?g[x][f]:_$_d043[3],O.call(this,b,x,q),l.push({x:b,y:x,value:q}),ta.cell.call(this,b,x),f++;this.dataType||(this.options.data[x]=this.options.data[x].concat(v));
this.records[x]=this.records[x].concat(w)}this.merged.cols[p]&&sa.updateConfig.call(this,0,1,p-1,n);L.call(this,_$_d043[80],{numOfColumns:n,columnNumber:a,insertBefore:c?1:0,properties:e,data:g});R.call(this.parent,{worksheet:this,action:_$_d043[80],columnNumber:a,numOfColumns:n,insertBefore:c,properties:e,data:g});ea.references.call(this);k||ka[_$_d043[11]].call(this,p,0,n+p-1,this.rows.length-1);H.call(this,!0,!0);l.length&&oa.applyValues.call(this,l);ea.update.call(this);G.call(this.parent,_$_d043[326],
this,a,n,[],c)};d.del=function(b,a){if(!P.call(this.parent,this))return!1;if(!this.options.allowDeleteColumn)return console.error(_$_d043[327]),!1;var c={},e=[];if(1<this.options.columns.length){void 0==b&&(a=this.getSelectedColumns(!0),a.length?(b=parseInt(a[0]),a=parseInt(a.length)):(b=this.options.columns.length-1,a=1));var g=this.options.columns.length-1;if(void 0==b||b>g||0>b)b=g;a||(a=1);b+a>=this.options.columns.length&&(a=this.options.columns.length-b,a>=this.options.columns.length&&(a--,
console.error(_$_d043[328])));if(!1===G.call(this.parent,_$_d043[329],this,b,a))return console.log(_$_d043[330]),!1;if(-1<parseInt(b)&&0<parseInt(a)){ba.reset.call(this);g=null;var f=[],k=[],l=[];var n=0;for(var q=b;q<b+a;q++)ia.attached.call(this,q)&&(this.colgroup[q].parentNode.removeChild(this.colgroup[q]),this.headers[q].parentNode.removeChild(this.headers[q])),l[n]=this.options.columns[q],n++;for(var p=0;p<this.options.data.length;p++)for(q=b;q<b+a;q++)n=F.getColumnNameFromCoords(q,p),Q.getAttributes.call(this,
_$_d043[314],n,c),Q.getAttributes.call(this,_$_d043[120],n,c),Q.getAttributes.call(this,_$_d043[315],n,c),Q.getAttributes.call(this,_$_d043[316],n,c),Q.getAttributes.call(this,_$_d043[296],n,c),Q.getAttributes.call(this,_$_d043[295],n,c),e[n]=!0,this.records[p][q].element&&0<=Array.prototype.indexOf.call(this.rows[p].element.children,this.records[p][q].element)&&this.records[p][q].element.parentNode.removeChild(this.records[p][q].element);if(q=Z.getChain.call(this,c.values))c.formulas=q;this.options.columns.splice(b,
a);this.headers.splice(b,a);this.colgroup.splice(b,a);for(p=0;p<this.options.data.length;p++)this.dataType||(k[p]=this.options.data[p].splice(b,a)),f[p]=this.records[p].splice(b,a);fa.adjust.call(this,b,a,0);(q=ya.adjust.call(this,b,a,0))&&(g={nested:q});sa.updateConfig.call(this,0,0,b,a);L.call(this,_$_d043[81],{columnNumber:b,numOfColumns:a});R.call(this.parent,{worksheet:this,action:_$_d043[81],columnNumber:b,numOfColumns:a,insertBefore:1,data:k,properties:l,attributes:c,extra:g});ea.references.call(this,
e);H.call(this,!0,!0);ea.update.call(this,!0);G.call(this.parent,_$_d043[331],this,b,a,f,l,c)}}};d.isVisible=function(b){var a=this.options.columns;return!1===a[b].visible||a[b].type===_$_d043[112]||a[b].width===_$_d043[61]||a[b].width===_$_d043[119]?!1:!0};return d}(),La=function(){var h={},d={},b=function(c){if(typeof c==_$_d043[25]){var e=c;c=F.getCoordsFromColumnName(c);var g=c[0];c=c[1]}else g=c.x,c=c.y,e=F.getColumnNameFromCoords(g,c);if(this.records[c]&&this.records[c][g]&&this.records[c][g].element){d[e]=
this.options.style[e];this.records[c][g].element.setAttribute(_$_d043[120],_$_d043[3]);if(this.options.cells&&this.options.cells[e]&&this.options.cells[e].align)var f=this.options.cells[e].align;else this.options.columns[g].align&&(f=this.options.columns[g].align);f&&(this.records[c][g].element.style.textAlign=f)}this.options.style&&this.options.style[e]&&delete this.options.style[e]},a=function(c){c.getStyle=a[_$_d043[58]];c.setStyle=a[_$_d043[11]];c.resetStyle=a.reset};a[_$_d043[58]]=function(c){var e=
this.options.style;if(!e)return!1;if(c){if(typeof c==_$_d043[25])return e[c];var g=[],f=Object.keys(c);if(0<f.length)for(var k=0;k<f.length;k++){if(typeof c[k]==_$_d043[25])var l=e&&e[c[k]]?e[c[k]]:_$_d043[3];else l=F.getColumnNameFromCoords(c[k].x,c[k].y),l=e&&e[l]?e[l]:_$_d043[3];g.push(l)}return g}return this.options.style};a.getFromSelection=function(c){var e,g,f=this.options.style,k=0,l=[];for(g=c[1];g<=c[3];g++){var n=0;l[k]=[];for(e=c[0];e<=c[2];e++){var q=F.getColumnNameFromCoords(e,g);l[k][n++]=
f&&f[q]?f[q]:_$_d043[3]}k++}return l};a[_$_d043[11]]=function(c,e,g,f){if(!P.call(this.parent,this))return!1;this.options.style||(this.options.style={});var k=this.options.style,l=null,n=[],q=[],p={};q=function(x,y,A){if(!p[x]&&(k[x]?n=k[x].split(_$_d043[244]):(k[x]=_$_d043[3],n=[]),p[x]={},n.length))for(var z=0;z<n.length;z++)n[z]&&n[z].trim()&&(l=n[z].split(_$_d043[157]),p[x][l[0].trim()]=l[1].trim());d[x]||(d[x]=[]);h[x]||(h[x]=[]);p[x][y]||(p[x][y]=_$_d043[3]);d[x].push([y+_$_d043[157]+p[x][y]]);
p[x][y]=p[x][y]&&p[x][y]==A&&!f?_$_d043[3]:A;h[x].push([y+_$_d043[157]+p[x][y]]);A=F.getCoordsFromColumnName(x);this.records[A[1]]&&this.records[A[1]][A[0]]&&this.records[A[1]][A[0]].element&&(this.records[A[1]][A[0]].element.style[y]=p[x][y]);p[x][y]||delete p[x][y]};h={};d={};if(e)if(typeof c==_$_d043[25])q.call(this,c,e,g);else{if(c&&c.length)for(var v=0;v<c.length;v++){var w=F.getColumnNameFromCoords(c[v].x,c[v].y);q.call(this,w,e,g)}}else for(g=Object.keys(c),v=0;v<g.length;v++)if(w=c[g[v]])for(typeof w==
_$_d043[25]&&(w=w.split(_$_d043[244])),e=0;e<w.length;e++)w[e]&&(typeof w[e]==_$_d043[25]&&(w[e]=w[e].split(_$_d043[157])),w[e][0].trim()&&q.call(this,g[v],w[e][0].trim(),w[e][1].trim()));n={};q=Object.keys(p);if(q.length){for(v=0;v<q.length;v++){n[q[v]]||(n[q[v]]=[]);c=Object.keys(p[q[v]]);for(e=0;e<c.length;e++)n[q[v]].push(c[e]+_$_d043[137]+p[q[v]][c[e]]);this.options.style[q[v]]=n[q[v]].join(_$_d043[332])}q=Object.keys(h);for(v=0;v<q.length;v++)h[q[v]]=h[q[v]].join(_$_d043[244]);q=Object.keys(d);
for(v=0;v<q.length;v++)d[q[v]]=d[q[v]].join(_$_d043[244]);this.refreshBorders();R.call(this.parent,{worksheet:this,action:_$_d043[86],oldValue:d,newValue:h});L.call(this,_$_d043[86],[h]);G.call(this.parent,_$_d043[333],this,h,d)}};a.reset=function(c){if(!P.call(this.parent,this))return!1;if(c){d={};if(Array.isArray(c))for(var e=0;e<c.length;e++)b.call(this,c[e]);else b.call(this,c);this.refreshBorders();R.call(this.parent,{worksheet:this,action:_$_d043[87],cells:c,oldValue:d});L.call(this,_$_d043[87],
[c]);G.call(this.parent,_$_d043[335],this,c)}else console.error(_$_d043[334])};a.update=function(c){h={};d={};for(var e=Object.keys(c),g=0;g<e.length;g++){d[e[g]]=this.options.style[e[g]]||_$_d043[3];h[e[g]]=this.options.style[e[g]]=c[e[g]];var f=F.getCoordsFromColumnName(e[g]),k=f[0];f=f[1];if(this.records[f]&&this.records[f][k]&&this.records[f][k].element&&(this.records[f][k].element.setAttribute(_$_d043[120],c[e[g]]),!this.records[f][k].element.style.textAlign)){var l=null;this.options.cells&&
this.options.cells[e[g]]&&this.options.cells[e[g]].align?l=this.options.cells[e[g]].align:this.options.columns[k].align&&(l=this.options.columns[k].align);l&&(this.records[f][k].element.style.textAlign=l)}}L.call(this,_$_d043[87],[e]);L.call(this,_$_d043[86],[h]);G.call(this.parent,_$_d043[333],this,h,d)};return a}(),Ya=function(){var h=function(d){d.getComments=h[_$_d043[58]];d.setComments=h[_$_d043[11]]};h[_$_d043[58]]=function(d){return d&&typeof d==_$_d043[25]?this.options.comments&&this.options.comments[d]?
this.options.comments[d]:!1:this.options.comments};h[_$_d043[11]]=function(d,b){if(!P.call(this.parent,this))return!1;if(typeof d==_$_d043[25]){var a={};a[d]=b}else a=d;if(b=G.call(this.parent,_$_d043[336],this,a))a=b;else if(!1===b)return!1;this.options.comments||(this.options.comments={});d={};var c=Object.keys(a);if(c.length){for(var e=0;e<c.length;e++){var g=F.getCoordsFromColumnName(c[e]);this.records[g[1]]&&this.records[g[1]][g[0]]&&(d[c[e]]=this.options.comments[c[e]]||_$_d043[3],(b=a[c[e]])?
this.options.comments[c[e]]=b:delete this.options.comments[c[e]],this.records[g[1]][g[0]].element&&(b?this.records[g[1]][g[0]].element.setAttribute(_$_d043[297],b):this.records[g[1]][g[0]].element.removeAttribute(_$_d043[297])))}R.call(this.parent,{worksheet:this,action:_$_d043[91],newValue:a,oldValue:d});L.call(this,_$_d043[91],[a]);G.call(this.parent,_$_d043[337],this,a,d)}};return h}(),Za=function(){var h=function(d){d.getMeta=h[_$_d043[58]];d.setMeta=h[_$_d043[11]];d.resetMeta=h.reset};h[_$_d043[58]]=
function(d,b){if(d){if(this.options.meta[d])return b?this.options.meta[d][b]:this.options.meta[d]}else return this.options.meta};h[_$_d043[11]]=function(d,b,a){if(!P.call(this.parent,this))return!1;this.options.meta||(this.options.meta={});if(typeof d==_$_d043[25]&&b){a||(a=_$_d043[3]);var c={};c[d]={};c[d][b]=a;d=c}b=Object.keys(d);if(b.length){a={};for(c=0;c<b.length;c++){this.options.meta[b[c]]||(this.options.meta[b[c]]={});a[b[c]]||(a[b[c]]={});for(var e=Object.keys(d[b[c]]),g=0;g<e.length;g++)this.options.meta[b[c]][e[g]]=
d[b[c]][e[g]],a[b[c]][e[g]]=d[b[c]][e[g]]}Object.keys(a).length&&(L.call(this,_$_d043[338],[a]),G.call(this.parent,_$_d043[339],this,a))}};h.reset=function(d){if(!P.call(this.parent,this))return!1;if(d){if(this.options.meta){typeof d==_$_d043[25]&&(d=[d]);for(var b=0;b<d.length;b++)this.options.meta[d[b]]&&delete this.options.meta[d[b]]}}else d={},this.options.meta=d;L.call(this,_$_d043[340],d);G.call(this.parent,_$_d043[341],this,d)};return h}(),$a=function(){var h=function(d){d.orderBy=h.execute};
h.handler=function(d,b){return function(a,c){a=a[1];c=c[1];return d?a===_$_d043[3]&&c!==_$_d043[3]?1:a!==_$_d043[3]&&c===_$_d043[3]?-1:a>c?-1:a<c?1:0:a===_$_d043[3]&&c!==_$_d043[3]?1:a!==_$_d043[3]&&c===_$_d043[3]?-1:a>c?1:a<c?-1:0}};h.execute=function(d,b,a,c){if(0<=d){b=null==b?this.headers[d].classList.contains(_$_d043[342])?1:0:b?1:0;for(var e,g,f=[],k=0;k<this.options.data.length;k++)e=Ka[_$_d043[58]].call(this,d,k),g=this.records[k][d].v,g=e.type==_$_d043[284]||e.type==_$_d043[289]||e.type==
_$_d043[290]||e.type==_$_d043[343]||e.type==_$_d043[22]||e.type==_$_d043[344]?Number(g):jSuites.isNumeric(g)?Number(g):g.toLowerCase(),f[k]=[k,g];k=typeof this.parent.config.sorting===_$_d043[104]?this.parent.config.sorting(b,d):h.handler(b,d);f.sort(k);e=a?!0:!1;if(!a)for(a=[],k=0;k<f.length;k++)a[k]=f[k][0];if(k=G.call(this.parent,_$_d043[345],this,d,b,a))a=k;else if(!1===k)return!1;if(e)this.destroyMerged();else if(0<Object.keys(this.getMerge()).length)if(confirm(E(_$_d043[346])))this.destroyMerged();
else return!1;if(a.length<f.length)for(k=0;k<f.length;k++)-1==a.indexOf(f[k][0])&&a.push(f[k][0]);f=[];for(k=0;k<a.length;k++)f[a[k]]=k;Ga.call(this,!1);ba.reset.call(this);L.call(this,_$_d043[94],{column:d,direction:b,order:a});R.call(this.parent,{worksheet:this,action:_$_d043[94],column:d,newValue:a,oldValue:f,direction:b,previousState:h.getState.call(this)});h.update.call(this,a);h.arrow.call(this,d,b,c);ba.refresh.call(this);G.call(this.parent,_$_d043[347],this,d,b,a);return!0}};h.update=function(d){for(var b=
[],a=0;a<d.length;a++)b[a]=this.options.data[d[a]];for(a=0;a<d.length;a++)this.options.data[a]=b[a];b=[];for(a=0;a<d.length;a++)b[a]=this.records[d[a]];this.records=b;b=[];for(a=0;a<d.length;a++)b[a]=this.rows[d[a]];this.rows=b;ea.references.call(this);this.tbody.innerHTML=_$_d043[3];H.call(this,!0,!0);this.searchInput&&this.searchInput.value?va.update.call(this,null):la.update.call(this)};h.arrow=function(d,b,a){for(var c=0;c<this.headers.length;c++)this.headers[c].classList.remove(_$_d043[348]),
this.headers[c].classList.remove(_$_d043[342]);void 0===a?this.headers[d].classList.add(b?_$_d043[348]:_$_d043[342]):Array.isArray(a)&&this.headers[a[0]].classList.add(a[1]?_$_d043[348]:_$_d043[342])};h.getState=function(){for(var d=0;d<this.headers.length;d++){if(this.headers[d].classList.contains(_$_d043[348]))return[d,1];if(this.headers[d].classList.contains(_$_d043[342]))return[d,0]}return null};return h}(),Ca=function(){var h=function(d){d.whichPage=h.whichPage;d.quantityOfPages=h.quantityOfPages;
d.page=h[_$_d043[11]];d.updatePagination=h.update};h.build=function(){this.pageNumber=0;var d=document.createElement(_$_d043[32]),b=document.createElement(_$_d043[32]);this.pagination=document.createElement(_$_d043[32]);this.pagination.classList.add(_$_d043[349]);this.pagination.appendChild(d);this.pagination.appendChild(b);this.options.pagination||(this.pagination.style.display=_$_d043[52]);this.element.appendChild(this.pagination)};h.pageUp=function(){0<this.pageNumber&&(this.pageNumber--,h[_$_d043[11]].call(this,
this.pageNumber))};h.pageDown=function(){this.pageNumber<h.quantityOfPages.call(this)-1&&(this.pageNumber++,h[_$_d043[11]].call(this,this.pageNumber))};h.whichPage=function(d){if(0<this.options.pagination)return this.rows[d]?(this.results&&(d=this.results.indexOf(parseInt(d))),Math.ceil((parseInt(d)+1)/parseInt(this.options.pagination))-1):null;console.log(_$_d043[350]);return!1};h.quantityOfPages=function(){if(0<this.options.pagination)return Math.ceil((this.results?this.results.length:this.rows.length)/
parseInt(this.options.pagination));console.log(_$_d043[350]);return!1};h[_$_d043[11]]=function(d,b){var a=this.pageNumber,c=parseInt(this.options.pagination);if(c){if(null==d||-1==d)d=Math.ceil((this.results?this.results:this.rows).length/c)-1;if(!1===G.call(this.parent,_$_d043[352],this,d,a,c))return!1;this.pageNumber=d;H.update.call(this);fa.refresh.call(this);typeof b==_$_d043[104]&&b.call(this);G.call(this.parent,_$_d043[353],this,d,a,c)}else console.error(_$_d043[351])};h.update=function(){this.pagination.children[0].innerHTML=
_$_d043[3];this.pagination.children[1].innerHTML=_$_d043[3];if(this.options.pagination){var d=this.results?this.results.length:this.rows.length;if(d){d=Math.ceil(d/this.options.pagination);if(6>this.pageNumber)var b=1,a=10>d?d:10;else 5>d-this.pageNumber?(b=d-9,a=d,1>b&&(b=1)):(b=this.pageNumber-4,a=this.pageNumber+5);if(1<b){var c=document.createElement(_$_d043[32]);c.className=_$_d043[355];c.innerHTML=_$_d043[15];c.title=1;this.pagination.children[1].appendChild(c)}for(;b<=a;b++)c=document.createElement(_$_d043[32]),
c.className=_$_d043[355],c.innerHTML=b,this.pagination.children[1].appendChild(c),this.pageNumber==b-1&&c.classList.add(_$_d043[356]);a<d&&(c=document.createElement(_$_d043[32]),c.className=_$_d043[355],c.innerHTML=_$_d043[17],c.title=d,this.pagination.children[1].appendChild(c));this.pagination.children[0].innerHTML=E(_$_d043[357],[this.pageNumber+1,d])}else this.pagination.children[0].innerHTML=E(_$_d043[354]);this.options.tableOverflow&&(this.content.style.height=this.table.offsetHeight+16+_$_d043[59],
this.table.style.top=0)}};return h}(),ja=function(){var h=function(d){d.setFreezeRows=h[_$_d043[11]];d.resetFreezeRows=h.reset};h.update=function(d){var b,a;if(a=this.options.freezeRows)for(var c=this.thead.offsetHeight,e=0;e<a;e++){if(b=this.records[e][d].element)b.classList.add(_$_d043[358]),b.style.top=c+_$_d043[59];c+=parseInt(this.rows[e].element.offsetHeight)}};h.headers=function(){var d=this.thead.offsetHeight,b;if(b=this.options.freezeRows)for(var a=0;a<b;a++)this.rows[a]&&this.rows[a].element&&
(this.rows[a].element.firstChild.classList.add(_$_d043[358]),this.rows[a].element.firstChild.style.top=d+_$_d043[59],d+=parseInt(this.rows[a].element.offsetHeight));else h.reset.call(this)};h.refresh=function(){if(0<this.options.freezeRows){h.headers.call(this);for(var d=0;d<this.visibleCols.length;d++)h.update.call(this,this.visibleCols[d])}};h[_$_d043[11]]=function(d){h.applyReset.call(this);var b=this.options.freezeRows;this.options.freezeRows=d;this.options.freezeRowControl&&!d?this.thead.lastChild.firstChild.classList.add(_$_d043[359]):
this.thead.lastChild.firstChild.classList.remove(_$_d043[359]);h.refresh.call(this);H.call(this,!0);ba.refresh.call(this);R.call(this.parent,{worksheet:this,action:_$_d043[93],newValue:d,oldValue:b});L.call(this,_$_d043[93],{row:d})};h.reset=function(){h[_$_d043[11]].call(this,0)};h.getHeight=function(d){d=d?0:this.thead.offsetHeight;if(0<this.options.freezeRows)for(var b=0;b<this.options.freezeRows;b++)d+=parseInt(da.height.call(this,b));return d};h.applyReset=function(){for(var d,b=0;b<this.options.freezeRows;b++)if(this.rows[b].element){this.rows[b].element.firstChild.classList.remove(_$_d043[358]);
this.rows[b].element.firstChild.style.top=_$_d043[3];for(var a=0;a<this.options.columns.length;a++)if(d=this.records[b][a].element)d.classList.remove(_$_d043[358]),d.style.top=_$_d043[3]}};h.start=function(d,b){d=this.parent.helper;h.event={y:b,d:b};this.content.scrollTop=0;b=this.content.offsetTop+h.getHeight.call(this);d.style.display=_$_d043[24];d.style.top=b+_$_d043[59];d.style.left=_$_d043[61];d.style.width=this.content.offsetWidth+_$_d043[59];d.style.height=_$_d043[181]};h.end=function(d){d=
h.event;null!==d.d&&this.setFreezeRows(d.d);this.parent.helper.style.display=_$_d043[3];h.event=null};h.cancel=function(){h.event.d=null;h.end.call(this,!1)};h.move=function(d){var b=d.target.getAttribute(_$_d043[57]);if(null!=b){b=parseInt(b);var a=(d=d.target.clientHeight/2>d.offsetY)?b:b+1;this.merged.rows[a]&&0<a||(h.event.d=a,a=this.parent.element.getBoundingClientRect(),b=this.rows[b].element.getBoundingClientRect(),this.parent.helper.style.top=(d?b.top:b.bottom)-a.top+_$_d043[59])}};return h}(),
ca=function(){var h=function(d){d.setFreezeColumns=h[_$_d043[11]];d.resetFreezeColumns=h.reset};h.width=function(){if(this.options.freezeColumns){h.headers.call(this);for(var d=0;d<this.rows.length;d++)this.rows[d].element&&h.update.call(this,d)}};h.update=function(d){var b,a;if(a=this.options.freezeColumns){var c=Aa.call(this)?50:0;if(this.rows[d].element)for(var e=0;e<a;e++){if(b=this.records[d][e].element)b.classList.add(_$_d043[60]),b.style.left=c+_$_d043[59];ia.isVisible.call(this,e)&&(c+=parseInt(this.options.columns[e].width))}}};
h.headers=function(){var d=Aa.call(this)?50:0,b;if(b=this.options.freezeColumns)for(var a=0;a<b;a++){if(this.headers[a]){this.headers[a].classList.add(_$_d043[60]);this.headers[a].style.left=d+_$_d043[59];if(this.options.footers)for(var c=0;c<this.options.footers.length;c++)this.footers.content[c][a].element.classList.add(_$_d043[60]),this.footers.content[c][a].element.style.left=d+_$_d043[59];!1!==this.options.columns[a].visible&&(d+=parseInt(this.options.columns[a].width))}}else h.reset.call(this)};
h.refresh=function(){if(0<this.options.freezeColumns){h.headers.call(this);for(var d=0;d<this.visibleRows.length;d++)h.update.call(this,this.visibleRows[d])}};h[_$_d043[11]]=function(d){h.applyReset.call(this);var b=this.options.freezeColumns;this.options.freezeColumns=d;this.options.freezeColumnControl&&!d?this.thead.lastChild.firstChild.classList.add(_$_d043[360]):this.thead.lastChild.firstChild.classList.remove(_$_d043[360]);h.width.call(this);H.call(this,!0);ba.refresh.call(this);R.call(this.parent,
{worksheet:this,action:_$_d043[92],newValue:d,oldValue:b});L.call(this,_$_d043[92],{column:d})};h.reset=function(){h[_$_d043[11]].call(this,0)};h.applyReset=function(){for(var d,b=1;b<=this.options.freezeColumns;b++){if(d=this.thead.lastChild)d.children[b].classList.remove(_$_d043[60]),d.children[b].style.left=_$_d043[3];for(var a=0;a<this.rows.length;a++)if(d=this.rows[a].element)d.children[b].classList.remove(_$_d043[60]),d.children[b].style.left=_$_d043[3];if(this.options.footers)for(a=0;a<this.options.footers.length;a++)this.tfoot.children[a].children[b].classList.remove(_$_d043[60]),
this.tfoot.children[a].children[b].style.left=_$_d043[3]}};h.getWidth=function(d){d=d?0:Aa.call(this)?50:0;if(0<this.options.freezeColumns)for(var b=0;b<this.options.freezeColumns;b++)ia.isVisible.call(this,b)&&(d+=parseInt(this.options.columns[b].width));return d};h.start=function(d,b){d=this.parent.helper;h.event={x:b,d:b};this.content.scrollLeft=0;b=h.getWidth.call(this);d.style.display=_$_d043[24];d.style.top=this.content.offsetTop+_$_d043[59];d.style.left=b+_$_d043[59];d.style.width=_$_d043[181];
d.style.height=this.content.offsetHeight+_$_d043[59];this.thead.lastChild.firstChild.classList.remove(_$_d043[360])};h.end=function(d){d=h.event;null!==d.d&&this.setFreezeColumns(d.d);this.parent.helper.style.display=_$_d043[3];h.event=null};h.cancel=function(){h.event.d=null;h.end.call(this,!1)};h.move=function(d){var b=d.target.getAttribute(_$_d043[56]);if(null!=b){b=parseInt(b);var a=(d=d.target.clientWidth/2>d.offsetX)?b:b+1;this.merged.cols[a]&&0<a||(h.event.d=a,b=this.headers[b].getBoundingClientRect(),
a=this.content.getBoundingClientRect(),this.parent.helper.style.left=(d?b.left:b.right)-a.left+_$_d043[59])}};return h}(),ea=function(){var h=function(a,c){if(this.options[a]){for(var e={},g=Object.keys(this.options[a]),f=0;f<g.length;f++)e[c&&void 0!=c[g[f]]?c[g[f]]:g[f]]=this.options[a][g[f]];this.options[a]=e}},d=function(){if(0<this.options.minSpareRows){for(var a=0,c=this.rows.length-1;0<=c;c--){for(var e=!1,g=0;g<this.options.columns.length;g++)O.call(this,g,c)&&(e=!0);if(e)break;else a++}0<
this.options.minSpareRows-a&&this.insertRow(this.options.minSpareRows-a)}if(0<this.options.minSpareCols){a=0;for(g=this.options.columns.length-1;0<=g;g--){e=!1;for(c=0;c<this.rows.length;c++)O.call(this,g,c)&&(e=!0);if(e)break;else a++}0<this.options.minSpareCols-a&&this.insertColumn(this.options.minSpareCols-a)}},b=function(){};b.build=function(){var a=this;this.content=document.createElement(_$_d043[32]);this.content.classList.add(_$_d043[361]);this.content.addEventListener(_$_d043[362],function(e){if(!a.edition)return e.preventDefault(),
!1});this.table=document.createElement(_$_d043[363]);this.thead=document.createElement(_$_d043[364]);this.tbody=document.createElement(_$_d043[365]);this.tfoot=document.createElement(_$_d043[366]);!1===this.options.gridline&&this.table.classList.add(_$_d043[367]);this.headers=[];this.colgroup=[];this.colgroupContainer=document.createElement(_$_d043[368]);var c=document.createElement(_$_d043[196]);c.setAttribute(_$_d043[178],_$_d043[369]);this.colgroupContainer.appendChild(c);this.headerContainer=
document.createElement(_$_d043[171]);c=document.createElement(_$_d043[173]);c.classList.add(_$_d043[370]);if(1==this.parent.edition)this.options.freezeRowControl&&!this.options.freezeRows&&c.classList.add(_$_d043[359]),this.options.freezeColumnControl&&!this.options.freezeColumns&&c.classList.add(_$_d043[360]);else if(this.options.freezeRowControl||this.options.freezeColumnControl)this.options.freezeRowControl=!1,this.options.freezeColumnControl=!1,console.log(_$_d043[371]);this.headerContainer.appendChild(c);
this.thead.appendChild(this.headerContainer);this.table.classList.add(_$_d043[372]);this.table.setAttribute(_$_d043[373],_$_d043[119]);this.table.setAttribute(_$_d043[374],_$_d043[119]);this.table.setAttribute(_$_d043[375],_$_d043[376]);this.table.appendChild(this.colgroupContainer);this.table.appendChild(this.thead);this.table.appendChild(this.tbody);this.table.appendChild(this.tfoot);this.options.defaultColAlign&&this.table.classList.add(_$_d043[377]+this.options.defaultColAlign);this.options.textOverflow||
this.table.classList.add(_$_d043[378]);!1===this.options.selectLockedCells&&this.table.classList.add(_$_d043[379]);this.corner=document.createElement(_$_d043[32]);this.corner.className=_$_d043[380];this.corner.setAttribute(_$_d043[375],_$_d043[381]);this.corner.setAttribute(_$_d043[382],_$_d043[383]);0==this.options.selectionCopy&&(this.corner.style.display=_$_d043[52]);this.scrollX=H.build.call(a,_$_d043[384]);this.scrollY=H.build.call(a,_$_d043[385]);this.content.appendChild(this.scrollX);this.content.appendChild(this.scrollY);
this.content.appendChild(this.table);this.content.appendChild(this.corner);this.element.appendChild(this.content);1==this.options.tableOverflow&&(this.content.classList.add(_$_d043[67]),this.options.tableHeight||(this.options.tableHeight=document.body.offsetHeight-18),this.options.tableWidth||(this.options.tableWidth=document.body.offsetWidth-18),this.content.style.width=parseInt(this.options.tableWidth)+_$_d043[59],this.options.pagination?this.content.classList.add(_$_d043[386]):this.content.style.height=
parseInt(this.options.tableHeight)+_$_d043[59]);this.options.resize&&(this.content.style.resize=this.options.resize);this.options.freezeColumns>this.options.columns.length&&console.error(_$_d043[387]);va.build.call(this);ya.build.call(this);Ca.build.call(this);Ha.build.call(this);sa.build.call(this);fa.build.call(this);la.onload.call(this);d.call(this);H.call(this)};b.references=function(a){var c=[],e=[],g=null,f=null,k=null,l=null;for(g=0;g<this.options.columns.length;g++)if(f=this.headers[g])k=
f.getAttribute(_$_d043[56]),k!=g&&(f.setAttribute(_$_d043[56],g),f.getAttribute(_$_d043[193])||(f.innerHTML=F.getColumnName(g)));for(var n=0;n<this.rows.length;n++)f=this.rows[n],l=f.y,l!=n&&(f.y=n,c[l]=n,f.element&&(f.element.setAttribute(_$_d043[57],n),f.element.children[0].setAttribute(_$_d043[57],n),g=this.options.rows&&this.options.rows[l]&&this.options.rows[l].title?this.options.rows[l].title:n+1,f.element.children[0].innerHTML=g));var q=function(v,w){f=this.records[w][v];k=f.x;l=f.y;k!=v&&
(f.x=v,f.element&&f.element.setAttribute(_$_d043[56],v));l!=w&&(f.y=w,f.element&&f.element.setAttribute(_$_d043[57],w));if(k!=v||l!=w){var x=F.getColumnNameFromCoords(k,l);v=F.getColumnNameFromCoords(v,w);e[x]=v}};if(a){n=function(v,w){v&&v[w]&&delete v[w]};var p=Object.keys(a);for(g=0;g<p.length;g++)n(this,p[g]),n(this.options.meta,p[g]),n(this.options.cells,p[g]),n(this.options.style,p[g]),n(this.options.comments,p[g])}for(n=0;n<this.rows.length;n++)for(g=0;g<this.options.columns.length;g++)q.call(this,
g,n);h.call(this,_$_d043[388],c);h.call(this,_$_d043[314],e);h.call(this,_$_d043[315],e);h.call(this,_$_d043[120],e);h.call(this,_$_d043[316],e);h.call(this,_$_d043[296],e);this.options.mergeCells&&sa.build.call(this);G.call(this.parent,_$_d043[389],this,e,a);Z.updateAll.call(this,e,a);Ia.updateAll.call(this,e,a);G.call(this.parent,_$_d043[390],this,e,a);return e};b.update=function(a){a&&d.call(this);if(typeof this.parent.config.updateTable==_$_d043[104])for(var c=0;c<this.rows.length;c++)for(var e=
0;e<this.options.columns.length;e++)a=this.records[c][e],this.parent.config.updateTable.call(this,this,a.element,e,c,O.call(this,e,c),a.r?a.r:a.v);fa.refresh.call(this)};return b}(),ta=function(){var h={spreadsheet:function(d,b){var a={name:null,config:{},el:d,element:d,plugins:[],worksheets:[],history:[],historyIndex:-1,queue:[],ignoreEvents:!1,ignoreHistory:!1,ignorePersistence:!1};Fa.spreadsheet.call(a,b);a.config.license&&(u.license=a.config.license);d.spreadsheet=a;d.jspreadsheet=d.jexcel=a.worksheets;
u.spreadsheet.push(a);a.name||(a.name=jSuites.guid());h.bind(a.config.root?a.config.root:document);var c=a.config.tabs;typeof c!==_$_d043[103]&&(c={allowCreate:c?!0:!1,hideHeaders:c?!1:!0,allowChangePosition:a.config.allowMoveWorksheet?!0:!1});c.maxWidth||(c.maxWidth=d.offsetWidth-50+_$_d043[59]);c.animation=void 0==c.animation?!0:c.animation;c.onbeforecreate=function(){a.createWorksheet();return!1};c.onclick=function(g,f,k,l,n){0<=k&&a.openWorksheet(k,!0)};c.onchangeposition=function(g,f,k){a.updateWorksheet(f,
k)};jSuites.tabs(d,c);d.classList.add(_$_d043[391]);1==b.fullscreen&&d.classList.add(_$_d043[23]);var e=document.createElement(_$_d043[32]);a.toolbar=document.createElement(_$_d043[32]);a.toolbar.className=_$_d043[392];e.appendChild(a.toolbar);a.filter=la.build.call(a);e.appendChild(a.filter);a.helper=document.createElement(_$_d043[32]);a.helper.className=_$_d043[393];e.appendChild(a.helper);a.loading=document.createElement(_$_d043[32]);a.loading.classList.add(_$_d043[394]);e.appendChild(a.loading);
e.appendChild(na.build(a));e.appendChild(Sa(a));a.textarea=document.createElement(_$_d043[395]);a.textarea.className=_$_d043[396];a.textarea.tabIndex=_$_d043[397];e.appendChild(a.textarea);c.position===_$_d043[398]?d.insertBefore(e,d.children[0]):d.insertBefore(e,d.children[1]);d.appendChild(Ma.call(a,u.license));a.createWorksheet=pa.createWorksheet;a.deleteWorksheet=pa.deleteWorksheet;a.renameWorksheet=pa.renameWorksheet;a.updateWorksheet=pa.updateWorksheet;a.openWorksheet=pa.openWorksheet;a.moveWorksheet=
pa.moveWorksheet;a.getWorksheet=pa.getWorksheet;a.getWorksheetActive=pa.getWorksheetActive;a.getWorksheetInstance=pa.getWorksheetInstance;a.getConfig=function(){var g=a.config;g.worksheets=[];for(var f=0;f<a.worksheets.length;f++)g.worksheets.push(a.worksheets[f].getConfig());return g};a.fullscreen=Na;a.progress=Oa;a.dispatch=G;a.setHistory=R;a.resetHistory=R.reset;a.undo=R.undo;a.redo=R.redo;a.setToolbar=ma[_$_d043[11]];a.getToolbar=ma[_$_d043[58]];a.showToolbar=ma.show;a.hideToolbar=ma.hide;a.tools=
e;Ia.build.call(a);b.plugins&&ua.call(a,b.plugins);a.setPlugins=function(g){ua.call(a,g)};d=Object.keys(u.extensions);if(d.length)for(c=0;c<d.length;c++)if(typeof u.extensions[d[c]].oninit==_$_d043[104])u.extensions[d[c]].oninit(a,b);return a},worksheet:function(d,b){var a={};d.worksheets.push(a);a.parent=d;Fa(a);Ua(a);ka(a);ba(a);na(a);Ha(a);Wa(a);sa(a);La(a);Xa(a);oa(a);Z(a);Q(a);da(a);ia(a);Za(a);Ya(a);Da(a);fa(a);ya(a);va(a);la(a);ma(a);xa(a);ab(a);bb(a);Ca(a);pa(a);ca(a);ja(a);Va(a);$a(a);Ia(a);
Ka(a);Fa.worksheet.call(a,b);!u.license&&a.options.license&&(u.license=a.options.license);d.element.jexcel=d.element.jexcel?d.worksheets:a;ua.execute.call(a.parent,_$_d043[399],[a]);a.onload=function(){this.options.worksheetName||(this.options.worksheetName=_$_d043[400]+pa.nextName());var c=this.options.worksheetName;J(c)&&console.log(_$_d043[401]+c+_$_d043[402]);J(c,a);this.element=d.element.tabs.appendElement(this.options.worksheetName,function(e,g){a.options.worksheetState===_$_d043[112]&&(g.style.display=
_$_d043[52])});this.element.classList.add(_$_d043[403]);this.element.jexcel=this;ea.build.call(this);ua.execute.call(this.parent,_$_d043[404],[this]);this.options.data&&500<this.options.data.length&&!H.limited.call(this)&&!this.options.pagination&&console.error(_$_d043[405])};return a},row:function(d,b){this.rows[d]||(this.rows[d]={element:null,y:d});b&&(this.rows[d].id=b,xa[_$_d043[11]].call(this,b));this.options.rows&&this.options.rows[d]&&this.options.rows[d].height&&(this.rows[d].height=this.options.rows[d].height);
this.records[d]||(this.records[d]=[]);this.options.data[d]||(this.options.data[d]=this.dataType?{}:[]);for(b=0;b<this.options.columns.length;b++)h.cell.call(this,b,d)},cell:function(d,b,a){typeof a==_$_d043[21]&&(a=O.call(this,d,b),null===a||void 0===a)&&(a=_$_d043[3],O.call(this,d,b,a));this.records[b][d]||(this.records[b][d]={element:null,x:d,y:b},aa(a)||(this.records[b][d].v=a))},bind:function(d){for(var b=Object.keys(Ea),a=0;a<b.length;a++)(b[a]==_$_d043[406]?window:d).addEventListener(b[a],Ea[b[a]],
b[a]==_$_d043[407]||b[a]==_$_d043[408]||b[a]==_$_d043[409]?{passive:!1}:{})},unbind:function(d){for(var b=Object.keys(Ea),a=0;a<b.length;a++)(b[a]==_$_d043[406]?window:d).removeEventListener(b[a],Ea[b[a]])}};return h}(),ab=function(){var h=function(d){d.getWidth=h[_$_d043[58]];d.setWidth=h[_$_d043[11]]};h[_$_d043[58]]=function(d){var b=this.options.columns;if(typeof d===_$_d043[21]){d=[];for(var a=0;a<b.length;a++)d.push(b[a].width)}else d=b[d].width;return d};h[_$_d043[11]]=function(d,b,a){if(!P.call(this.parent,
this))return!1;if(b){if(Array.isArray(d)){a||(a=[]);for(var c=0;c<d.length;c++){a[c]||(a[c]=this.options.columns[d[c]].width);var e=Array.isArray(b)&&b[c]?b[c]:b;this.options.columns[d[c]].width=e;this.colgroup[d[c]]&&this.colgroup[d[c]].setAttribute(_$_d043[178],e)}}else a||(a=this.options.columns[d].width),this.options.columns[d].width=b,this.colgroup[d]&&this.colgroup[d].setAttribute(_$_d043[178],b);this.refreshBorders();R.call(this.parent,{worksheet:this,action:_$_d043[88],column:d,oldValue:a,
newValue:b});L.call(this,_$_d043[88],{column:d,width:b,oldWidth:a});G.call(this.parent,_$_d043[410],this,d,b,a);H.call(this,!0)}};return h}(),bb=function(){var h=function(b){b.getHeight=h[_$_d043[58]];b.setHeight=h[_$_d043[11]]};h[_$_d043[58]]=function(b){if(void 0===b){b=[];for(var a=0;a<this.rows.length;a++){var c=da.height.call(this,a);c&&(b[a]=c)}}else b=da.height.call(this,b);return b};var d=function(b,a){a=parseInt(a);var c=da.height.call(this,b);this.rows[b].element&&(this.rows[b].element.style.height=
a+_$_d043[59]);this.options.rows[b]||(this.options.rows[b]={});this.options.rows[b].height=a;this.rows[b].height=a;return c};h[_$_d043[11]]=function(b,a,c){if(!P.call(this.parent,this))return!1;var e,g=typeof c==_$_d043[21]?!0:!1;if(a){if(Array.isArray(b))for(!0===g&&(c=[]),e=0;e<b.length;e++){var f=Array.isArray(a)&&a[e]?a[e]:a;d.call(this,b[e],f);1==g&&c.push(g)}else e=d.call(this,b,a),1==g&&(c=e);this.refreshBorders();R.call(this.parent,{worksheet:this,action:_$_d043[89],row:b,oldValue:c,newValue:a});
L.call(this,_$_d043[89],{row:b,height:a,oldHeight:c});G.call(this.parent,_$_d043[411],this,b,a,c);H.call(this,!0)}};return h}(),la=function(){var h=function(f){var k=e[f];f=a[e[f]];if(!f.element){f.element=document.createElement(_$_d043[412]);f.element.innerHTML=f.value;var l=document.createElement(_$_d043[251]);l.type=_$_d043[283];l.value=k;l.o=f;f.element.insertBefore(l,f.element.firstChild)}f.element.firstChild.checked=f.selected;return f.element},d=null,b=null,a=[],c=0,e=null,g=function(f){f.setFilter=
g[_$_d043[11]];f.getFilter=g[_$_d043[58]];f.openFilter=g.open;f.closeFilter=g.close;f.resetFilters=g.reset;f.showFilter=g.show;f.hideFilter=g.hide};g.isVisible=function(){return b};g[_$_d043[11]]=function(f,k){var l=this.headers[f];f=this.options.columns[f];Array.isArray(k)&&0<k.length?(l&&l.classList.add(_$_d043[413]),f.filters=k):(l&&l.classList.remove(_$_d043[413]),f.filters=null);g.update.call(this)};g[_$_d043[58]]=function(f){if(f)return this.options.columns[f].filters||null;f={};for(var k=0;k<
this.options.columns.length;k++)f[k]=this.options.columns[k].filters||null;return f};g.open=function(f){d=parseInt(f);if(this.headers[d].classList.contains(_$_d043[198])){b=!0;var k=this.parent.element.getBoundingClientRect(),l=this.headers[d].getBoundingClientRect();f=l.left-k.left;var n=l.top-k.top+l.height;l=this.parent.filter;k=k.left+k.width;l.style.display=_$_d043[24];f+l.offsetWidth>k&&(f=k-(l.offsetWidth+18));l.style.top=n+_$_d043[59];l.style.left=f+_$_d043[59];l.children[0].focus();f=l.children[1].selectAll;
l.children[1].textContent=_$_d043[3];l.children[1].appendChild(f);f.children[0].checked=this.options.columns[d].filters?!1:!0;f=va.execute.call(this,null,d);f=F.invert(f);l=[];for(k=0;k<this.rows.length;k++)if(f[k]){n=_$_d043[3]+O.call(this,d,k);var q=_$_d043[3]+oa.processed.call(this,d,k,!0);n.substr(0,1)==_$_d043[18]&&(n=q);l.push([n,q])}l.sort(function(p,v){return p[0]>v[0]?1:p[0]<v[0]?-1:0});a=[];for(k=0;k<l.length;k++)a[l[k][0]]={value:l[k][1],element:null};(f=G.call(this.parent,_$_d043[415],
this,d,a))&&(a=f);void 0!==a[_$_d043[3]]&&(delete a[_$_d043[3]],a[_$_d043[3]]={value:_$_d043[241]+E(_$_d043[416])+_$_d043[263],element:null});g.search.call(this,_$_d043[3])}else console.log(_$_d043[414])};g.close=function(f){if(f){f=this.parent.filter.children[1];if(1==f.selectAll.firstChild.checked&&e.length==Object.keys(a).length)f=null;else{f=1==f.currentSelection.firstChild.checked?this.options.columns[d].filters||[]:[];for(var k=0;k<e.length;k++)a[e[k]].selected&&f.push(e[k])}g[_$_d043[11]].call(this,
d,f)}this.parent.filter.style.display=_$_d043[3];this.parent.filter.children[0].value=_$_d043[3];d=null;b=!1;a=null;c=0;e=null};g.reset=function(f){g.updateDOM.call(this,f,!1);za.reset.call(this);g.update.call(this)};g.execute=function(f){for(var k=this.options.columns,l=[],n=0;n<this.options.data.length;n++){for(var q=!0,p=0;p<k.length;p++)if(k[p].filters&&f!==p){var v=_$_d043[3]+O.call(this,p,n),w=_$_d043[3]+this.getLabelFromCoords(p,n,!0);-1==k[p].filters.indexOf(v)&&-1==k[p].filters.indexOf(w)&&
(q=!1)}q&&l.push(n)}return l};g.update=function(){za.reset.call(this);this.resetSelection();this.resetBorders();var f=va.execute.call(this,null);if(typeof this.parent.config.onbeforefilter==_$_d043[104]){var k=g[_$_d043[58]].call(this),l=G.call(this.parent,_$_d043[417],this,k,f);if(l)f=l;else if(!1===l)return!1}this.pageNumber=0;f&&f.length<this.rows.length&&za[_$_d043[11]].call(this,f);fa.refresh.call(this);H.call(this,!0);G.call(this.parent,_$_d043[418],this,k,f)};g.show=function(f){g.updateDOM.call(this,
f,!0)};g.hide=function(f){g.updateDOM.call(this,f,!1,!0);g.update.call(this)};g.search=function(f){for(var k=this.parent.filter.children[1];k.children[1];)k.removeChild(k.lastChild);k.currentSelection.firstChild.checked=!1;if(f){e=[];f=new RegExp(f,_$_d043[419]);for(var l=Object.keys(a),n=0;n<l.length;n++)a[l[n]]&&(_$_d043[3]+a[l[n]].value).match(f)?(e.push(l[n]),a[l[n]].selected=!0):a[l[n]].selected=!1;e.length&&this.options.columns[d].filters&&(k.firstChild.checked=!0,k.appendChild(k.currentSelection))}else{e=
Object.keys(a);if(f=this.options.columns[d].filters)for(n=0;n<e.length;n++)a[e[n]].selected=!1,0<=f.indexOf(e[n])&&(a[e[n]].selected=!0);else for(n=0;n<e.length;n++)a[e[n]].selected=!0;k.firstChild.checked=f?!1:!0}for(n=c=0;n<e.length;n++)200>n&&(f=c++,k.appendChild(h(f)))};g.build=function(){var f=document.createElement(_$_d043[32]);f.className=_$_d043[420];f.onclick=function(q){q.target.tagName==_$_d043[421]&&q.target.o&&(q.target.o.selected=q.target.checked);q=!0;for(var p=1;p<this.children.length;p++)this.children[p].children[0].checked||
(q=!1);this.children[0].children[0].checked=q};var k=document.createElement(_$_d043[251]);k.type=_$_d043[71];k.placeholder=E(_$_d043[422]);k.classList.add(_$_d043[423]);k.classList.add(_$_d043[252]);var l=document.createElement(_$_d043[251]);l.type=_$_d043[424];l.value=_$_d043[425];l.className=_$_d043[426];var n=document.createElement(_$_d043[32]);n.className=_$_d043[427];n.appendChild(k);n.appendChild(f);n.appendChild(l);f.currentSelection=document.createElement(_$_d043[412]);f.currentSelection.innerHTML=
_$_d043[428]+E(_$_d043[429]);f.selectAll=document.createElement(_$_d043[412]);f.selectAll.innerHTML=_$_d043[430]+E(_$_d043[431])+_$_d043[263];f.selectAll.onclick=function(){for(var q=this.children[0].checked,p=1;p<this.parentNode.children.length;p++)this.parentNode.children[p].children[0].checked=q;if(1==q)for(p=0;p<e.length;p++)a[e[p]].selected=!0;else for(q=Object.keys(a),p=0;p<q.length;p++)a[q[p]].selected=!1};jSuites.lazyLoading(f,{loadDown:function(q){for(q=0;c<e.length-1&&10>q;){var p=c++;f.appendChild(h(p));
q++}}});return n};g.updateDOM=function(f,k,l){var n=this.headers,q=function(p){1==k?n[p].classList.add(_$_d043[198]):(this.options.columns[p].filters=null,n[p].classList.remove(_$_d043[413]),1==l&&n[p].classList.remove(_$_d043[198]))};if(f)q.call(this,f);else for(f=0;f<n.length;f++)q.call(this,f)};g.onload=function(){var f,k=!1;if(f=this.options.columns)for(var l=0;l<f.length;l++)Array.isArray(f[l].filters)&&0<f[l].filters.length&&this.headers[l]&&(this.headers[l].classList.add(_$_d043[413]),k=!0);
1==k&&g.update.call(this)};return g}(),za=function(){var h={};h[_$_d043[11]]=function(d){for(var b=0;b<d.length;b++)this.rows[d[b]].results=!0;this.results=d};h.reset=function(){for(var d=0;d<this.rows.length;d++)!0===this.rows[d].results&&delete this.rows[d].results;this.results=null};h.refresh=function(){for(var d=[],b=0;b<this.rows.length;b++)!0===this.rows[b].results&&d.push(b);return d};return h}(),va=function(){var h=function(c){var e=document.createElement(_$_d043[32]);if(0<c.options.pagination&&
c.options.paginationOptions&&0<c.options.paginationOptions.length){c.paginationDropdown=document.createElement(_$_d043[432]);c.paginationDropdown.classList.add(_$_d043[433]);c.paginationDropdown.onchange=function(){c.options.pagination=parseInt(this.value);c.page(0)};for(var g=0;g<c.options.paginationOptions.length;g++){var f=document.createElement(_$_d043[434]);f.value=c.options.paginationOptions[g];f.innerHTML=c.options.paginationOptions[g];c.paginationDropdown.appendChild(f)}c.paginationDropdown.value=
c.options.pagination;e.appendChild(document.createTextNode(E(_$_d043[435])));e.appendChild(c.paginationDropdown);e.appendChild(document.createTextNode(E(_$_d043[436])))}return e},d=function(c){var e=document.createElement(_$_d043[32]);e.innerHTML=E(_$_d043[422])+_$_d043[137];c.searchInput=document.createElement(_$_d043[251]);c.searchInput.classList.add(_$_d043[437]);c.searchInput.classList.add(_$_d043[252]);c.searchInput.oninput=function(){this.parentNode.classList.add(_$_d043[438])};e.appendChild(c.searchInput);
return e},b=function(c,e){var g=this.merged.rows;if(g[e]){for(;0<e&&g[e-1];)e--;for(;g[e];)c.push(e++)}else c.push(e)},a=function(c){c.search=a.update;c.resetSearch=a.reset;c.updateSearch=a.refresh;c.showSearch=a.show;c.hideSearch=a.hide};a.execute=function(c,e){null===c?c=this.searchInput.value||_$_d043[3]:c!==this.searchInput.value&&(this.searchInput.value=c);this.pageNumber=0;var g=[],f=null,k=null,l=null,n=null,q=null;e=la.execute.call(this,e);if(c)try{c=new RegExp(c,_$_d043[419]);if(e&&e.length){var p=
{};for(k=0;k<e.length;k++)p[e[k]]=!0}else p=null;for(k=0;k<this.rows.length;k++){q=!1;if(!p||p[k])for(f=0;f<this.options.columns.length;f++){l=_$_d043[3]+O.call(this,f,k);if(l.match(c)){q=!0;break}n=_$_d043[3]+this.getLabelFromCoords(f,k);if(n.match(c)){q=!0;break}}1==q&&b.call(this,g,k)}}catch(v){}else g=e;if(g.length){for(k=0;k<this.rows.length;k++)!0===this.rows[k].results&&g.push(k);g.sort(function(v,w){return v-w})}return g};a.update=function(c){za.reset.call(this);this.resetSelection();this.resetBorders();
var e=a.execute.call(this,c);if(typeof this.parent.config.onbeforesearch==_$_d043[104]){var g=G.call(this.parent,_$_d043[439],this,c,e);if(g)e=g;else if(!1===g)return!1}this.pageNumber=0;e&&e.length<this.rows.length&&za[_$_d043[11]].call(this,e);fa.refresh.call(this);H.call(this,!0);G.call(this.parent,_$_d043[440],this,c,e);this.searchInput.parentNode.classList.remove(_$_d043[438])};a.refresh=function(){H.update.call(this);fa.refresh.call(this)};a.reset=function(){this.searchInput.value=_$_d043[3];
za.reset.call(this);H.update.call(this);fa.refresh.call(this)};a.show=function(){this.options.search=!0;this.searchContainer.style.display=_$_d043[3]};a.hide=function(){this.options.search=!1;this.searchContainer.style.display=_$_d043[52]};a.build=function(){this.searchContainer=document.createElement(_$_d043[32]);this.searchContainer.classList.add(_$_d043[441]);this.searchContainer.appendChild(h(this));this.searchContainer.appendChild(d(this));0==this.options.search&&(this.searchContainer.style.display=
_$_d043[52]);this.element.insertBefore(this.searchContainer,this.element.firstChild)};return a}(),Sa=function(){var h=function(d){d.contextmenu=document.createElement(_$_d043[32]);d.contextmenu.className=_$_d043[442];jSuites.contextmenu(d.contextmenu,{onclick:function(b,a,c){b.close()}});return d.contextmenu};h.open=function(d,b){if(b[0]===_$_d043[443])var a=b[1],c=b[2];else b[0]===_$_d043[444]?(a=null,c=b[1]):b[0]===_$_d043[445]&&(a=b[1],c=null);var e=h[_$_d043[58]](this,a,c,d,b[0],b[1],b[2]);if(typeof this.parent.config.contextMenu==
_$_d043[104]){var g=this.parent.config.contextMenu(this,a,c,d,e,b[0],b[1],b[2]);if(g)e=g;else if(!1===g)return!1}d.preventDefault();g=ua.execute.call(this.parent,_$_d043[105],[this,a,c,d,e,b[0],b[1],b[2]]);e=g[4];this.parent.contextmenu.contextmenu.open(d,e)};h.isOpened=function(){return this.parent.contextmenu.contextmenu.isOpened()};h[_$_d043[58]]=function(d,b,a,c,e,g,f){var k=[],l=d.parent.config,n=-1!=navigator.userAgent.indexOf(_$_d043[446])?_$_d043[447]:_$_d043[448];e==_$_d043[449]&&(1==l.allowRenameWorksheet&&
k.push({title:E(_$_d043[450]),onclick:function(){var p=prompt(E(_$_d043[450]),c.target.innerText);p&&d.parent.renameWorksheet(g,p)}}),1==l.allowDeleteWorksheet&&k.push({title:E(_$_d043[451]),onclick:function(){confirm(E(_$_d043[452]),c.target.innerText)&&d.parent.deleteWorksheet(g)}}),k.push({type:_$_d043[453]}));e==_$_d043[454]&&(k.push({title:E(_$_d043[455]),onclick:function(){var p=prompt(E(_$_d043[455]),c.target.innerText);d.setNestedCell(g,f,{title:p})}}),k.push({type:_$_d043[453]}));if(e==_$_d043[445]||
e==_$_d043[444]||e==_$_d043[443]||e==_$_d043[454])k.push({title:E(_$_d043[456]),icon:_$_d043[457],shortcut:n+_$_d043[458],onclick:function(){d.cut()}}),k.push({title:E(_$_d043[459]),icon:_$_d043[460],shortcut:n+_$_d043[461],onclick:function(){d.copy()}}),navigator&&navigator.clipboard&&navigator.clipboard.readText&&k.push({title:E(_$_d043[462]),icon:_$_d043[463],shortcut:n+_$_d043[464],onclick:function(){d.selectedCell&&navigator.clipboard.readText().then(function(p){p&&d.paste(d.selectedCell[0],
d.selectedCell[1],p)})}}),k.push({type:_$_d043[453]});e==_$_d043[445]&&(1==d.options.allowInsertColumn&&k.push({title:E(_$_d043[465]),onclick:function(){d.insertColumn(1,parseInt(g),1)}}),1==d.options.allowInsertColumn&&k.push({title:E(_$_d043[466]),onclick:function(){d.insertColumn(1,parseInt(g),0)}}),1==d.options.allowDeleteColumn&&k.push({title:E(_$_d043[467]),onclick:function(){d.deleteColumn(d.getSelectedColumns().length?void 0:parseInt(b))}}),1==d.options.allowRenameColumn&&k.push({title:E(_$_d043[468]),
onclick:function(){d.setHeader(g)}}),d.options.data.length||(k.push({type:_$_d043[453]}),k.push({title:E(_$_d043[469]),onclick:function(){d.insertRow(0)}})),1==d.options.columnSorting&&(k.push({type:_$_d043[453]}),k.push({title:E(_$_d043[470]),onclick:function(){d.orderBy(g,0)}}),k.push({title:E(_$_d043[471]),onclick:function(){d.orderBy(g,1)}}),k.push({type:_$_d043[453]})));if(e==_$_d043[443]||e==_$_d043[444])1==d.options.allowInsertRow&&(k.push({title:E(_$_d043[472]),onclick:function(){d.insertRow(1,
parseInt(a),1)}}),k.push({title:E(_$_d043[473]),onclick:function(){d.insertRow(1,parseInt(a))}})),1==d.options.allowDeleteRow&&k.push({title:E(_$_d043[474]),onclick:function(){d.deleteRow(d.getSelectedRows().length?void 0:parseInt(a))}}),k.push({type:_$_d043[453]});if(e==_$_d043[443]&&1==d.options.allowComments){var q=d.records[f][g].element.getAttribute(_$_d043[297])||_$_d043[3];k.push({title:q?E(_$_d043[475]):E(_$_d043[476]),icon:_$_d043[477],onclick:function(){var p=F.getColumnNameFromCoords(g,
f),v=prompt(E(_$_d043[478]),q);v&&d.setComments(p,v)}});q&&k.push({title:E(_$_d043[479]),onclick:function(){var p=F.getColumnNameFromCoords(g,f);d.setComments(p,_$_d043[3])}});k.push({type:_$_d043[453]})}l.allowExport&&k.push({title:E(_$_d043[480]),icon:_$_d043[481],shortcut:n+_$_d043[482],onclick:function(){d.download()}});l.about&&k.push({title:E(_$_d043[483]),icon:_$_d043[484],onclick:function(){!0===l.about?alert(N().print()):alert(l.about)}});return k};return h}(),ma=function(){var h=function(d){d.showToolbar=
function(){h.show.call(d.parent)};d.hideToolbar=function(){h.hide.call(d.parent)};d.refreshToolbar=function(){h.update.call(d.parent,d)}};h[_$_d043[11]]=function(d){this.toolbar.innerHTML=_$_d043[3];this.config.toolbar=h[_$_d043[58]].call(this,d);h.show.call(this)};h[_$_d043[58]]=function(d){d||(d=this.config.toolbar);var b=h.getDefault(d);d?Array.isArray(d)?d={items:d}:typeof d===_$_d043[104]&&(d=d({items:b})):d={};typeof d!==_$_d043[103]&&(d={});d.items||(d.items=b);typeof d.responsive==_$_d043[21]&&
(d.responsive=!0,d.bottom=!1,d.maxWidth=this.element.offsetWidth);return d};h.show=function(){this.toolbar.innerHTML||h.build.call(this);this.toolbar.style.display=_$_d043[3];this.element.classList.add(_$_d043[485])};h.hide=function(){this.toolbar.style.display=_$_d043[52];this.element.classList.remove(_$_d043[485])};h.update=function(d,b){var a=this.toolbarInstance;a&&(a.options.responsive&&(b=this.config.fullscreen?d.element.offsetWidth:d.options.tableWidth?parseInt(d.options.tableWidth):null,a.options.maxWidth=
b,a.refresh()),a.update(d),P.call(this,d)?a.setReadonly(!1):a.setReadonly(!0))};h.build=function(){for(var d=h[_$_d043[58]].call(this),b=0;b<d.items.length;b++)if(d.items[b].type==_$_d043[432]){if(!d.items[b].options&&d.items[b].v){d.items[b].options=[];for(var a=0;a<d.items[b].v.length;a++)d.items[b].options.push(d.items[b].v[a]);d.items[b].k&&(d.items[b].onchange=function(c,e,g,f){u.current.setStyle(u.current.getSelected(!1,!0),g.k,f)})}}else d.items[b].type==_$_d043[288]?(d.items[b].type=_$_d043[486],
d.items[b].onclick=function(c,e,g){if(!g.color){var f=null;jSuites.color(g,{onchange:function(k,l){(f=u.current.getSelected(!1,!0))&&u.current.setStyle(f,g.k,l)},onopen:function(k){var l;u.current.cursor?(l=u.current.cursor.style[g.k])?k.color.select(k.color.toHex(l)):k.color.select(_$_d043[3]):k.color.select(_$_d043[3])}});g.color.open()}}):!d.items[b].onclick&&d.items[b].k&&(d.items[b].onclick=function(){var c=u.current.getSelected(!1,!0);c&&c.length&&u.current.setStyle(c,this.k,this.v)});(b=ua.execute.call(this,
_$_d043[106],[d]))&&(d=b[0]);this.toolbarInstance=jSuites.toolbar(this.toolbar,d);this.toolbarInstance.application=this;d=this.element.tabs.getActive();this.toolbarInstance.update(this.worksheets[d])};h.getDefault=function(d){var b=[];b.push({content:_$_d043[487],onclick:function(){u.current&&u.current.undo()}});b.push({content:_$_d043[488],onclick:function(){u.current&&u.current.redo()}});b.push({content:_$_d043[481],onclick:function(){u.current&&u.current.download()}});b.push({type:_$_d043[489]});
b.push({type:_$_d043[432],width:_$_d043[490],options:[_$_d043[491],_$_d043[492],_$_d043[493]],render:function(c){return _$_d043[494]+c+_$_d043[258]+c+_$_d043[495]},onchange:function(c,e,g,f){u.current&&u.current.setStyle(u.current.getSelected(!1,!0),_$_d043[496],f)}});b.push({type:_$_d043[432],width:_$_d043[497],content:_$_d043[498],options:[_$_d043[499],_$_d043[500],_$_d043[501],_$_d043[502],_$_d043[503]],render:function(c){return _$_d043[504]+c+_$_d043[258]+c+_$_d043[495]},onchange:function(c,e,
g,f){u.current&&u.current.setStyle(u.current.getSelected(!1,!0),_$_d043[505],f)}});b.push({type:_$_d043[432],options:[_$_d043[506],_$_d043[507],_$_d043[508],_$_d043[509]],render:function(c){return _$_d043[510]+c+_$_d043[511]},onchange:function(c,e,g,f){u.current&&u.current.setStyle(u.current.getSelected(!1,!0),_$_d043[512],f.split(_$_d043[513])[2])},updateState:function(c,e,g,f){(c=f.selectedCell)&&c.length&&f.records[c[1]][c[0]].element&&(f=this.picker.options.data.indexOf(_$_d043[514]+(f.records[c[1]][c[0]].element.style.textAlign||
f.options.defaultColAlign||_$_d043[210])),g.picker.setValue(f))}});b.push({type:_$_d043[486],content:_$_d043[515],k:_$_d043[516],v:_$_d043[517]});b.push({type:_$_d043[288],content:_$_d043[518],k:_$_d043[288]});b.push({type:_$_d043[288],content:_$_d043[519],k:_$_d043[520]});if(d===_$_d043[521]||typeof d===_$_d043[104]){var a=[_$_d043[522],_$_d043[523],_$_d043[398]];b.push({type:_$_d043[432],options:[_$_d043[524],_$_d043[525],_$_d043[526]],render:function(c){return _$_d043[510]+c+_$_d043[511]},value:1,
onchange:function(c,e,g,f,k){u.current&&u.current.setStyle(u.current.getSelected(!1,!0),_$_d043[527],a[k])},updateState:function(c,e,g,f){(c=f.selectedCell)&&c.length&&f.records[c[1]][c[0]].element&&(f=a.indexOf(f.records[c[1]][c[0]].element.style.verticalAlign||_$_d043[523]),g.picker.setValue(f))}});b.push({content:_$_d043[528],onclick:function(c,e,g){u.current&&(c=u.current.getHighlighted())&&c.length&&(e=u.helpers.getColumnNameFromCoords(c[0],c[1]),u.current.records[c[1]][c[0]].merged?u.current.removeMerge(e):
u.current.setMerge(e,c[2]-c[0]+1,c[3]-c[1]+1))},tooltip:E(_$_d043[529])})}b.push({type:_$_d043[432],data:[_$_d043[530],_$_d043[531],_$_d043[532],_$_d043[533],_$_d043[534],_$_d043[535],_$_d043[536],_$_d043[537],_$_d043[538],_$_d043[539]],columns:5,render:function(c){return _$_d043[510]+c+_$_d043[511]},right:!0,onchange:function(c,e,g,f,k){if(c=u.current.getHighlighted()){g=e.thickness||1;e=e.color||_$_d043[540];k={};for(var l=c[0],n=c[1],q=c[2],p=c[3],v=c[1];v<=c[3];v++)for(var w=c[0];w<=c[2];w++){var x=
F.getColumnNameFromCoords(w,v);k[x]||(k[x]=_$_d043[3]);k[x]=f!=_$_d043[535]&&f!=_$_d043[531]||w!=l?(f==_$_d043[532]||f==_$_d043[534])&&w>l?k[x]+(_$_d043[541]+g+_$_d043[542]+e+_$_d043[332]):f==_$_d043[530]?k[x]+(_$_d043[541]+g+_$_d043[542]+e+_$_d043[332]):k[x]+_$_d043[543]:k[x]+(_$_d043[541]+g+_$_d043[542]+e+_$_d043[332]);k[x]=f!=_$_d043[530]&&f!=_$_d043[537]&&f!=_$_d043[531]||w!=q?k[x]+_$_d043[545]:k[x]+(_$_d043[544]+g+_$_d043[542]+e+_$_d043[332]);k[x]=f!=_$_d043[536]&&f!=_$_d043[531]||v!=n?(f==_$_d043[532]||
f==_$_d043[533])&&v>n?k[x]+(_$_d043[546]+g+_$_d043[542]+e+_$_d043[332]):f==_$_d043[530]?k[x]+(_$_d043[546]+g+_$_d043[542]+e+_$_d043[332]):k[x]+_$_d043[547]:k[x]+(_$_d043[546]+g+_$_d043[542]+e+_$_d043[332]);k[x]=f!=_$_d043[530]&&f!=_$_d043[538]&&f!=_$_d043[531]||v!=p?k[x]+_$_d043[549]:k[x]+(_$_d043[548]+g+_$_d043[542]+e+_$_d043[332])}Object.keys(k)&&u.current.setStyle(k,null,null,!0)}},onload:function(c,e){var g=document.createElement(_$_d043[32]),f=document.createElement(_$_d043[32]);g.appendChild(f);
var k=jSuites.color(f,{closeOnChange:!1,onchange:function(l,n){l.parentNode.children[1].style.color=n;e.color=n}});f=document.createElement(_$_d043[486]);f.classList.add(_$_d043[550]);f.innerHTML=_$_d043[551];f.onclick=function(){k.open()};g.appendChild(f);c.children[1].appendChild(g);f=document.createElement(_$_d043[32]);jSuites.picker(f,{type:_$_d043[432],data:[1,2,3,4,5],render:function(l){return _$_d043[552]+l+_$_d043[553]},onchange:function(l,n,q,p){e.thickness=p},width:_$_d043[554]});c.children[1].appendChild(f);
f=document.createElement(_$_d043[32]);f.style.flex=_$_d043[555];c.children[1].appendChild(f)}});b.push({type:_$_d043[489]});b.push({content:_$_d043[23],onclick:function(c,e,g){g.children[0].innerText==_$_d043[23]?(u.current.fullscreen(!0),g.children[0].innerText=_$_d043[556]):(u.current.fullscreen(!1),g.children[0].innerText=_$_d043[23])},tooltip:_$_d043[557],updateState:function(c,e,g,f){g.children[0].innerText=1==f.parent.config.fullscreen?_$_d043[556]:_$_d043[23]}});b.push({content:_$_d043[558],
onclick:function(c,e,g){u.current&&u.current.parent.tools.search?u.current.parent.tools.search.open(!0):g.children[0].innerText==_$_d043[558]?(va.show.call(u.current),g.children[0].innerText=_$_d043[559]):(va.hide.call(u.current),g.children[0].innerText=_$_d043[558])},tooltip:_$_d043[560],updateState:function(c,e,g,f){g.children[0].innerText=1==f.options.search?_$_d043[559]:_$_d043[558]}});return b};return h}(),pa=function(){var h=function(d){d.createWorksheet=function(b){return d.parent.createWorksheet(b)};
d.deleteWorksheet=function(b){return d.parent.deleteWorksheet(b)};d.renameWorksheet=function(b,a){return d.parent.renameWorksheet(b,a)};d.moveWorksheet=function(b,a){return d.parent.moveWorksheet(b,a)};d.openWorksheet=function(){return d.parent.openWorksheet(d.parent.getWorksheet(d))};d.getWorksheet=function(b){return d.parent.getWorksheet(b)};d.getWorksheetActive=function(){return d.parent.getWorksheetActive()};d.getWorksheetName=function(){return d.options.worksheetName.toUpperCase()}};h.nextName=
function(){var d=1,b,a=u.spreadsheet;if(a.length)for(var c=0;c<a.length;c++){var e=a[c].worksheets;if(e.length)for(var g=0;g<e.length;g++)e[g].options.worksheetName&&(b=e[g].options.worksheetName.match(/(\d+)/))&&(b=parseInt(b[0])+1,b>d&&(d=b))}return d};h.createWorksheet=function(d){if(!P.call(this))return!1;d||(d={});var b=this.worksheets.length,a=G.call(this,_$_d043[561],d,b);if(typeof a===_$_d043[103])d=a;else if(!1===a)return!1;d.data||d.minDimensions||(d.minDimensions=[8,8]);d.worksheetId||
(d.worksheetId=jSuites.guid().substring(0,8));d.worksheetName||(d.worksheetName=_$_d043[400]+h.nextName());if(J(d.worksheetName))jSuites.notification({error:_$_d043[555],message:_$_d043[562]});else return a=ta.worksheet(this,d),a.onload(),u.current&&u.current.resetSelection(),u.current=a,L.call(a,_$_d043[563],[d]),ma.update.call(this,u.current),G.call(this,_$_d043[564],a,d,b),a};h.deleteWorksheet=function(d){var b=this.worksheets[d];if(!P.call(this,b))return!1;J(b.options.worksheetName,null);this.element.tabs.deleteElement(d);
this.worksheets.splice(d,1);L.call(b,_$_d043[565],[d]);G.call(this,_$_d043[566],b,d)};h.renameWorksheet=function(d,b){var a=this.worksheets[d];if(!P.call(this,a))return!1;var c=a.options.worksheetName;if(c.toLowerCase()==b.toLowerCase())return!1;b=b.replace(/[^0-9A-Za-z_\s^]+/gi,_$_d043[3]);Number(b)==b&&(b=_$_d043[400]+Number(b));J(b)?alert(_$_d043[567]):(J(c,null),this.element.tabs.rename(d,b),a.options.worksheetName=b,J(b,a),R.call(this,{worksheet:a,action:_$_d043[98],index:d,oldValue:c,newValue:b}),
L.call(a,_$_d043[98],{worksheet:d,newValue:b}),Ia.updateWorksheetName.call(a,c,b),Z.updateWorksheetNames.call(a,c,b),G.call(this,_$_d043[568],a,d,b,c))};h.updateWorksheet=function(d,b){var a=this.worksheets;if(!P.call(this))return!1;this.worksheets.splice(b,0,a.splice(d,1)[0]);R.call(this,{worksheet:a[b],action:_$_d043[99],f:d,t:b});L.call(a[b],_$_d043[99],{f:d,t:b});G.call(this,_$_d043[569],a[b],d,b)};h.moveWorksheet=function(d,b){this.element.tabs.move(d,b)};h.openWorksheet=function(d){var b=this.worksheets[d];
!b||u.current&&u.current==b||(this.element.tabs.getActive()!=d?this.element.tabs.open(d):this.element.tabs.setBorder(d),u.current&&u.current.resetSelection(),u.current=b,u.current.refreshBorders(),h.state.call(this,d),ma.update.call(this,u.current),G.call(this,_$_d043[570],b,d))};h.getWorksheet=function(d){if(d&&typeof d==_$_d043[103]){if(d=this.worksheets.indexOf(d),0<=d)return d}else for(var b=0;b<this.worksheets.length;b++)if(d===this.worksheets[b].options.worksheetId)return b;return!1};h.getWorksheetActive=
function(){return this.element.tabs.getActive()};h.getWorksheetInstance=function(d){return d===_$_d043[3]||typeof d==_$_d043[25]?(d=h.getWorksheet.call(this,d),!1===d?!1:this.worksheets[d]):this.worksheets[d]};h.state=function(d){try{if(typeof localStorage!==_$_d043[21]){var b=this.config.cloud?this.config.cloud:this.element.id;if(b)if(typeof d!==_$_d043[21])localStorage.setItem(_$_d043[377]+b,d);else{var a=parseInt(localStorage.getItem(_$_d043[377]+b));h.openWorksheet.call(this,a)}}}catch(c){}};
return h}(),F=function(){var h={getCaretIndex:function(d){var b=0,a=(this.config.root?this.config.root:window).getSelection();a&&0!==a.rangeCount&&(b=a.getRangeAt(0),a=b.cloneRange(),a.selectNodeContents(d),a.setEnd(b.endContainer,b.endOffset),b=a.toString().length);return b},invert:function(d){for(var b=[],a=Object.keys(d),c=0;c<a.length;c++)b[d[a[c]]]=a[c];return b},getColumnName:function(d){var b=_$_d043[3];701<d?(b+=String.fromCharCode(64+parseInt(d/676)),b+=String.fromCharCode(64+parseInt(d%
676/26))):25<d&&(b+=String.fromCharCode(64+parseInt(d/26)));return b+=String.fromCharCode(65+d%26)},getColumnNameFromCoords:function(d,b){return h.getColumnName(parseInt(d))+(parseInt(b)+1)},getCoordsFromColumnName:function(d){if(!d)return[];d=(_$_d043[3]+d).replace(new RegExp(/\$/),_$_d043[3]);var b=/^[a-zA-Z]+/.exec(d);if(b){for(var a=0,c=0;c<b[0].length;c++)a+=parseInt(b[0].charCodeAt(c)-64)*Math.pow(26,b[0].length-1-c);a--;0>a&&(a=0);d=parseInt(/[0-9]+$/.exec(d))||null;0<d&&d--;return[a,d]}}};
h.shiftFormula=Z.shiftFormula;h.updateWorksheetName=Z.updateWorksheetName;h.createFromTable=function(d,b){if(d.tagName!=_$_d043[571])console.log(_$_d043[572]);else{b||(b={});b.columns=[];b.data=[];var a=d.querySelectorAll(_$_d043[573]);if(a.length)for(var c=0;c<a.length;c++){var e=a[c].style.width;e||(e=a[c].getAttribute(_$_d043[178]));e&&(b.columns[c]||(b.columns[c]={}),b.columns[c].width=e)}e=function(A){var z=A.getBoundingClientRect();z=50<z.width?z.width:50;b.columns[c]||(b.columns[c]={});A.getAttribute(_$_d043[574])?
b.columns[c].type=A.getAttribute(_$_d043[574]):b.columns[c].type=_$_d043[71];b.columns[c].width=z+_$_d043[59];b.columns[c].title=A.innerHTML;A.style.textAlign&&(b.columns[c].align=A.style.textAlign);A.classList.contains(_$_d043[575])&&(b.columns[c].readOnly=!0);if(z=A.getAttribute(_$_d043[576]))b.columns[c].name=z;if(z=A.getAttribute(_$_d043[577]))b.columns[c].id=z};var g=[],f=d.querySelectorAll(_$_d043[578]);if(f.length){for(a=0;a<f.length-1;a++){var k=[];for(c=0;c<f[a].children.length;c++){var l=
{title:f[a].children[c].innerText,colspan:f[a].children[c].getAttribute(_$_d043[190])||1};k.push(l)}g.push(k)}f=f[f.length-1].children;for(c=0;c<f.length;c++)e(f[c])}l=0;var n={},q={},p={},v={},w=null;k=d.querySelectorAll(_$_d043[579]);for(a=0;a<k.length;a++)if(b.data[l]=[],1!=b.parseTableFirstRowAsHeader||f.length||0!=a){for(c=0;c<k[a].children.length;c++){var x=k[a].children[c].getAttribute(_$_d043[580]);x?x.substr(0,1)!=_$_d043[18]&&(x=_$_d043[18]+x):x=k[a].children[c].innerHTML;b.data[l].push(x);
x=F.getColumnNameFromCoords(c,a);(w=k[a].children[c].getAttribute(_$_d043[581]))&&(v[x]=w);w=parseInt(k[a].children[c].getAttribute(_$_d043[190]))||0;var y=parseInt(k[a].children[c].getAttribute(_$_d043[191]))||0;if(w||y)n[x]=[w||1,y||1];if(w=k[a].children[c].style&&k[a].children[c].style.display==_$_d043[52])k[a].children[c].style.display=_$_d043[3];(w=k[a].children[c].getAttribute(_$_d043[120]))&&(p[x]=w);k[a].children[c].classList.contains(_$_d043[582])&&(p[x]=p[x]?p[x]+_$_d043[583]:_$_d043[584])}k[a].style&&
k[a].style.height&&(q[a]={height:k[a].style.height});l++}else for(c=0;c<k[a].children.length;c++)e(k[a].children[c]);0<Object.keys(g).length&&(b.nestedHeaders=g);0<Object.keys(p).length&&(b.style=p);0<Object.keys(n).length&&(b.mergeCells=n);0<Object.keys(q).length&&(b.rows=q);0<Object.keys(v).length&&(b.classes=v);k=d.querySelectorAll(_$_d043[585]);if(k.length){d=[];for(a=0;a<k.length;a++){e=[];for(c=0;c<k[a].children.length;c++)e.push(k[a].children[c].innerText);d.push(e)}0<Object.keys(d).length&&
(b.footers=d)}if(1==b.parseTableAutoCellType)for(d=[],c=0;c<b.columns.length;c++){g=e=!0;d[c]=[];for(a=0;a<b.data.length;a++)if(x=b.data[a][c],d[c][x]||(d[c][x]=0),d[c][x]++,25<x.length&&(e=!1),10==x.length){if(x.substr(4,1)!=_$_d043[237]||x.substr(7,1)!=_$_d043[237])g=!1}else g=!1;a=Object.keys(d[c]).length;g?b.columns[c].type=_$_d043[214]:1==e&&1<a&&a<=parseInt(.1*b.data.length)&&(b.columns[c].type=_$_d043[73],b.columns[c].source=Object.keys(d[c]))}return b}};h.injectArray=function(d,b,a){return d.slice(0,
b).concat(a).concat(d.slice(b))};h.parseCSV=function(d,b){b=b||_$_d043[37];for(var a=0,c=0,e=[[]],g=0,f=null,k=!1,l=!1,n=0;n<d.length;n++)if(e[c]||(e[c]=[]),e[c][a]||(e[c][a]=_$_d043[3]),d[n]!=_$_d043[586])if(d[n]!=_$_d043[587]&&d[n]!=b||0!=k&&1!=l&&f){d[n]==_$_d043[20]&&(k=!k);if(null===f){if(f=k,1==f)continue}else if(!0===f&&!l&&d[n]==_$_d043[20]){d[n+1]==_$_d043[20]?(k=!0,e[c][a]+=d[n],n++):l=!0;continue}e[c][a]+=d[n]}else{f=null;l=k=!1;if(e[c][a][0]==_$_d043[20]){var q=e[c][a].trim();q[q.length-
1]==_$_d043[20]&&(e[c][a]=q.substr(1,q.length-2))}d[n]==_$_d043[587]?(a=0,c++):(a++,a>g&&(g=a))}for(d=0;d<e.length;d++)for(n=0;n<=g;n++)void 0===e[d][n]&&(e[d][n]=_$_d043[3]);return e};h.getTokensFromRange=Z.getTokensFromRange;h.getRangeFromTokens=Z.getRangeFromTokens;h.getCoordsFromRange=function(d){-1!==d.indexOf(_$_d043[19])&&(d=d.split(_$_d043[19]),d=d[1]);d=d.split(_$_d043[157]);d[1]||(d[1]=d[0]);var b=F.getCoordsFromColumnName(d[0]);d=F.getCoordsFromColumnName(d[1]);return[b[0],b[1],d[0],d[1]]};
return h}(),Ea=function(){var h={},d=null,b=null,a=null,c=null,e=!1,g=null,f=null,k=null,l=function(r){function B(V){V.className&&(V.classList.contains(_$_d043[391])&&(M=V),V.classList.contains(_$_d043[403])&&(T=V),V.classList.contains(_$_d043[588])&&(U=V));V.parentNode&&V.parentNode.classList&&V.parentNode.classList.contains(_$_d043[372])&&(V.tagName==_$_d043[589]?C=1:V.tagName==_$_d043[590]?C=2:V.tagName==_$_d043[591]&&(C=3));V.parentNode&&!M&&B(V.parentNode)}var C=null,D=null,M=null,T=null,U=null,
K=null,X=null,Y=null;B(r.target);if(null!==U)return!1;if(M)if(r.target.classList.contains(_$_d043[370]))D=_$_d043[592];else if(r.target.classList.contains(_$_d043[380]))D=_$_d043[159];else if(r.target.classList.contains(_$_d043[303]))D=_$_d043[444],K=parseInt(r.target.getAttribute(_$_d043[57]));else if(r.target.parentNode&&r.target.parentNode.classList&&r.target.parentNode.classList.contains(_$_d043[206]))K=r.target.getAttribute(_$_d043[211]),X=r.target.getAttribute(_$_d043[212]),null===K?D=_$_d043[592]:
(D=_$_d043[454],K=parseInt(K),X=parseInt(X));else if(r.target.parentNode&&r.target.parentNode.classList&&r.target.parentNode.classList.contains(_$_d043[172]))D=_$_d043[593];else if(r.target.classList.contains(_$_d043[176]))D=_$_d043[593];else if(r.target.parentNode&&r.target.parentNode.classList&&r.target.parentNode.classList.contains(_$_d043[594]))D=_$_d043[449],K=Array.prototype.indexOf.call(r.target.parentNode.children,r.target);else if(1==C)D=_$_d043[445],K=r.target.clientWidth-r.offsetX,r.target.classList.contains(_$_d043[198])&&
3<K&&20>K&&(D=_$_d043[595]),K=r.target.getAttribute(_$_d043[56]);else if(2==C){if(r=n(r,M))D=_$_d043[443],K=r[0],X=r[1],Y=r[2]}else if(3==C){if(K=r.target.getAttribute(_$_d043[56]),X=r.target.getAttribute(_$_d043[57]),K||X)D=_$_d043[596]}else C||jSuites.findElement(r.target,_$_d043[597])&&(D=_$_d043[106]);return[M,T,C,D,K,X,Y]},n=function(r,B){if(r.changedTouches&&r.changedTouches[0]){var C=r.changedTouches[0].clientX;r=r.changedTouches[0].clientY}else C=r.clientX,r=r.clientY;B=B.spreadsheet.config.root?
B.spreadsheet.config.root:document;if(B.elementsFromPoint)var D=B.elementsFromPoint(C,r);else B.msElementsFromPoint&&(D=B.msElementsFromPoint(C,r));for(B=0;B<D.length;B++)if(C=D[B].getAttribute(_$_d043[56]),r=D[B].getAttribute(_$_d043[57]),null!=C&&null!=r)return C=parseInt(C),r=parseInt(r),[C,r,D[B]];return!1},q=function(r){var B=l(r);if(!1===B)return!1;B[0]?B[1]?u.current&&document.activeElement.classList.contains(_$_d043[114])?document.activeElement.worksheet||(document.activeElement.worksheet=
B[1].jexcel):u.current!=B[1].jexcel&&(u.current&&u.current.resetSelection(),u.current=B[1].jexcel):u.current||(r=B[0].tabs.getActive(),0<=r&&(u.current=B[0].spreadsheet.worksheets[r])):u.current&&!jSuites.findElement(r.target,_$_d043[252])&&(u.current.resetSelection(!0),u.current=null);return B};h.input=function(r){if(r.target.tagName==_$_d043[598]&&r.target.classList.contains(_$_d043[114])){var B=null;r.target.worksheet?B=r.target.worksheet:u.current&&(B=u.current);B&&ra.parse.call(B,r.target)}};
h.keydown=function(r){if(u.current){r.target.tagName==_$_d043[598]&&r.target.classList.contains(_$_d043[114])&&ra.onkeydown.call(u.current,r);if(27==r.which){if(u.current.edition){u.current.closeEditor(u.current.edition,!1);r.preventDefault();return}if(wa.event){wa.cancel.call(u.current,r);r.preventDefault();return}if(ha.event){ha.cancel.call(u.current,r);return}if(1==la.isVisible()){la.close.call(u.current,!1);r.preventDefault();return}}if(r.target.classList.contains(_$_d043[423])){var B=r.target;
g&&clearTimeout(g);g=setTimeout(function(){la.search.call(u.current,B.value);g=null},500)}else if(r.target.classList.contains(_$_d043[437]))B=r.target,g&&clearTimeout(g),g=setTimeout(function(){u.current.search(B.value);g=null},400);else if(!r.target.classList.contains(_$_d043[252]))if(u.current.edition){var C=u.current.edition.getAttribute(_$_d043[56]);13==r.which?u.current.options.columns[C].type==_$_d043[214]?u.current.closeEditor(u.current.edition,!0):u.current.options.columns[C].type!=_$_d043[73]&&
u.current.options.columns[C].type!=_$_d043[599]&&u.current.options.columns[C].type!=_$_d043[477]&&(r.altKey?u.current.parent.input.classList.contains(_$_d043[600])||document.execCommand(_$_d043[601],!1,_$_d043[602]):(u.current.closeEditor(u.current.edition,!0),u.current.parent.config.moveDownOnEnter&&u.current.down(),r.preventDefault())):9==r.which?(u.current.closeEditor(u.current.edition,!0),u.current.right(),r.preventDefault()):39!=r.which&&37!=r.which&&38!=r.which&&40!=r.which||u.current.parent.input.selected||
(u.current.closeEditor(u.current.edition,!0),37==r.which?u.current.left(r.shiftKey,r.ctrlKey):39==r.which?u.current.right(r.shiftKey,r.ctrlKey):38==r.which?u.current.up(r.shiftKey,r.ctrlKey):40==r.which&&u.current.down(r.shiftKey,r.ctrlKey),r.preventDefault())}else{if((r.ctrlKey||r.metaKey)&&!r.shiftKey){if(65==r.which){u.current.selectAll();r.preventDefault();return}if(83==r.which){u.current.download();r.preventDefault();return}if(89==r.which){u.current.parent.redo();r.preventDefault();return}if(90==
r.which){u.current.parent.undo();r.preventDefault();return}if(70==r.which&&u.current.parent.tools.search){u.current.parent.tools.search.open(!0);r.preventDefault();return}}if(u.current.selectedCell)if(33==r.which)0<u.current.options.pagination?Ca.pageUp.call(u.current):r.altKey?H.pageLeft.call(u.current):H.pageUp.call(u.current);else if(34==r.which)0<u.current.options.pagination?Ca.pageDown.call(u.current):r.altKey?H.pageRight.call(u.current):H.pageDown.call(u.current);else if(37==r.which)u.current.left(r.shiftKey,
r.ctrlKey),r.preventDefault();else if(39==r.which)u.current.right(r.shiftKey,r.ctrlKey),r.preventDefault();else if(38==r.which)u.current.up(r.shiftKey,r.ctrlKey),r.preventDefault();else if(40==r.which)u.current.down(r.shiftKey,r.ctrlKey),r.preventDefault();else if(36==r.which)u.current.first(r.shiftKey,r.ctrlKey),r.preventDefault();else if(35==r.which)u.current.last(r.shiftKey,r.ctrlKey),r.preventDefault();else if(32==r.which)u.current.setCheckRadioValue(),r.preventDefault();else if(46==r.which||
8==r.which)u.current.isEditable()&&u.current.setValue(u.current.getSelected(!1,!0),_$_d043[3]);else if(13==r.which)r.shiftKey?u.current.up():(1==u.current.options.allowManualInsertRow&&u.current.selectedCell[1]==(u.current.results?u.current.results[u.current.results.length-1]:u.current.rows.length-1)&&u.current.insertRow(null,null,null,null,r),u.current.selectedCell&&u.current.down()),r.preventDefault();else if(9==r.which)r.shiftKey?u.current.left():(C=u.current.selectedCell[0],u.current.right(),
1==u.current.options.allowInsertColumn&&1==u.current.options.allowManualInsertColumn&&u.current.selectedCell[0]==C&&(u.current.insertColumn(null,null,null,null,null,null,r),u.current.right())),r.preventDefault();else if((r.ctrlKey||r.metaKey)&&!r.shiftKey)67==r.which?(u.current.copy(),r.preventDefault()):88==r.which?(u.current.cut(),r.preventDefault()):86==r.which?r.target.classList.contains(_$_d043[252])||h.paste(r):189==r.which&&(1==u.current.options.allowDeleteRow&&k[3]==_$_d043[444]?(ka.isValid.call(u.current,
u.current.selectedCell)&&u.current.deleteRow(),r.preventDefault()):1==u.current.options.allowDeleteColumn&&k[3]==_$_d043[445]&&(ka.isValid.call(u.current,u.current.selectedCell)&&u.current.deleteColumn(),r.preventDefault()));else if(u.current.isEditable()){C=u.current.selectedCell[1];var D=u.current.selectedCell[0];u.current.options.columns[D].type!=_$_d043[26]&&(32==r.keyCode?u.current.options.columns[D].type==_$_d043[283]||u.current.options.columns[D].type==_$_d043[285]?r.preventDefault():u.current.openEditor(u.current.records[C][D].element,
!0,r):113==r.keyCode?u.current.openEditor(u.current.records[C][D].element,!1,r):1!=r.key.length&&r.key!=_$_d043[603]||r.altKey||r.ctrlKey||u.current.records[C]&&u.current.openEditor(u.current.records[C][D].element,!0,r))}}}};var p=[0,0],v=function(r){e&&H.limited.call(u.current)&&(f&&(clearTimeout(f),f=null),f=setTimeout(function(){if(e){var B=p[0],C=p[1],D=u.current.content.getBoundingClientRect();50>D.height-(C-D.top)?H.down.call(u.current):80>C-D.top&&H.up.call(u.current);50>D.width-(B-D.left)?
H.right.call(u.current):80>B-D.left&&H.left.call(u.current);v(r)}f=null},100))},w=function(r,B,C,D,M,T,U){if(document.activeElement.classList.contains(_$_d043[114])&&ra.update.call(u.current,r,B,C,D,M,document.activeElement,U))return!1;if(u.current.edition)u.current.closeEditor(u.current.edition,!0);else if(c&&c!==T)return!1;u.current!==U&&(u.current.resetSelection(),u.current=U);ra.current?ra.range.call(u.current,r,B,C,D,M):ka[_$_d043[11]].call(u.current,r,B,C,D,M)};h.mousedown=function(r){r=r||
window.event;var B=r.buttons?r.buttons:r.button?r.button:r.which;if(u.current)if(1==la.isVisible()&&(jSuites.findElement(r.target,_$_d043[427])||la.close.call(u.current,!1)),u.current.edition){if(jSuites.findElement(r.target,_$_d043[121]))return!1}else if(jSuites.findElement(r.target,_$_d043[252]))return!1;var C=q(r);if(!1===C)return!1;k=C;if(1<B)if(C[3]==_$_d043[443]){if(u.current.isSelected(C[4],C[5]))return!1}else if(C[3]==_$_d043[444]){if(u.current.isSelected(0,C[4]))return!1}else if(C[3]==_$_d043[445]&&
u.current.isSelected(C[4],0))return!1;if(u.current){if(C[3]==_$_d043[159])u.current.isEditable()&&(ha.event=!0);else if(C[3]==_$_d043[595])la.open.call(u.current,C[4]);else{if(1==C[2])if(d)d.style.cursor==_$_d043[604]?wa.start.call(u.current,r):d.style.cursor==_$_d043[605]?Ba.start.call(u.current,r):d.style.cursor==_$_d043[606]&&(!0===d.column?ca.start.call(u.current,r,0):!1===d.column?ja.start.call(u.current,r,0):ca.start.call(u.current,r,parseInt(C[4])+1));else{B=u.current.options.columns.length-
1;var D=u.current.options.data.length-1;if(C[3]==_$_d043[592])w(0,0,B,D,r,C[3],C[1].jexcel),a=b=0;else if(C[3]==_$_d043[454]){var M=ya.range.call(u.current,C[5])[C[4]];M[1]>B&&(M[1]=B);w(M[0],0,M[1],D,r,C[3],C[1].jexcel);b=M[0];a=0}else C[4]&&((r.shiftKey||r.ctrlKey)&&null!=b&&null!=a?w(b,0,C[4],D,r,C[3],C[1].jexcel):(C[3]==_$_d043[445]&&b==C[4]&&1==u.current.options.allowRenameColumn&&(f=setTimeout(function(){u.current.setHeader(C[4])},800)),w(C[4],0,C[4],D,r,C[3],C[1].jexcel),b=C[4],a=0))}if(2==
C[2])if(C[3]==_$_d043[444])d?d.style.cursor==_$_d043[604]?wa.start.call(u.current,r):d.style.cursor==_$_d043[607]?Ba.start.call(u.current,r):d.style.cursor==_$_d043[606]&&ja.start.call(u.current,r,parseInt(C[4])+1):(B=u.current.options.columns.length-1,D=parseInt(C[4]),(r.shiftKey||r.ctrlKey)&&null!=b&&null!=a?w(0,a,B,D,r,C[3],C[1].jexcel):(w(0,D,B,D,r,C[3],C[1].jexcel),b=0,a=D));else if(C[3]==_$_d043[443]){B=parseInt(C[4]);D=parseInt(C[5]);if(!u.current.edition&&(M=u.current.options.columns[C[4]].type,
r.target.tagName==_$_d043[608]&&(M==_$_d043[286]||M==_$_d043[287])&&r.target.parentNode.classList.contains(_$_d043[147]))){var T=r.target.innerText;M==_$_d043[286]&&(T=_$_d043[609]+T);window.open(T,_$_d043[610])}(r.shiftKey||r.ctrlKey)&&u.current.selectedCell?w(u.current.selectedCell[0],u.current.selectedCell[1],B,D,r,C[3],C[1].jexcel):(w(B,D,B,D,r,C[3],C[1].jexcel),b=B,a=D)}}c=C[3];typeof C[3]!==_$_d043[21]&&G.call(u.current.parent,_$_d043[611],u.current,C[3],C[4],C[5]);e=!0;C[3]!==_$_d043[443]&&
C[3]!==_$_d043[159]||v(r)}else e=!1};h.mouseup=function(r){u.current&&(wa.event?wa.end.call(u.current,r):Ba.event?Ba.end.call(u.current,r):ca.event?ca.end.call(u.current,r):ja.event?ja.end.call(u.current,r):ha.event?ha.end.call(u.current,r):r.target.classList.contains(_$_d043[426])?la.close.call(u.current,!0):u.current.edition&&r.target.classList.contains(_$_d043[612])&&50>r.target.clientWidth-r.offsetX&&50>r.offsetY?na.close.call(u.current,null,!0):r.target.classList.contains(_$_d043[355])&&(r=r.target.innerText==
_$_d043[15]?0:r.target.innerText==_$_d043[17]?r.target.getAttribute(_$_d043[297])-1:r.target.innerText-1,Ca[_$_d043[11]].call(u.current,parseInt(r))));f&&(clearTimeout(f),f=null);e=c=!1;ra.current&&ra.close.call(u.current)};h.mousemove=function(r){r=r||window.event;if(r.changedTouches&&r.changedTouches[0]){var B=r.changedTouches[0].clientX;var C=r.changedTouches[0].clientY}else B=r.clientX,C=r.clientY;p=[B,C];if(u.current)if(B=r.target.getAttribute(_$_d043[56]),C=r.target.getAttribute(_$_d043[57]),
1==e)wa.event?wa.update.call(u.current,r):Ba.event?Ba.update.call(u.current,r):ca.event?ca.move.call(u.current,r):ja.event?ja.move.call(u.current,r):u.current.options.tableOverflow&&(r=u.current.content,(r.w&&r.w!==r.offsetWidth||r.h&&r.h!==r.offsetHeight)&&u.current.setViewport(r.offsetWidth,r.offsetHeight),r.w=r.offsetWidth,r.h=r.offsetHeight);else{var D=r.target.getBoundingClientRect();d&&(d.style.cursor=_$_d043[3],d=null);1==u.current.options.editable&&r.target&&(r.target.classList.contains(_$_d043[370])?
u.current.options.freezeRowControl&&!u.current.options.freezeRows&&5>D.height-(r.clientY-D.top)?(d=r.target,d.style.cursor=_$_d043[606],d.column=!1):u.current.options.freezeColumnControl&&!u.current.options.freezeColumns&&5>D.width-(r.clientX-D.left)&&(d=r.target,d.style.cursor=_$_d043[606],d.column=!0):r.target.classList.contains(_$_d043[303])?u.current.options.freezeRowControl&&u.current.options.freezeRows==parseInt(C)+1&&5>D.height-(r.clientY-D.top)?(d=r.target,d.style.cursor=_$_d043[606]):6>D.width-
(r.clientX-D.left)?(d=r.target,d.style.cursor=_$_d043[604]):6>D.height-(r.clientY-D.top)&&(d=r.target,d.style.cursor=_$_d043[607]):r.target.classList.contains(_$_d043[195])&&(u.current.options.freezeColumnControl&&u.current.options.freezeColumns==parseInt(B)+1&&5>D.width-(r.clientX-D.left)?(d=r.target,d.style.cursor=_$_d043[606]):1==u.current.options.rowResize&&6>D.width-(r.clientX-D.left)?(d=r.target,d.style.cursor=_$_d043[605]):1==u.current.options.columnDrag&&6>D.height-(r.clientY-D.top)&&(d=r.target,
d.style.cursor=_$_d043[604])))}};h.mouseover=function(r){r=r||window.event;if(u.current&&1==e){var B=l(r);if(B[0]){if(!document.activeElement.classList.contains(_$_d043[114])&&B[1]&&u.current!=B[1].jexcel&&u.current)return!1;if(!(wa.event||Ba.event||ca.event||ja.event))if(ha.event){var C=r.target.getAttribute(_$_d043[56]),D=r.target.getAttribute(_$_d043[57]);u.current.isSelected(C,D)||null===C||null===D||ha.call(u.current,C,D)}else null!==b&&null!==a&&(1==B[2]&&(C=b,B[3]==_$_d043[445]&&(C=r.target.getAttribute(_$_d043[56])),
D=u.current.options.data.length-1,w(b,0,C,D,r,B[3],B[1].jexcel)),2==B[2]&&(B[3]==_$_d043[444]?(C=u.current.options.columns.length-1,D=parseInt(r.target.getAttribute(_$_d043[57])),w(0,a,C,D,r,B[3],B[1].jexcel)):B[3]==_$_d043[443]&&(C=B[4],D=B[5],w(b,a,C,D,r,B[3],B[1].jexcel))))}}};h.dblclick=function(r){if(u.current)if(r.target.classList.contains(_$_d043[380]))ha.execute.call(u.current,!1);else{var B=l(r);1==B[2]?1==u.current.options.columnSorting&&(r=r.target.getAttribute(_$_d043[56]))&&u.current.orderBy(r):
2==B[2]&&u.current.isEditable()&&!u.current.edition&&B[6]&&u.current.openEditor(B[6],null,r)}};h.paste=function(r){if(!r.target.classList.contains(_$_d043[252])&&u.current&&u.current.selectedCell&&!u.current.edition){var B=r.clipboardData||window.clipboardData;B&&(u.current.paste(u.current.selectedCell[0],u.current.selectedCell[1],B.getData(_$_d043[71])),r&&r.preventDefault())}};h.contextmenu=function(r){var B=q(r);!1!==B&&(B[1]||(B=k),u.current&&!u.current.edition&&(B=Array.prototype.slice.call(B,
3),Sa.open.call(u.current,r,B)))};var x=null,y=null,A=null,z=null,I=null;h.touchstart=function(r){var B=l(r);B[0]?B[1]&&u.current!=B[1].jexcel&&(u.current&&u.current.resetSelection(),u.current=B[1].jexcel):u.current&&(u.current.resetSelection(),u.current=null);u.current&&!u.current.edition?B[3]==_$_d043[159]?u.current.isEditable()&&(ha.event=!0):r.target&&r.target.classList.contains(_$_d043[162])?I=parseInt(r.target.getAttribute(_$_d043[163])):B[3]==_$_d043[443]?(z=B,x===r.target&&y?u.current.openEditor(r.target,
!1,r):(y=setTimeout(function(){x=y=z=null},400),A=setTimeout(function(){h.contextmenu(r);A=null},800)),x=r.target):z=null:z=null};h.touchmove=function(r){if(u.current){var B=null,C=null,D=null,M=null;if(r.changedTouches&&r.changedTouches[0]){var T=r.changedTouches[0].clientX;var U=r.changedTouches[0].clientY}else T=r.clientX,U=r.clientY;if(U=document.elementFromPoint(T,U))if(T=U.getAttribute(_$_d043[56]),U=U.getAttribute(_$_d043[57]),null!==T&&null!==U&&ha.event)u.current.isSelected(T,U)||(ha.call(u.current,
T,U),v(r)),r.preventDefault();else if(null!==I){T=parseInt(T);U=parseInt(U);var K=u.current.selectedCell;0==I?T<=K[2]&&(B=T,D=K[2],C=K[1],M=K[3]):2==I?T>=K[0]&&(B=K[0],C=K[1],D=T,M=K[3]):1==I?U<=K[3]&&(B=K[0],C=U,D=K[2],M=K[3]):3==I&&U>=K[1]&&(B=K[0],C=K[1],D=K[2],M=U);null!==B&&u.current.updateSelectionFromCoords(B,C,D,M);r.preventDefault()}else z=null;A&&clearInterval(A)}};h.touchend=function(r){if(ha.event)ha.end.call(u.current,r);else if(null!==I)I=null;else if(z){r=null;if(z[3]===_$_d043[443]){var B=
z[4];var C=z[5];var D=B;r=C}else z[3]===_$_d043[444]?(B=0,C=z[4],D=u.current.options.columns.length-1,r=C):z[3]===_$_d043[445]&&(B=z[4],C=0,D=B,r=u.current.rows.length-1);null!=B&&u.current.updateSelectionFromCoords(B,C,D,r)}A&&clearInterval(A)};h.resize=function(){u.current&&1==u.current.parent.config.fullscreen&&H.call(u.current,!0)};return h}(),u=function(h,d,b){if(h){d||(d={});if(!u.defaultRowHeight){var a=document.createElement(_$_d043[32]);a.innerHTML=_$_d043[614];document.body.appendChild(a);
u.defaultRowHeight=a.querySelector(_$_d043[173]).offsetHeight;a.parentNode.removeChild(a)}var c=[];if(d.cloud&&!b)return typeof u.cloud==_$_d043[104]?u.cloud.load(d,function(g){if((g=u(h,g,!0))&&g.length)for(var f=0;f<g.length;f++)c.push(g[f])}):console.error(_$_d043[615]),c;if(h.spreadsheet)e=h.spreadsheet,Fa[_$_d043[11]].call(e,d);else var e=ta.spreadsheet(h,d);e.processing=!0;1==e.config.loadingSpin&&jSuites.loading.show();jSuites.ajax.oncomplete[e.name]=function(){for(var g=0;g<e.worksheets.length;g++)typeof e.worksheets[g].onload==
_$_d043[104]&&(e.worksheets[g].onload(),e.worksheets[g].onload=null);e.processing=!1;if(Array.isArray(e.queue)&&0<e.queue.length)for(;g=e.queue.shift();)g[0].updateCell(g[1],g[2],O.call(g[0],g[1],g[2]),!0);e.config.toolbar&&ma.show.call(e);for(g=0;g<e.worksheets.length;g++)fa.refresh.call(e.worksheets[g]);G.call(e,_$_d043[616],e);pa.state.call(e);for(g=0;g<e.worksheets.length;g++)ea.update.call(e.worksheets[g]);jSuites.loading.hide()};Array.isArray(d.worksheets)&&(d=d.worksheets);if(Array.isArray(d)){for(b=
0;b<d.length;b++)ta.worksheet(e,d[b]);c=e.worksheets}else c=ta.worksheet(e,d);jSuites.ajax.pending(e.name)||(jSuites.ajax.oncomplete[e.name](),jSuites.ajax.oncomplete[e.name]=null);return c}console.error(_$_d043[613])};u.defaultRowHeight=null;u.license=null;u.setLicense=function(h){u.license=h};u.spreadsheet=[];u.picker=ra;u.setDictionary=function(h){jSuites.setDictionary(h)};u.extensions={};u.setExtensions=function(h){for(var d=Object.keys(h),b=0;b<d.length;b++)typeof h[d[b]]===_$_d043[104]&&(u[d[b]]=
h[d[b]],u.extensions[d[b]]=h[d[b]],u.license&&typeof u[d[b]].license==_$_d043[104]&&u[d[b]].license.call(u,u.license))};u.destroy=function(h,d){if(h.spreadsheet){d&&ta.unbind(h);d=u.spreadsheet.indexOf(h.spreadsheet);u.spreadsheet.splice(d,1);for(d=0;d<h.spreadsheet.worksheets.length;d++)J(h.spreadsheet.worksheets[d].options.worksheetName,null);h.spreadsheet=null;h.jexcel=null;h.innerHTML=_$_d043[3];h.classList.remove(_$_d043[617]);h.classList.remove(_$_d043[391])}};u.version=N;u.helpers=F;u.events=
Ea;typeof formula!==_$_d043[21]&&(u.formula=formula);u.editors=function(){var h={},d=function(b,a){return 1==b[a]||b.options&&1==b.options[a]?!0:b[a]==_$_d043[261]||b.options&&b.options[a]==_$_d043[261]?!0:!1};h.createEditor=function(b,a,c,e){e.parent.input.setAttribute(_$_d043[122],!1);b==_$_d043[251]?(b=document.createElement(_$_d043[251]),b.type=_$_d043[71],b.value=c):b=document.createElement(_$_d043[32]);b.style.width=a.offsetWidth-2+_$_d043[59];b.style.height=a.offsetHeight-1+_$_d043[59];e.parent.input.appendChild(b);
return b};h.createDialog=function(b,a,c,e,g,f){b=h.createEditor(_$_d043[32],b,a,g);b.classList.add(_$_d043[618]);b.classList.add(_$_d043[612]);800>window.innerWidth?(g.parent.input.style.top=_$_d043[61],g.parent.input.style.left=_$_d043[61]):(a=g.parent.input.getBoundingClientRect(),window.innerHeight<a.bottom&&(g.parent.input.style.marginTop=-g.parent.input.offsetHeight));return b};h.general=function(){var b={},a=function(e){return(_$_d043[3]+e)[0]==_$_d043[18]?!0:!1},c=function(e){if(e.format||
e.mask||e.locale){var g={};e.mask?g.mask=e.mask:e.format?g.mask=e.format:g.locale=e.locale;e.options&&(g.options=e.options);e.decimal&&(g.options||(g.options={}),g.options={decimal:e.decimal});return g}return null};b.createCell=function(e,g,f,k,l,n){return b.updateCell(e,g,f,k,l,n)};b.updateCell=function(e,g,f,k,l,n){f=parseInt(f);k=parseInt(k);if(e){var q=c(n),p=null;g===_$_d043[3]||a(g)||typeof g===_$_d043[22]||(q?(q=jSuites.mask.extract(g,q,!0))&&q.value!==_$_d043[3]&&(p=q.value):1==(!1===l.parent.config.autoCasting||
!1===n.autoCasting?!1:!0)&&(n.type==_$_d043[22]||n.type==_$_d043[344]||n.type==_$_d043[343]?(q=jSuites.mask.extract(g,n,!0))&&q.value!==_$_d043[3]&&(p=q.value):jSuites.isNumeric(Number(g))&&(p=Number(g))));null!==p&&(g=p);g=b.parseValue(f,k,g,l,n,e);g instanceof Element||g instanceof HTMLDocument?(e.innerHTML=_$_d043[3],e.appendChild(g)):n.rotate?(e.firstChild&&e.firstChild.classList.contains(_$_d043[27])?l=e.firstChild:(l=document.createElement(_$_d043[28]),l.classList.add(_$_d043[27])),l.style.transform=
_$_d043[29]+parseInt(270-n.rotate)+_$_d043[30],l.innerHTML=g,e.appendChild(l)):1==l.parent.config.stripHTML?e.innerText=g:e.innerHTML=g;if(null!==p)return p}};b.openEditor=function(e,g,f,k,l,n){var q=l.parent.input;q.onblur=function(){q.classList.contains(_$_d043[114])||l.closeEditor(e,!0)};if(n.type==_$_d043[22]||n.type==_$_d043[344]||n.type==_$_d043[343])q.classList.add(_$_d043[600]),a(g)||n.inputmode||(n.inputmode=_$_d043[619]);f=null;a(g)||(n.inputmode&&q.setAttribute(_$_d043[118],n.inputmode),
(f=c(n))?n.disabledMaskOnEdition||(n.mask?(k=n.mask.split(_$_d043[244]),q.setAttribute(_$_d043[116],k[0])):n.locale&&q.setAttribute(_$_d043[620],n.locale),f.input=q,q.mask=f,jSuites.mask.render(g,f,!1)):g&&n.type==_$_d043[343]&&(g*=100));if(!f||n.disabledMaskOnEdition)l.parent.config.stripHTML?q.innerText=g:q.innerHTML=g,jSuites.focus(q)};b.closeEditor=function(e,g,f,k,l,n){e=l.parent.input;g=g&&e.innerText.trim().length?e.innerText:_$_d043[3];a(g)?g=g.replace(/(\r\n|\n|\r)/gm,_$_d043[3]):n.type==
_$_d043[343]&&(g+=_$_d043[621],e.classList.remove(_$_d043[622]));return g};b.parseValue=function(e,g,f,k,l,n){1==k.parent.config.parseFormulas&&(k.resetArray(e,g),a(f)&&(f=k.executeFormula(f,e,g)));f instanceof Element||f instanceof HTMLDocument||(n&&(!l.rotate&&jSuites.isNumeric(f)?n.classList.add(_$_d043[279]):n.classList.remove(_$_d043[279])),l&&!a(f)&&(e=c(l))&&(e.mask?(g=e.mask.split(_$_d043[244]),0>f&&g[1]?(n&&-1!==g[1].indexOf(_$_d043[623])&&n.classList.add(_$_d043[624]),n=-1===g[1].indexOf(_$_d043[237])?
jSuites.mask.render(-1*f,e,!0):jSuites.mask.render(f,e,!0)):(e.mask=g[0],n&&n.classList.remove(_$_d043[624]),n=jSuites.mask.render(f,e,!0))):n=jSuites.mask.render(f,e,!0),n&&(f=n)));return f};b[_$_d043[58]]=function(e,g){var f;return(f=c(e))?jSuites.mask.render(g,f,!0):e.type==_$_d043[343]?100*parseFloat(g):g};b.destroyCell=function(e){e.classList.remove(_$_d043[279])};return b}();h.text=h.general;h.number=h.general;h.numeric=h.general;h.percent=h.general;h.notes=function(){var b={},a=null;b.updateCell=
function(c,e,g,f,k,l){c&&(g=document.createElement(_$_d043[32]),g.classList.add(_$_d043[625]),1==k.parent.config.stripHTML?g.innerText=e:g.innerHTML=e,c.innerHTML=_$_d043[3],c.appendChild(g))};b.createCell=b.updateCell;b.openEditor=function(c,e,g,f,k,l){var n=l&&l.options?l.options:{};n.focus=!0;n.value=e;n.border=!1;n.height=_$_d043[626];n.toolbar=!1;a=h.createDialog(c,e,g,f,k,l);a=jSuites.editor(a,n)};b.closeEditor=function(c,e,g,f,k,l){return e?a.getData():_$_d043[3]};return b}();h.dropdown=function(){var b=
{createCell:function(a,c,e,g,f,k){k.render==_$_d043[627]?a.classList.add(_$_d043[628]):a.classList.add(_$_d043[629]);if(a=b.updateCell(a,c,e,g,f,k))return a},destroyCell:function(a){a.classList.remove(_$_d043[629])},updateCell:function(a,c,e,g,f,k){if(a){var l=b.getItem(a,c,e,g,f,k);l?a.innerHTML=l:c?(c=b.fromLabel(a,c,e,g,f,k),c.length?(l=b.getItem(a,c,e,g,f,k),a.innerHTML=l):a.innerHTML=_$_d043[3]):a.innerHTML=_$_d043[3];return c}},openEditor:function(a,c,e,g,f,k){var l=h.createEditor(_$_d043[32],
a,c,f),n=k.delimiter||_$_d043[244];k=Object.create(k);k.options||(k.options={});typeof k.filter==_$_d043[104]&&(k.source=k.filter(f.el,a,e,g,k.source));typeof k.filterOptions==_$_d043[104]&&(k=k.filterOptions(f,a,e,g,c,k));e=k.options;k.source&&(e.data=JSON.parse(JSON.stringify(k.source)));d(k,_$_d043[630])&&(e.multiple=!0);d(k,_$_d043[72])&&(e.autocomplete=!0);e.format=!0;e.opened=!0;e.width=a.offsetWidth-2;e.onclose=function(){f.closeEditor(a,!0)};d(k,_$_d043[630])?c&&(e.value=(_$_d043[3]+c).split(n)):
e.value=c;jSuites.dropdown(l,e)},closeEditor:function(a,c,e,g,f,k){for(var l=f.parent.input.children[0],n=k.delimiter||_$_d043[244],q=l.dropdown.getText(!0),p=l.dropdown.getValue(!0),v=0;v<p.length;v++)!1===b.getItem(a,p[v],e,g,f,k)&&k.source.push({id:p[v],name:q[v]});l.dropdown.close(!0);if(c)return p.join(n)},fromLabel:function(a,c,e,g,f,k){a=k.delimiter||_$_d043[244];e=[];g=[];Array.isArray(c)||(c=(_$_d043[3]+c).split(a));for(f=0;f<c.length;f++)g[c[f].trim()]=!0;c=Object.keys(g);!d(k,_$_d043[630])&&
1<Object.keys(c).length&&(g=[],g[c[0]]=!0);for(c=0;c<k.source.length;c++)g[k.source[c].name]&&e.push(k.source[c].id);return e.join(a)},getItem:function(a,c,e,g,f,k){g=k.delimiter||_$_d043[244];a=[];e=[];Array.isArray(c)||(c=(_$_d043[3]+c).split(g));for(g=0;g<c.length;g++)e[c[g].trim()]=!0;g=Object.keys(e);!d(k,_$_d043[630])&&1<Object.keys(g).length&&(c=[],c[g[0]]=!0,e=c);if(k.source&&typeof k.source[0]!==_$_d043[103])for(c=0;c<k.source.length;c++)g=k.source[c],k.source[c]={id:g,name:g};for(c=0;c<
k.source.length;c++)typeof e[k.source[c].id]!==_$_d043[21]&&a.push(k.render==_$_d043[288]?k.source[c].color:k.render==_$_d043[631]?k.source[c].image:k.source[c].name);if(a.length){if(typeof k.render!==_$_d043[21]){for(c=0;c<a.length;c++)e=c,g=a[c],g=k.render==_$_d043[288]?_$_d043[632]+g+_$_d043[633]:k.render==_$_d043[631]?_$_d043[632]+g+_$_d043[633]:k.render==_$_d043[627]?_$_d043[635]+(k.source[c].color||_$_d043[634])+_$_d043[636]+g+_$_d043[637]:void 0,a[e]=g;return a.join(_$_d043[3])}for(c=0;c<a.length;c++)a[c]=
(_$_d043[3]+a[c]).replace(_$_d043[15],_$_d043[13]);return a.join(_$_d043[332])}return!1}};b[_$_d043[58]]=function(a,c){for(var e=0;e<a.source.length;e++)if(a.source[e].id==c)return a.render==_$_d043[288]?a.source[e].color:a.render==_$_d043[631]?a.source[e].image:a.source[e].name};return b}();h.autocomplete=h.dropdown;h.calendar=function(){var b={},a=null;b.updateCell=function(c,e,g,f,k,l){if(c){g=e;l=b.getFormat(l);0<e&&Number(e)==e&&(g=jSuites.calendar.numToDate(e));f=_$_d043[3]+e;f.substr(4,1)==
_$_d043[237]&&f.substr(7,1)==_$_d043[237]?f=!0:(f=f.split(_$_d043[237]),f=4==f[0].length&&f[0]==Number(f[0])&&2==f[1].length&&f[1]==Number(f[1])?!0:!1);f||(f=jSuites.calendar.extractDateFromString(e,l))&&(g=f);if(g=jSuites.calendar.getDateString(g,l))return c.innerText=g,e;c.innerText=_$_d043[3];return _$_d043[3]}};b.createCell=b.updateCell;b.openEditor=function(c,e,g,f,k,l){l=Object.create(l);typeof l.filterOptions==_$_d043[104]&&(l=l.filterOptions(k,c,g,f,e,l));g=l.options||{};g.opened=!0;g.onclose=
function(n,q){k.closeEditor(c,!0)};typeof l.timepicker!==_$_d043[21]&&(g.time=d(l,_$_d043[638])?!0:!1);typeof g.readonly!==_$_d043[21]&&(g.readonly=g.readonly);g.value=e||null;g.placeholder=g.format;a=h.createEditor(_$_d043[251],c,e,k);jSuites.calendar(a,g);!1===a.calendar.options.readonly&&a.focus()};b.closeEditor=function(c,e,g,f,k){c=a.calendar.close(!0,a.value?!0:!1);c=a.value?c:_$_d043[3];if(e)return c};b.getFormat=function(c){return c&&c.format?c.format:c&&c.options&&c.options.format?c.options.format:
_$_d043[639]};b[_$_d043[58]]=function(c,e){c=b.getFormat(c);return jSuites.calendar.getDateString(e,c)};return b}();h.color=function(){var b={},a=null;b.updateCell=function(c,e,g,f,k,l){c&&(l.render==_$_d043[640]?(g=document.createElement(_$_d043[32]),g.className=_$_d043[288],g.style.backgroundColor=e,c.innerText=_$_d043[3],c.appendChild(g)):(c.style.color=e,c.innerText=e))};b.createCell=b.updateCell;b.openEditor=function(c,e,g,f,k,l){l=Object.create(l);typeof l.filterOptions==_$_d043[104]&&(l=l.filterOptions(k,
c,g,f,e,l));g=l.options||{};g.value=e;g.onclose=function(n,q){k.closeEditor(c,!0)};a=h.createEditor(_$_d043[251],c,e,k);a=jSuites.color(a,g);a.open()};b.closeEditor=function(c,e,g,f,k,l){c=a.close(!0);if(e)return c};b[_$_d043[58]]=function(c,e){c=document.createElement(_$_d043[32]);c.style.width=_$_d043[641];c.style.height=_$_d043[34];c.style.backgroundColor=e;return c.outerHTML};return b}();h.checkbox=function(){var b={createCell:function(a,c,e,g,f,k){c=c&&c!=_$_d043[642]&&c!=_$_d043[643]?!0:!1;
e=document.createElement(_$_d043[251]);e.type=_$_d043[283];e.checked=c;e.onclick=function(){f.setValue(a,this.checked)};(k&&1==k.readOnly||!f.isEditable())&&e.setAttribute(_$_d043[644],_$_d043[644]);a.innerHTML=_$_d043[3];a.appendChild(e);return c},updateCell:function(a,c){c=c&&c!=_$_d043[642]&&c!=_$_d043[643]?!0:!1;a&&(a.children[0].checked=c);return c},openEditor:function(a,c,e,g,f){c=a.children[0].checked?!1:!0;f.setValue(a,c);return!1},closeEditor:function(a,c){return!1}};b[_$_d043[58]]=function(a,
c){return 1==c||1==c||c==_$_d043[261]?jSuites.translate(_$_d043[261]):jSuites.translate(_$_d043[642])};return b}();h.radio=function(){var b={createCell:function(a,c,e,g,f,k){a.getAttribute(_$_d043[56]);e=document.createElement(_$_d043[251]);e.type=_$_d043[285];e.checked=1==c||1==c||c==_$_d043[261]?!0:!1;e.onclick=function(){f.setValue(a,!0)};(k&&1==k.readOnly||!f.isEditable())&&e.setAttribute(_$_d043[644],_$_d043[644]);a.innerHTML=_$_d043[3];a.appendChild(e)},updateCell:function(a,c,e,g,f){c=1==c||
1==c||c==_$_d043[261]||c==_$_d043[645]?!0:!1;a&&(a.children[0].checked=c);if(1==c){a=[];for(var k=0;k<f.options.data.length;k++)g!=k&&f.options.data[k][e]&&a.push({x:e,y:k,value:0});a.length&&f.setValue(a)}return c},openEditor:function(a,c,e,g,f){return!1},closeEditor:function(a,c){return!1}};b[_$_d043[58]]=function(a,c){return 1==c||1==c||c==_$_d043[261]?_$_d043[261]:_$_d043[642]};return b}();h.autonumber=function(){var b={},a=null;b.createCell=function(c,e,g,f,k,l){(e=parseInt(e))||0<parseInt(c.innerText)&&
(e=parseInt(c.innerText));l.sequence||(l.sequence=0);e?b.isValid(e,g,f,k)||(e=_$_d043[275]):e=l.sequence+1;e>l.sequence&&(l.sequence=e);return c.innerText=e};b.updateCell=b.createCell;b.openEditor=function(c,e,g,f,k,l){a=h.createEditor(_$_d043[251],c,e,k);a.onblur=function(){k.closeEditor(c,!0)};a.focus();a.value=e};b.closeEditor=function(c,e,g,f,k){return e?a.value:_$_d043[3]};b.isValid=function(c,e,g,f){for(var k,l=0;l<f.options.data.length;l++)if(k=f.value(e,l),k==c&&l!=g)return!1;return!0};return b}();
h.progressbar=function(){var b={},a=null;b.createCell=function(c,e){e=parseInt(e);if(100<e)e=100;else if(!e||0>e)e=0;if(c.children[0]&&c.children[0].tagName==_$_d043[598])var g=c.children[0];else g=document.createElement(_$_d043[32]),g.classList.add(_$_d043[289]),c.innerText=_$_d043[3],c.classList.add(_$_d043[646]),c.appendChild(g);g.style.width=parseInt(e)+_$_d043[621];g.setAttribute(_$_d043[297],parseInt(e)+_$_d043[621])};b.destroyCell=function(c){c.classList.remove(_$_d043[646])};b.updateCell=
b.createCell;b.openEditor=function(c,e,g,f,k,l){a=h.createEditor(_$_d043[251],c,e,k);a.type=_$_d043[22];a.setAttribute(_$_d043[647],0);a.setAttribute(_$_d043[648],100);a.onblur=function(){k.closeEditor(c,!0)};a.focus();a.value=e};b.closeEditor=function(c,e,g,f,k){return e?a.value:_$_d043[3]};return b}();h.rating=function(){var b={},a=null;b.createCell=function(c,e,g,f,k,l){return b.setCell(c,e,l)};b.destroyCell=function(c){c.classList.remove(_$_d043[649])};b.updateCell=b.createCell;b.openEditor=function(c,
e,g,f,k,l){a=h.createEditor(_$_d043[251],c,e,k);a.type=_$_d043[22];a.setAttribute(_$_d043[647],0);a.setAttribute(_$_d043[648],5);a.onblur=function(){k.closeEditor(c,!0)};a.focus();a.value=e};b.closeEditor=function(c,e,g,f,k,l){return e?a.value:_$_d043[3]};b.setCell=function(c,e,g){e=parseInt(e);if(5<e)e=5;else if(!e||0>e)e=0;if(c){g=g&&g.color?g.color:_$_d043[624];var f=document.createElement(_$_d043[32]);f.setAttribute(_$_d043[297],parseInt(e)+_$_d043[650]);f.classList.add(_$_d043[290]);for(var k=
0;k<e;k++){var l=document.createElement(_$_d043[486]);l.className=_$_d043[550];l.style.color=g;l.innerHTML=_$_d043[651];f.appendChild(l)}c.innerHTML=_$_d043[3];c.className=_$_d043[649];c.appendChild(f)}return e};return b}();h.email=function(){var b={createCell:function(a,c,e,g,f,k){a&&(a.children&&a.children[0]&&a.children[0].tagName==_$_d043[608]?e=a.children[0]:(e=document.createElement(_$_d043[227]),a.innerText=_$_d043[3],a.appendChild(e),k.options&&k.options.url&&e.setAttribute(_$_d043[652],k.options.url)),
e.innerText=c)}};b.updateCell=b.createCell;b.openEditor=function(a,c,e,g,f,k){f.parent.input.classList.add(_$_d043[600]);f.parent.input.onblur=function(){f.closeEditor(a,!0)};f.parent.input.innerText=c;jSuites.focus(f.parent.input)};b.closeEditor=function(a,c,e,g,f){f.parent.input.classList.remove(_$_d043[600]);return c?f.parent.input.innerText.replace(new RegExp(/\n/,_$_d043[14]),_$_d043[3]):_$_d043[3]};return b}();h.url=h.email;h.image=function(){var b={},a=null;b.createCell=function(c,e,g,f,k,
l){if(c)if(e)if(c.children&&c.children[0]&&c.children[0].tagName==_$_d043[653])c.children[0].src=e;else{var n=document.createElement(_$_d043[49]);l.render==_$_d043[654]&&n.classList.add(_$_d043[654]);l.options&&(n.style.maxWidth=_$_d043[655],l.options.absolute&&(c.classList.add(_$_d043[656]),n.setAttribute(_$_d043[657],-1),n.classList.add(_$_d043[252]),n.classList.add(_$_d043[658]),n.settings=function(){k.openEditor(c,e,g,f,k,l)},n.dblclick=function(){k.openEditor(c,!0)},n[_$_d043[659]]=function(){k.setValueFromCoords(g,
f,_$_d043[3])}),l.options.width&&(n.style.width=parseInt(l.options.width)+_$_d043[59]),l.options.height&&(n.style.height=parseInt(l.options.height)+_$_d043[59]));n.src=e;c.innerHTML=_$_d043[3];c.appendChild(n)}else c.innerHTML=_$_d043[3]};b.updateCell=b.createCell;b.openEditor=function(c,e,g,f,k,l){(l&&l.options?l.options:{}).value=e;a=h.createDialog(c,e,g,f,k,l);e&&(c=document.createElement(_$_d043[49]),c.src=e,c.classList.add(_$_d043[660]),c.style.width=_$_d043[655],a.appendChild(c));jSuites.image(a,
l)};b.closeEditor=function(c,e,g,f,k,l){if(e&&(c=a.children[0]))return c.tagName==_$_d043[653]?c.src:_$_d043[3]};b[_$_d043[58]]=function(c,e){return _$_d043[661]+e+_$_d043[662]};return b}();h.html=function(){var b={},a=null;b.createCell=function(c,e){c.classList.add(_$_d043[663]);var g=document.createElement(_$_d043[32]);g.innerHTML=e;c.appendChild(g)};b.updateCell=function(c,e){c&&(c.firstChild.innerHTML=e)};b.destroyCell=function(c){c.classList.remove(_$_d043[663])};b.openEditor=function(c,e,g,
f,k,l){var n=l&&l.options?l.options:{};n.focus=!0;n.value=e;n.border=!1;n.height=_$_d043[626];e=h.createDialog(c,e,g,f,k,l);a=jSuites.editor(e,n);a.close=function(){k.closeEditor(c,!0)};jSuites.tracking(a,!0)};b.closeEditor=function(c,e,g,f,k,l){jSuites.tracking(a,!1);c=a.getData();if(e)return c};return b}();h.hidden=function(){return{createCell:function(b,a,c,e,g){b.innerText=a},updateCell:function(b,a,c,e,g){b&&(b.innerText=a)},openEditor:function(b,a,c,e,g){return!1},closeEditor:function(b,a){return!1}}}();
h.tags=function(){var b={},a=null;b.createCell=function(c,e){c.classList.add(_$_d043[664]);b.updateCell(c,e)};b.updateCell=function(c,e){c&&(c.innerHTML=e)};b.destroyCell=function(c){c.classList.remove(_$_d043[664])};b.openEditor=function(c,e,g,f,k,l){var n=l&&l.options?l.options:{};n.value=e;a=h.createDialog(c,e,g,f,k,l);c=document.createElement(_$_d043[32]);c.style.margin=_$_d043[34];c.style.marginRight=_$_d043[665];a.appendChild(c);a=jSuites.tags(c,n);c.focus();jSuites.focus(c)};b.closeEditor=
function(c,e,g,f,k,l){c=a.getValue();if(e)return c};return b}();h.record=function(){var b={},a=null;b.createCell=function(c,e,g,f,k,l){c.classList.add(_$_d043[629]);var n;(n=k.parent.getWorksheetInstance(l.worksheetId))?n.rows?b.updateCell(c,e,g,f,k,l):(c.innerText=_$_d043[275],k.parent.queue.push([k,g,f])):(c.innerText=_$_d043[275],k.parent.queue.push([k,g,f]))};b.destroyCell=function(c){c.classList.remove(_$_d043[629])};b.updateCell=function(c,e,g,f,k,l){c&&(typeof l.worksheetId==_$_d043[21]?c.innerText=
_$_d043[275]:c.innerHTML=b.getValue(c,e,g,f,k,l))};b.openEditor=function(c,e,g,f,k,l){var n=l.delimiter||_$_d043[244];l=Object.create(l);l.options||(l.options={});typeof l.filter==_$_d043[104]&&(l.source=l.filter(k.el,c,g,f,l.source));typeof l.filterOptions==_$_d043[104]&&(l=l.filterOptions(k,c,g,f,e,l));g=l.options;g.data=b.getSource(k,l);d(l,_$_d043[630])&&(g.multiple=!0);d(l,_$_d043[72])&&(g.autocomplete=!0);g.format=!0;g.opened=!0;g.width=c.offsetWidth-2;g.onclose=function(){k.closeEditor(c,!0)};
d(l,_$_d043[630])?e&&(g.value=(_$_d043[3]+e).split(n)):g.value=e;a=h.createEditor(_$_d043[32],c,e,k);a=jSuites.dropdown(a,g)};b.closeEditor=function(c,e,g,f,k,l){c=l.delimiter||_$_d043[244];g=a.getValue(!0);a.close(!0);if(e)return g.join(c)};b.getValue=function(c,e,g,f,k,l){c=[];if(typeof l.worksheetId==_$_d043[25]&&(k=k.parent.getWorksheetInstance(l.worksheetId))){g=l.worksheetColumn?l.worksheetColumn:0;0<=l.worksheetImage&&(g=l.worksheetImage);if(e==_$_d043[3]||0==e||null==e||void 0==e)return _$_d043[3];
e=(_$_d043[3]+e).split(_$_d043[244]);for(f=0;f<e.length;f++){var n=e[f].trim();var q=k.name(g);n=k.getRowById(n);q=!1===n?_$_d043[666]:n[q];0<=l.worksheetImage&&(q=_$_d043[667]+q+_$_d043[668]);c.push(q)}return 0<=l.worksheetImage?c.join(_$_d043[3]):c.join(_$_d043[332])}return _$_d043[275]};b.getSource=function(c,e){var g=e.worksheetColumn?e.worksheetColumn:0,f=null;typeof e.worksheetId==_$_d043[25]&&(f=c.parent.getWorksheetInstance(e.worksheetId));if(f){var k,l=[];for(c=0;c<f.rows.length;c++)if(k=
f.value(g,c))k={id:f.getRowId(c),name:k},void 0!=e.worksheetImage&&(k.image=f.value(e.worksheetImage,c)),l.push(k)}else console.error(_$_d043[669]+e.worksheetId);return l};b[_$_d043[58]]=function(c,e){for(var g=0;g<c.source.length;g++)if(c.source[g].id==e)return c.render==_$_d043[288]?c.source[g].color:c.render==_$_d043[631]?c.source[g].image:c.source[g].name};return b}();return h}();typeof jQuery!==_$_d043[21]&&function(h){h.fn.jspreadsheet=h.fn.jexcel=function(d){var b=h(this)[_$_d043[58]](0);if(b.jspreadsheet){if(typeof arguments[0]==
_$_d043[22])var a=arguments[0],c=2;else a=0,c=1;return b.jspreadsheet[a][d].apply(b.jspreadsheet[a],Array.prototype.slice.call(arguments,c))}return u(h(this)[_$_d043[58]](0),arguments[0])}}(jQuery);return u});
